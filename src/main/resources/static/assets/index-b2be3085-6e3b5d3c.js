import{d as x,r as b,D as S,z as T,a as n,b as E,c as j,f as l,g as o,p as f,j as v,F as z,v as U,i as B,s as M,U as N,T as w}from"./index-168435c7.js";const P={class:"dialog-footer"},q=x({__name:"ComputedEditorDialog",setup(I,{expose:g}){const y=b("code");function p(t,e){u.value=t,s=e,c.value=!0}const c=b(!1),u=b({});let s;const k=b(),m=async t=>{t&&await t.validate(e=>{e&&(c.value=!1,s&&s(u.value))})};return g({show:p}),(t,e)=>{const a=n("el-input"),d=n("el-form-item"),r=n("el-alert"),_=n("b-ace-editor"),$=n("el-tab-pane"),C=n("el-tabs"),V=n("el-form"),h=n("el-button"),D=n("el-dialog");return E(),U(D,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=i=>c.value=i),title:t.$t("_.builtIn.plugin.computedEditor.dialogTitle"),"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:o(()=>[B("span",P,[l(h,{onClick:e[5]||(e[5]=i=>c.value=!1)},{default:o(()=>[f(v(t.$t("_._.cancel")),1)]),_:1}),l(h,{type:"primary",onClick:e[6]||(e[6]=i=>m(k.value))},{default:o(()=>[f(v(t.$t("_._.save")),1)]),_:1})])]),default:o(()=>[l(V,{ref_key:"dataEditorFormRef",ref:k,model:u.value,"label-width":"120px"},{default:o(()=>[l(d,{label:t.$t("_._.key"),prop:"key",required:""},{default:o(()=>[l(a,{modelValue:u.value.key,"onUpdate:modelValue":e[0]||(e[0]=i=>u.value.key=i)},null,8,["modelValue"])]),_:1},8,["label"]),l(d,{label:t.$t("_._.description"),prop:"description"},{default:o(()=>[l(a,{modelValue:u.value.description,"onUpdate:modelValue":e[1]||(e[1]=i=>u.value.description=i)},null,8,["modelValue"])]),_:1},8,["label"]),l(C,{modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=i=>y.value=i),class:"demo-tabs"},{default:o(()=>[l($,{label:t.$t("_.builtIn.plugin.computedEditor.code"),name:"code"},{default:o(()=>[l(d,{label:"",prop:"code",required:"","label-width":1},{default:o(()=>[l(r,{type:"info",closable:!1,title:t.$t("_.builtIn.plugin.computedEditor.codePrompt")},null,8,["title"]),l(_,{modelValue:u.value.code,"onUpdate:modelValue":e[2]||(e[2]=i=>u.value.code=i),lang:"javascript",width:"100%",height:"30vh",readonly:!1,"font-size":14},null,8,["modelValue"])]),_:1})]),_:1},8,["label"]),l($,{label:t.$t("_.builtIn.plugin.computedEditor.codeSet"),name:"codeSet"},{default:o(()=>[l(d,{label:"",prop:"codeSet","label-width":1},{default:o(()=>[l(r,{type:"info",closable:!1,title:t.$t("_.builtIn.plugin.computedEditor.codeSetPrompt")},null,8,["title"]),l(_,{modelValue:u.value.codeSet,"onUpdate:modelValue":e[3]||(e[3]=i=>u.value.codeSet=i),lang:"javascript",width:"100%",height:"30vh",readonly:!1,"font-size":14},null,8,["modelValue"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),F={class:"dialog-footer"},R=x({__name:"ComputedValueDialog",setup(I,{expose:g}){const y=S("context"),p=b();let c;function u(m){c=m,p.value=k(),s.value=!0}const s=b(!1);function k(m){var t;const e=(t=y.computedManager.get(c.key))==null?void 0:t.value;return e!=null?typeof e=="string"?e:JSON.stringify(e,null,2):"undefined"}return g({show:u}),(m,t)=>{const e=n("b-ace-editor"),a=n("el-button"),d=n("el-dialog");return E(),U(d,{modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=r=>s.value=r),title:m.$t("_.builtIn.plugin.computedEditor.valueDialogTitle")},{footer:o(()=>[B("span",F,[l(a,{onClick:t[1]||(t[1]=r=>s.value=!1)},{default:o(()=>[f(v(m.$t("_._.close")),1)]),_:1})])]),default:o(()=>[l(e,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=r=>p.value=r),lang:"json",width:"100%",height:"50vh",readonly:!1,"font-size":14},null,8,["modelValue"])]),_:1},8,["modelValue","title"])}}}),O=x({__name:"index",setup(I){const g=b(),y=b();let p=-1;const c=S("context");function u(){p=-1,g.value.show({code:"",codeSet:""},k)}function s(a){p=a.$index;const d=M(a.row);g.value.show(d,k)}const k=a=>{p<0?e.value.push(a):(e.value[p]=a,c.computedManager.clear(a.key))},m=a=>{N.confirm(w("_.builtIn.plugin.computedEditor.deletePrompt"),w("_._.warning"),{confirmButtonText:w("_._.yes"),cancelButtonText:w("_._.no"),type:"warning"}).then(()=>{e.value.splice(a.$index,1),c.computedManager.reset(a.row.key)})},t=a=>{y.value.show(a.row)},e=T(()=>c.codeManager.getCode().computed);return(a,d)=>{const r=n("el-table-column"),_=n("el-button"),$=n("el-button-group"),C=n("el-table");return E(),j(z,null,[l(C,{data:e.value,border:""},{empty:o(()=>[l(_,{type:"primary",onClick:d[1]||(d[1]=V=>u())},{default:o(()=>[f(v(a.$t("_._.add")),1)]),_:1})]),default:o(()=>[l(r,{prop:"key",label:a.$t("_._.key")},null,8,["label"]),l(r,{prop:"description",label:a.$t("_._.description")},null,8,["label"]),l(r,{fixed:"right",label:a.$t("_._.operation"),width:"280px"},{default:o(V=>[l($,null,{default:o(()=>[l(_,{type:"primary",onClick:d[0]||(d[0]=h=>u())},{default:o(()=>[f(v(a.$t("_._.add")),1)]),_:1}),l(_,{type:"success",onClick:h=>s(V)},{default:o(()=>[f(v(a.$t("_._.edit")),1)]),_:2},1032,["onClick"]),l(_,{type:"danger",onClick:h=>m(V)},{default:o(()=>[f(v(a.$t("_._.del")),1)]),_:2},1032,["onClick"]),l(_,{type:"success",onClick:h=>t(V)},{default:o(()=>[f(v(a.$t("_.builtIn.plugin.computedEditor.value")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),l(q,{ref_key:"computedEditorDialogRef",ref:g},null,512),l(R,{ref_key:"computedValueDialogRef",ref:y},null,512)],64)}}});export{O as default};
