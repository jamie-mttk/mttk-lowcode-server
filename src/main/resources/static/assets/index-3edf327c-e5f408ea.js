import{l as w,m as d,p as S}from"./transformUtil-999da02b-1268ffeb.js";import{r as A}from"./dataUtil-c2d4e754-c2780e53.js";import{h as y}from"./tooltipUtil-4635a4f7-2c64bc23.js";import{b as k,c as z,d as _,a as I}from"./index-1ede4d6c-021f9bd8.js";import{ad as e,aT as l,k as P}from"./index-168435c7.js";import"./biTool-e603ec91-d05b025b.js";import"./index-3458eb1c-88d55814.js";import"./chartActionUtil-201ccd97-c4d73bc9.js";import"./_plugin-vue_export-helper-dad06003-f875bd67.js";const q=[{key:"dimension",min:2}];function L({config:a,data:r,context:T,key:C,contextWrap:D,fullConfig:v}){var c,g,p;const o=v.config.model,m=P(r).data||[],x=d(o,"dimension",0),f=d(o,"dimension",1),i={...S({config:a}),tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(s){if(!Array.isArray||s.length==0)return"";let t='<div style="font-weight:700;">'+y(s[0].axisValue,x)+"</div>";t+='<div style="display:grid;grid-template-columns: auto auto auto;grid-gap: 4px 8px;">';for(const n of s)t+="<div>"+(n.marker||"")+"</div>",t+="<div>"+(n.seriesName||"")+"</div>",t+="<div>"+y(n.value[1]||0,f)+"</div>";return t+="</div>",t}},xAxis:{name:(c=d(o,"dimension",0))==null?void 0:c.label},yAxis:{name:(g=d(o,"dimension",1))==null?void 0:g.label},dataset:[],series:[]};i.dataset.push({sourceHeader:!0,source:m});const u=R(a),h=((p=o.dimension)==null?void 0:p.length)||0;if(h==2)i.series.push({name:"显示值",symbolSize:a["symbol-size"]||20,type:"scatter",...u}),i.legend.data=[];else if(h==3){const s=A(m,2);i.legend.data=s;for(let t=0;t<s.length;t++){const n=s[t];i.dataset.push({transform:{type:"filter",config:{dimension:2,value:n}}}),i.series.push({name:n,symbolSize:a["symbol-size"]||20,type:"scatter",datasetIndex:t+1,emphasis:{focus:"series"},...u})}}const b=a["regression-curve"]||"none";return b!="none"&&m&&m.length>0&&(i.dataset.push({transform:{type:"ecStat:regression",config:{method:b,order:3}}}),i.series.push({name:"回归曲线",type:"line",smooth:!0,datasetIndex:i.dataset.length-1,symbolSize:.1,symbol:"circle",label:{show:!0,fontSize:16},labelLayout:{dx:-40},encode:{label:2,tooltip:1}})),i}const M=w(L,q,void 0,{skipDataset:!0});function R(a){const r={};return a["show-range-area"]&&(r.markArea={silent:!0,itemStyle:{color:"transparent",borderWidth:1,borderType:"dashed"},data:[[{xAxis:"min",yAxis:"min"},{xAxis:"max",yAxis:"max"}]]}),a["show-average-line"]&&(r.markLine={lineStyle:{type:"solid"},label:{show:!1},symbol:"rect",data:[{yAxis:"average"},{xAxis:"average"}]}),a["highlight-min-max"]&&(r.markPoint={data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]}),r}const B={key:"_bi_scatter",name:e.t("bi.widgets.scatter.name"),description:"",icon:"mdiChartScatterPlot",sequence:14,transform:M,editor:{model:k({type:"scatter"},[{_type:"dimension",description:e.t("bi.widgets.scatter.dimension_description"),option:{maxRow:3,minRow:2}},...z]),basic:{init:{"regression-curve":"none","symbol-size":20},ui:[..._(),l.createSelect("regression-curve",[{label:e.t("bi.widgets.scatter.regression-curve_none"),value:"none"},{label:e.t("bi.widgets.scatter.regression-curve_linear"),value:"linear"},{label:e.t("bi.widgets.scatter.regression-curve_exponential"),value:"exponential"},{label:e.t("bi.widgets.scatter.regression-curve_logarithmic"),value:"logarithmic"},{label:e.t("bi.widgets.scatter.regression-curve_polynomial"),value:"polynomial"}],e.t("bi.widgets.scatter.regression-curve")),l.createInputNumber("symbol-size",e.t("bi.widgets.scatter.symbol-size")),l.createSwitch("show-range-area",e.t("bi.widgets.scatter.show-range-area")),l.createSwitch("show-average-line",e.t("bi.widgets.scatter.show-average-line")),l.createSwitch("highlight-min-max",e.t("bi.widgets.scatter.highlight-min-max"))]},...I()}};export{B as default};
