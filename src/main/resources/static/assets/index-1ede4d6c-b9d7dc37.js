import{ad as h,aS as ge,z as F,aT as vt,d as W,m as ve,u as be,a as S,b as _,c as N,i as me,f as p,g as w,p as at,j as Ae,v as O,F as Y,h as j,k as m,D as Ue,aU as Pl,aC as At,r as De,q as P,U as oe,o as Ut,K as Rl,aj as Yl,as as Bl,G as Hl,ay as jl,aD as Ll,aV as rl,aW as Xl,ao as $t,w as ql,B as Ee,au as Me,ah as ul,am as zl,N as Ht,O as Wl}from"./index-5e7b76fe.js";import{p as Gl,d as Kl,r as jt,i as Ql,u as dl}from"./biTool-e603ec91-3f60f9c4.js";import{s as sl}from"./_plugin-vue_export-helper-dad06003-f875bd67.js";import"./index-3458eb1c-625f9c79.js";function cl(e){const t={};for(const l of e.filter||[])l._ui_mode=="input"?(re(t,l,l.id+"-match","_ui_input_match_init","LIKE"),re(t,l,l.id,"_ui_input_init")):l._ui_mode=="select"?re(t,l,l.id,"_ui_select_init"):l._ui_mode=="input-number"?(re(t,l,l.id+"-match","_ui_input-number_match_init",">="),re(t,l,l.id,"_ui_input-number_init"),re(t,l,l.id+"-to","_ui_input-number_init_to")):l._ui_mode=="datetime"?(re(t,l,l.id+"-match","_ui_datetime_match_init",">="),re(t,l,l.id,"_ui_datetime_init",void 0,Lt),re(t,l,l.id+"-to","_ui_datetime_init_to",void 0,Lt)):l._ui_mode=="time"&&(re(t,l,l.id+"-match","_ui_time_match_init",">="),re(t,l,l.id,"_ui_time_init",void 0,Xt),re(t,l,l.id+"-to","_ui_time_init_to",void 0,Xt));return t}function re(e,t,l,o,a,n){let i=t[o];i==null&&(i=a),i!=null&&(n&&typeof n=="function"&&(i=n(i)),e[l]=i)}function Lt(e){let t=rl();return e!="now"&&(t=t.hour(0).minute(0).second(0).millisecond(0)),e=="t-1"?t=t.subtract(1,"day"):e=="t-2"?t=t.subtract(2,"day"):e=="t+1"?t=t.add(1,"day"):e=="t+2"?t=t.add(2,"day"):e=="m"?t=t.set("date",1):e=="m-1"?t=t.set("date",1).subtract(1,"month"):e=="m+1"?t=t.set("date",1).add(1,"month"):e=="y"?t=t.set("date",1).set("month",0):e=="y-1"?t=t.set("date",1).set("month",0).subtract(1,"year"):e=="y+1"&&(t=t.set("date",1).set("month",0).add(1,"year")),t.format("YYYY-MM-DD HH:mm:ss")}function Xt(e){return e=="now"?rl().format("HH:mm:ss"):e}const ml=[{key:"1",options:[{label:h.t("bi.widgets.filter.data.inputOptions1"),value:"="},{label:h.t("bi.widgets.filter.data.inputOptions2"),value:"!="}]},{key:"2",options:[{label:h.t("bi.widgets.filter.data.inputOptions3"),value:"LIKE"},{label:h.t("bi.widgets.filter.data.inputOptions4"),value:"NOT_LIKE"}]},{key:"3",options:[{label:h.t("bi.widgets.filter.data.inputOptions5"),value:"START_WITH"},{label:h.t("bi.widgets.filter.data.inputOptions6"),value:"END_WITH"}]},{key:"4",options:[{label:h.t("bi.widgets.filter.data.inputOptions7"),value:"IS_NULL"},{label:h.t("bi.widgets.filter.data.inputOptions8"),value:"NOT_NULL"}]},{key:"5",options:[{label:h.t("bi.widgets.filter.data.inputOptions9"),value:"EMPTY"},{label:h.t("bi.widgets.filter.data.inputOptions10"),value:"NOT_EMPTY"}]}],pl=["=","!=","LIKE","NOT_LIKE","START_WITH","END_WITH"],fl=[{label:h.t("bi.widgets.filter.data.inputNumberOptions1"),value:"="},{label:h.t("bi.widgets.filter.data.inputNumberOptions2"),value:"!="},{label:h.t("bi.widgets.filter.data.inputNumberOptions3"),value:">"},{label:h.t("bi.widgets.filter.data.inputNumberOptions4"),value:">="},{label:h.t("bi.widgets.filter.data.inputNumberOptions5"),value:"<"},{label:h.t("bi.widgets.filter.data.inputNumberOptions6"),value:"<="},{label:h.t("bi.widgets.filter.data.inputNumberOptions7"),value:"_RANGE"}],bl=[{label:h.t("bi.widgets.filter.data.datetimeOptions1"),value:"="},{label:h.t("bi.widgets.filter.data.datetimeOptions2"),value:"!="},{label:h.t("bi.widgets.filter.data.datetimeOptions3"),value:">"},{label:h.t("bi.widgets.filter.data.datetimeOptions4"),value:">="},{label:h.t("bi.widgets.filter.data.datetimeOptions5"),value:"<"},{label:h.t("bi.widgets.filter.data.datetimeOptions6"),value:"<="},{label:h.t("bi.widgets.filter.data.datetimeOptions7"),value:"_RANGE"}],qt=[{label:h.t("bi.widgets.filter.data.datetimeInitOptions1"),value:"now"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions2"),value:"t"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions3"),value:"t-1"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions4"),value:"t-2"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions5"),value:"t+1"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions6"),value:"t+2"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions7"),value:"m"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions8"),value:"m2"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions9"),value:"y"},{label:h.t("bi.widgets.filter.data.datetimeInitOptions10"),value:"y2"}],gl=[{label:h.t("bi.widgets.filter.data.timeOptions1"),value:"="},{label:h.t("bi.widgets.filter.data.timeOptions2"),value:"!="},{label:h.t("bi.widgets.filter.data.timeOptions3"),value:">"},{label:h.t("bi.widgets.filter.data.timeOptions4"),value:">="},{label:h.t("bi.widgets.filter.data.timeOptions5"),value:"<"},{label:h.t("bi.widgets.filter.data.timeOptions6"),value:"<="},{label:h.t("bi.widgets.filter.data.timeOptions7"),value:"_RANGE"}],zt=[{label:h.t("bi.widgets.filter.data.timeInitOptions1"),value:"now"},{label:h.t("bi.widgets.filter.data.timeInitOptions2"),value:"00:00:00"},{label:h.t("bi.widgets.filter.data.timeInitOptions3"),value:"12:00:00"},{label:h.t("bi.widgets.filter.data.timeInitOptions4"),value:"23:59:59"}],Zl={style:{display:"inline-flex",width:"100%"}},Jl=W({__name:"CriteriaInput",props:ve(["config","c"],{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=e,o=se(t,l.c.id+"-match"),a=se(t,l.c.id);return(n,i)=>{const u=S("el-option"),s=S("el-option-group"),r=S("el-select"),d=S("el-input");return _(),N("span",Zl,[Ee(p(r,{style:{"flex-basis":"86px","flex-grow":"1","margin-right":"2px"},modelValue:m(o),"onUpdate:modelValue":i[0]||(i[0]=c=>oe(o)?o.value=c:null),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(ml),c=>(_(),O(s,{key:c.key},{default:w(()=>[(_(!0),N(Y,null,j(c.options,b=>(_(),O(u,{key:b.value,label:b.label,value:b.value},null,8,["label","value"]))),128))]),_:2},1024))),128))]),_:1},8,["modelValue"]),[[Me,!e.c._ui_hide_match]]),m(pl).includes(t.value[e.c.id+"-match"]||"")?(_(),O(d,{key:0,clearable:"",style:{"flex-basis":"0","flex-grow":"10"},modelValue:m(a),"onUpdate:modelValue":i[1]||(i[1]=c=>oe(a)?a.value=c:null)},null,8,["modelValue"])):P("",!0)])}}}),eo={style:{display:"inline-flex",width:"100%"}},to={key:0},lo=W({__name:"CriteriaInputNumber",props:ve(["config","c"],{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=e,o=se(t,l.c.id+"-match"),a=se(t,l.c.id),n=se(t,l.c.id+"-to");return(i,u)=>{const s=S("el-option"),r=S("el-select"),d=S("el-input-number");return _(),N("span",eo,[Ee(p(r,{style:{"flex-basis":"86px","flex-grow":"1","margin-right":"2px"},modelValue:m(o),"onUpdate:modelValue":u[0]||(u[0]=c=>oe(o)?o.value=c:null),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(fl),c=>(_(),O(s,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),[[Me,!e.c._ui_hide_match]]),p(d,{style:{"flex-basis":"0","flex-grow":"10"},controls:!1,modelValue:m(a),"onUpdate:modelValue":u[1]||(u[1]=c=>oe(a)?a.value=c:null)},null,8,["modelValue"]),t.value[e.c.id+"-match"]=="_RANGE"?(_(),N("span",to,"~")):P("",!0),t.value[e.c.id+"-match"]=="_RANGE"?(_(),O(d,{key:1,style:{"flex-basis":"0","flex-grow":"10"},controls:!1,modelValue:m(n),"onUpdate:modelValue":u[2]||(u[2]=c=>oe(n)?n.value=c:null)},null,8,["modelValue"])):P("",!0)])}}}),hl=W({__name:"CriteriaSelect",props:ve(["config","c"],{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=e,o=F({get:()=>{const f=m(t)[l.c.id];return l.c._ui_select_multiple?Array.isArray(f)?f:[]:Array.isArray(f)?void 0:f},set:f=>{m(t)[l.c.id]=f}}),a=De([]),n=Ue("globalContext"),i=F(()=>l.c._ui_select_source=="manual"?"preload":l.c._ui_select_load||"preload"),u=F(()=>i.value=="filter_load"),s=F(()=>i.value=="filter_load"?h.t("bi.widgets.filter.criteriaSelect.placeholder1"):h.t("bi.widgets.filter.criteriaSelect.placeholder2")),r=F(()=>!!l.c._ui_select_multiple);Ut(()=>{i.value=="preload"&&c()});const d=f=>{c(f)};function c(f){const D=l.c._ui_select_source||"auto";D=="auto"?b(f):D=="datamodel"?x(f):D=="manual"&&v()}function b(f){var D;const E={dataModel:(D=l.config)==null?void 0:D.dataModel,column:l.c,filter:f||""};n.request.post("/bi/columnValues",E).then(function(I){a.value=I.data.map(V=>({label:V,value:V}))})}function x(f){if(!l.c._ui_select_source_datamodel||!l.c._ui_select_source_datamodel_label||!l.c._ui_select_source_datamodel_value){a.value=[];return}const D=l.c._ui_select_source_datamodel_label.split("."),E=l.c._ui_select_source_datamodel_value.split("."),I=[];f&&I.push({key:D[1],operation:"LIKE",value:f});const V={config:{dumpMode:"JSON",dataModel:l.c._ui_select_source_datamodel,dimension:[{id:"label",entity:D[0],key:D[1]},{id:"value",entity:E[0],key:E[1]}]},filters:I};n.request.post("/bi/build",V).then(function(K){a.value=K.data})}function v(f){const D=l.c._ui_select_source_manual;if(!D){a.value=[];return}const E=[];for(const I of D.split(`
`)){if(!I)continue;const V=I.split("~");E.push({value:V[0],label:V.length>1?V[1]:V[0]})}a.value=E}return(f,D)=>{const E=S("el-option"),I=S("el-select");return _(),O(I,{modelValue:o.value,"onUpdate:modelValue":D[0]||(D[0]=V=>o.value=V),filterable:"",clearable:"",remote:u.value,"remote-method":d,placeholder:s.value,multiple:r.value},{default:w(()=>[(_(!0),N(Y,null,j(a.value,V=>(_(),O(E,{key:V.value,label:V.label,value:V.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","remote","placeholder","multiple"])}}}),oo={style:{display:"inline-flex",width:"100%"}},io={key:0},ao=W({__name:"CriteriaDatetime",props:ve(["config","c"],{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=e,o=se(t,l.c.id+"-match"),a=se(t,l.c.id),n=se(t,l.c.id+"-to");return(i,u)=>{const s=S("el-option"),r=S("el-select"),d=S("el-date-picker");return _(),N("span",oo,[Ee(p(r,{style:{"flex-basis":"86px","flex-grow":"1","margin-right":"2px"},modelValue:m(o),"onUpdate:modelValue":u[0]||(u[0]=c=>oe(o)?o.value=c:null),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(gl),c=>(_(),O(s,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),[[Me,!e.c._ui_hide_match]]),p(d,{clearable:"",style:{"flex-basis":"0","flex-grow":"10"},type:"datetime",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:m(a),"onUpdate:modelValue":u[1]||(u[1]=c=>oe(a)?a.value=c:null)},null,8,["modelValue"]),t.value[e.c.id+"-match"]=="_RANGE"?(_(),N("span",io,"~")):P("",!0),t.value[e.c.id+"-match"]=="_RANGE"?(_(),O(d,{key:1,clearable:"",style:{"flex-basis":"0","flex-grow":"10"},type:"datetime",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:m(n),"onUpdate:modelValue":u[2]||(u[2]=c=>oe(n)?n.value=c:null)},null,8,["modelValue"])):P("",!0)])}}}),no={style:{display:"inline-flex",width:"100%"}},ro={key:0},uo=W({__name:"CriteriaTime",props:ve(["config","c"],{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=e,o=se(t,l.c.id+"-match"),a=se(t,l.c.id),n=se(t,l.c.id+"-to");return(i,u)=>{const s=S("el-option"),r=S("el-select"),d=S("el-time-picker");return _(),N("span",no,[Ee(p(r,{style:{"flex-basis":"86px","flex-grow":"1","margin-right":"2px"},modelValue:m(o),"onUpdate:modelValue":u[0]||(u[0]=c=>oe(o)?o.value=c:null),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(bl),c=>(_(),O(s,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),[[Me,!e.c._ui_hide_match]]),p(d,{clearable:"",style:{"flex-basis":"0","flex-grow":"10"},format:"HH:mm:ss","value-format":"HH:mm:ss",modelValue:m(a),"onUpdate:modelValue":u[1]||(u[1]=c=>oe(a)?a.value=c:null)},null,8,["modelValue"]),t.value[e.c.id+"-match"]=="_RANGE"?(_(),N("span",ro,"~")):P("",!0),t.value[e.c.id+"-match"]=="_RANGE"?(_(),O(d,{key:1,clearable:"",style:{"flex-basis":"0","flex-grow":"10"},format:"HH:mm:ss","value-format":"HH:mm:ss",modelValue:m(n),"onUpdate:modelValue":u[2]||(u[2]=c=>oe(n)?n.value=c:null)},null,8,["modelValue"])):P("",!0)])}}});function so(e,t,l,o){if(!t.filter||t.filter.length==0)return{"~":"span","#":h.t("bi.widgets.filter.render.empty")};const a=Math.min(Math.max(1,Math.floor(24/(t.qtyPerRow||6))),24),n={"~":"el-form",model:e,inline:!0,"label-position":t.labelPosition||"left","label-width":t.labelWidth||"120px",class:"el-row bi-filter-form","#":[]};for(const u of t.filter||[]){const s={"~":"el-form-item",label:u.label,class:"el-col el-col-"+po(a,u),"#":co(e,t,u)};n["#"].push(s)}const i=[{"~":"el-button",type:"primary","@click":()=>o.mitt.emit("bi_filter_reload",t.dataModel),"#":[{"~":"lc-icon",icon:"mdiMagnify",size:"small",style:{"margin-right":"6px"}},h.t("bi.widgets.filter.render.query")]}];return t.showButtonReset&&i.push({"~":"el-button",type:"danger","@click":()=>{const u=l.config.data.dataKey,s=cl(t);o.d.set(u,s)},"#":[{"~":"lc-icon",icon:"mdiRestore",size:"small",style:{"margin-right":"6px"}},h.t("bi.widgets.filter.render.reset")]}),n["#"].push({"~":"el-form-item",style:{"align-items":"flex-end","align-self":"flex-end","flex-grow":1},"#":{"~":"el-button-group",style:{"margin-left":"auto"},"#":i}}),n}function co(e,t,l){return l._ui_mode=="input"?{"~":Jl,"~modelValue":e,config:t,c:l}:l._ui_mode=="select"?mo(e,t,l):l._ui_mode=="input-number"?{"~":lo,"~modelValue":e,config:t,c:l}:l._ui_mode=="datetime"?{"~":ao,"~modelValue":e,config:t,c:l}:l._ui_mode=="time"?{"~":uo,"~modelValue":e,config:t,c:l}:{"~":"div","#":"Not support:"+l._ui_mode}}function mo(e,t,l){return{"~":hl,"~modelValue":e,config:t,c:l}}function po(e,t){return Math.min(24,e*(t._colSpan||1))}function se(e,t){return F({get:()=>m(e)[t],set:l=>{m(e)[t]=l}})}const fo={style:{margin:"10px"}},bo=W({__name:"Filter",props:ve(["config","fullConfig"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=e,o=Ue("context"),a=F(()=>so(t,l.config,l.fullConfig,o));return(n,i)=>{const u=S("MttkWrapComp");return _(),N("div",fo,[p(u,{config:a.value},null,8,["config"])])}}});function go({config:e,data:t,context:l,key:o,contextWrap:a,fullConfig:n}){const i=n.config.data.dataKey,u=l.d.getWithDefault(i,cl(n.config.model)),s={"~":bo,"~modelValue":u,config:n.config.model,fullConfig:n};return Kl(l,s)}const ho=W({__name:"DataModelTree",props:["modelValue"],setup(e){const t=e,l=De(""),o=F(()=>l.value?t.modelValue.columns.filter(r=>a(r,"column",l)||a(r,"label",l)):t.modelValue.columns);function a(r,d,c){const b=r[d];return b?b.indexOf(c.value)>=0:!0}const n=F(()=>r=>r.type=="hierarchy"?"mdiFileTreeOutline":r.type=="field"?r.dataType=="string"?"mdiFormatTextRotationNone":r.dataType=="integer"?"mdiOrderNumericAscending":r.dataType=="number"?"mdiDecimalIncrease":r.dataType=="boolean"?"mdiSortBoolAscending":r.dataType=="date"?"mdiCalendarRange":r.dataType=="datetime"?"mdiArchiveClockOutline":"mdiTooltipQuestionOutline":r.type=="expression"?"mdiCalculatorVariantOutline":"mdiTooltipQuestionOutline");function i({data:r}){return r.type=="field"||r.type=="expression"}function u(){return!1}function s({data:r},d){d.dataTransfer.setData("fieldJSON",JSON.stringify(r))}return(r,d)=>{const c=S("el-input"),b=S("lc-icon"),x=S("el-tree");return _(),N(Y,null,[p(c,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=v=>l.value=v),style:{margin:"8px 4px 8px 4px"},placeholder:"input to filter columns"},null,8,["modelValue"]),p(m(Xl),{gap:12},{default:w(()=>[p(x,{data:o.value,"allow-drag":i,"allow-drop":u,draggable:"","node-key":"key","default-expand-all":"","expand-on-click-node":!0,onNodeDragStart:s,"empty-text":r.$t("bi.components.dataModelTree.empty"),style:{"font-size":"0.9em","min-height":"40vh","overflow-x":"hidden"}},{default:w(({node:v,data:f})=>{var D;return[me("span",null,[p(b,{icon:n.value(f),tooltip:((D=m(Ql)(f.dataType))==null?void 0:D.label)||"","show-after":1e3,size:"1.2em",color:"#A9A9A9",style:{"margin-right":"8px"}},null,8,["icon","tooltip"]),p(dl,{value:v.label,length:8},null,8,["value"])])]}),_:1},8,["data","empty-text"])]),_:1})],64)}}}),vo=W({__name:"SelectRemote",props:ve(["url","request"],{modelValue:{},modelModifiers:{}}),emits:ve(["dataChanged"],["update:modelValue"]),setup(e,{emit:t}){const l=be(e,"modelValue"),o=e,a=t,n=De([]);o.request({method:"get",url:o.url}).then(function(s){n.value=s.list,u(!1)});function i(){ul(()=>u(!0))}function u(s){for(const r of n.value)r._id==l.value&&a("dataChanged",r,s)}return(s,r)=>{const d=S("el-option"),c=S("el-select");return _(),O(c,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=b=>l.value=b),size:"default",onChange:i},{default:w(()=>[(_(!0),N(Y,null,j(n.value,b=>(_(),O(d,{key:b._id,label:b.name,value:b._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])}}}),_o={style:{"font-size":"14px","font-weight":"400","line-height":"22px",color:"var(--el-text-color-regular)","margin-bottom":"8px"}},yo=W({__name:"DataModelHolder",props:{modelValue:{type:Object},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=Ue("appContext"),o=De({});Rl("dataModel",o);function a(n,i){var u,s,r,d,c,b,x,v,f;o.value=n,i&&((u=t.value.config)!=null&&u.basic["title-text"]||(t.value.config.basic["title-text"]=n.name),(r=(s=t.value.config)==null?void 0:s.model)!=null&&r.dimension&&(t.value.config.model.dimension=[]),(c=(d=t.value.config)==null?void 0:d.model)!=null&&c.metric&&(t.value.config.model.metric=[]),(x=(b=t.value.config)==null?void 0:b.model)!=null&&x.filter&&(t.value.config.model.filter=[]),(f=(v=t.value.config)==null?void 0:v.model)!=null&&f.drilling&&(t.value.config.model.drilling=[]))}return Ut(()=>{document.body.ondrop=function(n){n.preventDefault(),n.stopPropagation()}}),(n,i)=>{const u=S("el-form"),s=S("el-col"),r=S("el-row");return _(),O(r,{gutter:4},{default:w(()=>[p(s,{span:12},{default:w(()=>[p(u,{model:t.value.config.model,"label-position":"top",class:"dataModelHolderForm"},{default:w(()=>[Yl(n.$slots,"default")]),_:3},8,["model"])]),_:3}),p(s,{span:12},{default:w(()=>[me("div",_o,Ae(n.$t("bi.components.dataModelHolder.name")),1),p(vo,{modelValue:t.value.config.model.dataModel,"onUpdate:modelValue":i[0]||(i[0]=d=>t.value.config.model.dataModel=d),onDataChanged:a,url:"/bi/dataModel/query?app="+m(l).getKey(),request:m(l).globalContext.request},null,8,["modelValue","url","request"]),p(ho,{modelValue:o.value},null,8,["modelValue"])]),_:1})]),_:3})}}}),wo=W({__name:"DataModelFieldEditNormal",props:["modelValue","column","prop","option"],emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=t,{modelValue:a}=At(l,o);function n(...i){for(const u of i)if((l.prop||"").startsWith(u))return!0;return!1}return(i,u)=>{const s=S("el-input"),r=S("el-form-item"),d=S("el-radio-button"),c=S("el-radio-group"),b=S("el-option"),x=S("el-select"),v=S("el-input-number"),f=S("el-switch"),D=S("el-col"),E=S("el-row"),I=S("el-form");return _(),O(I,{model:m(a),"label-width":"180px","label-position":"right"},{default:w(()=>[p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.label")},{default:w(()=>[p(s,{modelValue:m(a).label,"onUpdate:modelValue":u[0]||(u[0]=V=>m(a).label=V),required:""},null,8,["modelValue"])]),_:1},8,["label"]),p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.sort")},{default:w(()=>[p(c,{modelValue:m(a)._sort,"onUpdate:modelValue":u[1]||(u[1]=V=>m(a)._sort=V)},{default:w(()=>[p(d,{value:"NONE"},{default:w(()=>[at(Ae(i.$t("bi.components.dataModelFieldEditNormal.sort_none")),1)]),_:1}),p(d,{value:"ASC"},{default:w(()=>[at(Ae(i.$t("bi.components.dataModelFieldEditNormal.sort_asc")),1)]),_:1}),p(d,{value:"DESC"},{default:w(()=>[at(Ae(i.$t("bi.components.dataModelFieldEditNormal.sort_desc")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),Ee(me("div",null,[p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation")},{default:w(()=>[p(x,{modelValue:m(a)._aggregation,"onUpdate:modelValue":u[2]||(u[2]=V=>m(a)._aggregation=V)},{default:w(()=>[p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_none"),value:"_NONE"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_sum"),value:"SUM"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_avg"),value:"AVG"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_count"),value:"COUNT"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_count_distinct"),value:"_COUNT_DISTINCT"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_max"),value:"MAX"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_min"),value:"MIN"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),Ee(p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.aggregation_customize")},{default:w(()=>[p(s,{modelValue:m(a)._aggregation_customize,"onUpdate:modelValue":u[3]||(u[3]=V=>m(a)._aggregation_customize=V)},null,8,["modelValue"])]),_:1},8,["label"]),[[Me,m(a)._aggregation=="_CUSTOMIZE"]])],512),[[Me,n("metric")]]),Ee(me("div",null,[p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime")},{default:w(()=>[p(x,{modelValue:m(a)._format_datetime,"onUpdate:modelValue":u[4]||(u[4]=V=>m(a)._format_datetime=V)},{default:w(()=>[p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime_none"),value:"none"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime_y"),value:"y"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime_yq"),value:"yq"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime_ym"),value:"ym"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime_ymd"),value:"ymd"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime_h"),value:"h"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_datetime_hm"),value:"hm"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])],512),[[Me,(e.column.dataType=="datetime"||e.column.dataType=="time")&&n("metric","dimension","drilling")]]),Ee(me("div",null,[p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter")},{default:w(()=>[p(x,{modelValue:m(a)._format_number_converter,"onUpdate:modelValue":u[5]||(u[5]=V=>m(a)._format_number_converter=V)},{default:w(()=>[p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_none"),value:"none"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_ch_auto"),value:"ch_auto"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_en_auto"),value:"en_auto"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_percentage"),value:"percentage"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_ch_qian"),value:"ch_qian"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_ch_wan"),value:"ch_wan"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_ch_baiwan"),value:"ch_baiwan"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_ch_qianwan"),value:"ch_qianwan"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_ch_yi"),value:"ch_yi"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_en_k"),value:"en_k"},null,8,["label"]),p(b,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_converter_en_m"),value:"en_m"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_point")},{default:w(()=>[p(v,{modelValue:m(a)._format_number_point,"onUpdate:modelValue":u[6]||(u[6]=V=>m(a)._format_number_point=V),min:0,max:20},null,8,["modelValue"])]),_:1},8,["label"]),p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_thousandth_mark")},{default:w(()=>[p(f,{modelValue:m(a)._format_number_thousandth_mark,"onUpdate:modelValue":u[7]||(u[7]=V=>m(a)._format_number_thousandth_mark=V),"active-text":""},null,8,["modelValue"])]),_:1},8,["label"]),p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_negative")},{default:w(()=>[p(x,{modelValue:m(a)._format_number_negative,"onUpdate:modelValue":u[8]||(u[8]=V=>m(a)._format_number_negative=V)},{default:w(()=>[p(b,{label:"-1234",value:"none"}),p(b,{label:"(1234)",value:"bracketed"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(E,{gutter:20},{default:w(()=>[p(D,{span:12},{default:w(()=>[p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_prefix")},{default:w(()=>[p(s,{modelValue:m(a)._format_number_prefix,"onUpdate:modelValue":u[9]||(u[9]=V=>m(a)._format_number_prefix=V)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),p(D,{span:12},{default:w(()=>[p(r,{label:i.$t("bi.components.dataModelFieldEditNormal.format_number_suffix"),"label-width":"60px"},{default:w(()=>[p(s,{modelValue:m(a)._format_number_suffix,"onUpdate:modelValue":u[10]||(u[10]=V=>m(a)._format_number_suffix=V)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})],512),[[Me,(e.column.dataType=="integer"||e.column.dataType=="number"||(m(a)._aggregation||"_NONE")!="_NONE")&&n("metric","dimension")]])]),_:1},8,["model"])}}}),Vo=W({__name:"DataModelFieldEdit",props:["modelValue","modelConfig","column","prop","option"],emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=t,{modelValue:a}=At(l,o),n=De(!1),i=F(()=>l.option.editComponent?l.option.editComponent:wo);function u(){o("update:modelValue",a?.value)}return(s,r)=>{const d=S("lc-icon"),c=S("el-dialog");return _(),N(Y,null,[p(d,{icon:"mdiSquareEditOutline",size:"1.2em",color:"#A9A9A9",style:{"margin-right":"1px"},onClick:r[0]||(r[0]=b=>n.value=!0)}),p(c,{modelValue:n.value,"onUpdate:modelValue":r[2]||(r[2]=b=>n.value=b),title:s.$t("_._.edit"),width:"50%","append-to-body":!0,onClose:u},{default:w(()=>[(_(),O(Wl(i.value),{modelValue:m(a),"onUpdate:modelValue":r[1]||(r[1]=b=>oe(a)?a.value=b:null),prop:s.$props.prop,column:l.column,option:l.option,modelConfig:l.modelConfig},null,8,["modelValue","prop","column","option","modelConfig"]))]),_:1},8,["modelValue","title"])],64)}}}),xo={class:"toolbar"},Eo={class:"left handle",style:{padding:"0"}},Mo={class:"right",style:{padding:"0"}},So=W({__name:"DataModelField",props:["modelValue","modelConfig","prop","option"],emits:["delete"],setup(e,{emit:t}){const l=e,o=t,a=Ue("dataModel"),n=F(()=>i(a.value.columns,l.modelValue.key));function i(r,d){if(!(!d||!r))for(const c of r){if(c.key==d)return c;if(c.children){const b=i(c.children,d);if(b)return b}}}const u=F(()=>{var r,d,c,b;const x=l.modelValue._aggregation;return x&&x!="_NONE"?x=="_COUNT_DISTINCT"?"COUNT(DISTINCT "+((r=l.modelValue)==null?void 0:r.label)+")":x=="_CUSTOMIZE"?(d=l.modelValue)==null?void 0:d.label:l.modelValue._aggregation+"("+((c=l.modelValue)==null?void 0:c.label)+")":(b=l.modelValue)==null?void 0:b.label});function s(){o("delete",l.modelValue)}return(r,d)=>{const c=S("lc-icon");return _(),N("div",xo,[me("span",Eo,[p(c,{icon:"mdiDrag",size:"1.2em",color:"#A9A9A9",style:{"margin-right":"2px"}}),p(dl,{value:u.value,length:8},null,8,["value"])]),me("span",Mo,[p(Vo,{modelValue:r.$props.modelValue,"onUpdate:modelValue":d[0]||(d[0]=b=>r.$props.modelValue=b),prop:r.$props.prop,option:r.$props.option,column:n.value,modelConfig:l.modelConfig},null,8,["modelValue","prop","option","column","modelConfig"]),p(c,{icon:"mdiTrashCanOutline",size:"1.2em",color:"#A9A9A9",style:{"margin-right":"0px"},onClick:s})])])}}}),Do=sl(So,[["__scopeId","data-v-4fa47cb8"]]);var To=Object.defineProperty,ct=Object.getOwnPropertySymbols,vl=Object.prototype.hasOwnProperty,_l=Object.prototype.propertyIsEnumerable,Wt=(e,t,l)=>t in e?To(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,Ye=(e,t)=>{for(var l in t||(t={}))vl.call(t,l)&&Wt(e,l,t[l]);if(ct)for(var l of ct(t))_l.call(t,l)&&Wt(e,l,t[l]);return e},yl=(e,t)=>{var l={};for(var o in e)vl.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(e!=null&&ct)for(var o of ct(e))t.indexOf(o)<0&&_l.call(e,o)&&(l[o]=e[o]);return l};const wl="[vue-draggable-plus]: ";function Oo(e){console.warn(wl+e)}function No(e){console.error(wl+e)}function Gt(e,t,l){return l>=0&&l<e.length&&e.splice(l,0,e.splice(t,1)[0]),e}function ko(e){return e.replace(/-(\w)/g,(t,l)=>l?l.toUpperCase():"")}function Co(e){return Object.keys(e).reduce((t,l)=>(typeof e[l]<"u"&&(t[ko(l)]=e[l]),t),{})}function Io(e,t){if(Array.isArray(e))return e.splice(t,1)}function Ao(e,t,l){if(Array.isArray(e))return e.splice(t,0,l)}function Uo(e){return typeof e>"u"}function $o(e){return typeof e=="string"}function Kt(e,t,l){const o=e.children[l];e.insertBefore(t,o)}function _t(e){e.parentNode&&e.parentNode.removeChild(e)}function Fo(e,t=document){var l;let o=null;return typeof t?.querySelector=="function"?o=(l=t?.querySelector)==null?void 0:l.call(t,e):o=document.querySelector(e),o||Oo(`Element not found: ${e}`),o}function Po(e,t,l=null){return function(...o){return e.apply(l,o),t.apply(l,o)}}function Ro(e,t){const l=Ye({},e);return Object.keys(t).forEach(o=>{l[o]?l[o]=Po(e[o],t[o]):l[o]=t[o]}),l}function Yo(e){return e instanceof HTMLElement}function Bo(e,t){Object.keys(e).forEach(l=>{t(l,e[l])})}/**!
 * Sortable 1.15.1
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Qt(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),l.push.apply(l,o)}return l}function fe(e){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?arguments[t]:{};t%2?Qt(Object(l),!0).forEach(function(o){Ho(e,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):Qt(Object(l)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(l,o))})}return e}function nt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nt=function(t){return typeof t}:nt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(e)}function Ho(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function _e(){return _e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o])}return e},_e.apply(this,arguments)}function jo(e,t){if(e==null)return{};var l={},o=Object.keys(e),a,n;for(n=0;n<o.length;n++)a=o[n],!(t.indexOf(a)>=0)&&(l[a]=e[a]);return l}function Lo(e,t){if(e==null)return{};var l=jo(e,t),o,a;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)o=n[a],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(l[o]=e[o])}return l}var Xo="1.15.1";function he(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var ye=he(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Je=he(/Edge/i),Zt=he(/firefox/i),We=he(/safari/i)&&!he(/chrome/i)&&!he(/android/i),Vl=he(/iP(ad|od|hone)/i),xl=he(/chrome/i)&&he(/android/i),El={capture:!1,passive:!1};function U(e,t,l){e.addEventListener(t,l,!ye&&El)}function A(e,t,l){e.removeEventListener(t,l,!ye&&El)}function mt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function qo(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ce(e,t,l,o){if(e){l=l||document;do{if(t!=null&&(t[0]===">"?e.parentNode===l&&mt(e,t):mt(e,t))||o&&e===l)return e;if(e===l)break}while(e=qo(e))}return null}var Jt=/\s+/g;function ie(e,t,l){if(e&&t)if(e.classList)e.classList[l?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(Jt," ").replace(" "+t+" "," ");e.className=(o+(l?" "+t:"")).replace(Jt," ")}}function M(e,t,l){var o=e&&e.style;if(o){if(l===void 0)return document.defaultView&&document.defaultView.getComputedStyle?l=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(l=e.currentStyle),t===void 0?l:l[t];!(t in o)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),o[t]=l+(typeof l=="string"?"":"px")}}function He(e,t){var l="";if(typeof e=="string")l=e;else do{var o=M(e,"transform");o&&o!=="none"&&(l=o+" "+l)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(l)}function Ml(e,t,l){if(e){var o=e.getElementsByTagName(t),a=0,n=o.length;if(l)for(;a<n;a++)l(o[a],a);return o}return[]}function pe(){var e=document.scrollingElement;return e||document.documentElement}function q(e,t,l,o,a){if(!(!e.getBoundingClientRect&&e!==window)){var n,i,u,s,r,d,c;if(e!==window&&e.parentNode&&e!==pe()?(n=e.getBoundingClientRect(),i=n.top,u=n.left,s=n.bottom,r=n.right,d=n.height,c=n.width):(i=0,u=0,s=window.innerHeight,r=window.innerWidth,d=window.innerHeight,c=window.innerWidth),(t||l)&&e!==window&&(a=a||e.parentNode,!ye))do if(a&&a.getBoundingClientRect&&(M(a,"transform")!=="none"||l&&M(a,"position")!=="static")){var b=a.getBoundingClientRect();i-=b.top+parseInt(M(a,"border-top-width")),u-=b.left+parseInt(M(a,"border-left-width")),s=i+n.height,r=u+n.width;break}while(a=a.parentNode);if(o&&e!==window){var x=He(a||e),v=x&&x.a,f=x&&x.d;x&&(i/=f,u/=v,c/=v,d/=f,s=i+d,r=u+c)}return{top:i,left:u,bottom:s,right:r,width:c,height:d}}}function Sl(e){var t=q(e),l=parseInt(M(e,"padding-left")),o=parseInt(M(e,"padding-top")),a=parseInt(M(e,"padding-right")),n=parseInt(M(e,"padding-bottom"));return t.top+=o+parseInt(M(e,"border-top-width")),t.left+=l+parseInt(M(e,"border-left-width")),t.width=e.clientWidth-l-a,t.height=e.clientHeight-o-n,t.bottom=t.top+t.height,t.right=t.left+t.width,t}function el(e,t,l){for(var o=Se(e,!0),a=q(e)[t];o;){var n=q(o)[l],i=void 0;if(l==="top"||l==="left"?i=a>=n:i=a<=n,!i)return o;if(o===pe())break;o=Se(o,!1)}return!1}function je(e,t,l,o){for(var a=0,n=0,i=e.children;n<i.length;){if(i[n].style.display!=="none"&&i[n]!==T.ghost&&(o||i[n]!==T.dragged)&&ce(i[n],l.draggable,e,!1)){if(a===t)return i[n];a++}n++}return null}function Ft(e,t){for(var l=e.lastElementChild;l&&(l===T.ghost||M(l,"display")==="none"||t&&!mt(l,t));)l=l.previousElementSibling;return l||null}function ue(e,t){var l=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==T.clone&&(!t||mt(e,t))&&l++;return l}function tl(e){var t=0,l=0,o=pe();if(e)do{var a=He(e),n=a.a,i=a.d;t+=e.scrollLeft*n,l+=e.scrollTop*i}while(e!==o&&(e=e.parentNode));return[t,l]}function zo(e,t){for(var l in e)if(e.hasOwnProperty(l)){for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[l][o])return Number(l)}return-1}function Se(e,t){if(!e||!e.getBoundingClientRect)return pe();var l=e,o=!1;do if(l.clientWidth<l.scrollWidth||l.clientHeight<l.scrollHeight){var a=M(l);if(l.clientWidth<l.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||l.clientHeight<l.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!l.getBoundingClientRect||l===document.body)return pe();if(o||t)return l;o=!0}}while(l=l.parentNode);return pe()}function Wo(e,t){if(e&&t)for(var l in t)t.hasOwnProperty(l)&&(e[l]=t[l]);return e}function yt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Ge;function Dl(e,t){return function(){if(!Ge){var l=arguments,o=this;l.length===1?e.call(o,l[0]):e.apply(o,l),Ge=setTimeout(function(){Ge=void 0},t)}}}function Go(){clearTimeout(Ge),Ge=void 0}function Tl(e,t,l){e.scrollLeft+=t,e.scrollTop+=l}function Ol(e){var t=window.Polymer,l=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):l?l(e).clone(!0)[0]:e.cloneNode(!0)}var ne="Sortable"+new Date().getTime();function Ko(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var l=[].slice.call(this.el.children);l.forEach(function(o){if(!(M(o,"display")==="none"||o===T.ghost)){e.push({target:o,rect:q(o)});var a=fe({},e[e.length-1].rect);if(o.thisAnimationDuration){var n=He(o,!0);n&&(a.top-=n.f,a.left-=n.e)}o.fromRect=a}})}},addAnimationState:function(l){e.push(l)},removeAnimationState:function(l){e.splice(zo(e,{target:l}),1)},animateAll:function(l){var o=this;if(!this.options.animation){clearTimeout(t),typeof l=="function"&&l();return}var a=!1,n=0;e.forEach(function(i){var u=0,s=i.target,r=s.fromRect,d=q(s),c=s.prevFromRect,b=s.prevToRect,x=i.rect,v=He(s,!0);v&&(d.top-=v.f,d.left-=v.e),s.toRect=d,s.thisAnimationDuration&&yt(c,d)&&!yt(r,d)&&(x.top-d.top)/(x.left-d.left)===(r.top-d.top)/(r.left-d.left)&&(u=Zo(x,c,b,o.options)),yt(d,r)||(s.prevFromRect=r,s.prevToRect=d,u||(u=o.options.animation),o.animate(s,x,d,u)),u&&(a=!0,n=Math.max(n,u),clearTimeout(s.animationResetTimer),s.animationResetTimer=setTimeout(function(){s.animationTime=0,s.prevFromRect=null,s.fromRect=null,s.prevToRect=null,s.thisAnimationDuration=null},u),s.thisAnimationDuration=u)}),clearTimeout(t),a?t=setTimeout(function(){typeof l=="function"&&l()},n):typeof l=="function"&&l(),e=[]},animate:function(l,o,a,n){if(n){M(l,"transition",""),M(l,"transform","");var i=He(this.el),u=i&&i.a,s=i&&i.d,r=(o.left-a.left)/(u||1),d=(o.top-a.top)/(s||1);l.animatingX=!!r,l.animatingY=!!d,M(l,"transform","translate3d("+r+"px,"+d+"px,0)"),this.forRepaintDummy=Qo(l),M(l,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),M(l,"transform","translate3d(0,0,0)"),typeof l.animated=="number"&&clearTimeout(l.animated),l.animated=setTimeout(function(){M(l,"transition",""),M(l,"transform",""),l.animated=!1,l.animatingX=!1,l.animatingY=!1},n)}}}}function Qo(e){return e.offsetWidth}function Zo(e,t,l,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-l.top,2)+Math.pow(t.left-l.left,2))*o.animation}var Fe=[],wt={initializeByDefault:!0},et={mount:function(e){for(var t in wt)wt.hasOwnProperty(t)&&!(t in e)&&(e[t]=wt[t]);Fe.forEach(function(l){if(l.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Fe.push(e)},pluginEvent:function(e,t,l){var o=this;this.eventCanceled=!1,l.cancel=function(){o.eventCanceled=!0};var a=e+"Global";Fe.forEach(function(n){t[n.pluginName]&&(t[n.pluginName][a]&&t[n.pluginName][a](fe({sortable:t},l)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](fe({sortable:t},l)))})},initializePlugins:function(e,t,l,o){Fe.forEach(function(i){var u=i.pluginName;if(!(!e.options[u]&&!i.initializeByDefault)){var s=new i(e,t,e.options);s.sortable=e,s.options=e.options,e[u]=s,_e(l,s.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var n=this.modifyOption(e,a,e.options[a]);typeof n<"u"&&(e.options[a]=n)}},getEventProperties:function(e,t){var l={};return Fe.forEach(function(o){typeof o.eventProperties=="function"&&_e(l,o.eventProperties.call(t[o.pluginName],e))}),l},modifyOption:function(e,t,l){var o;return Fe.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[t]=="function"&&(o=a.optionListeners[t].call(e[a.pluginName],l))}),o}};function Jo(e){var t=e.sortable,l=e.rootEl,o=e.name,a=e.targetEl,n=e.cloneEl,i=e.toEl,u=e.fromEl,s=e.oldIndex,r=e.newIndex,d=e.oldDraggableIndex,c=e.newDraggableIndex,b=e.originalEvent,x=e.putSortable,v=e.extraEventProperties;if(t=t||l&&l[ne],!!t){var f,D=t.options,E="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!ye&&!Je?f=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent(o,!0,!0)),f.to=i||l,f.from=u||l,f.item=a||l,f.clone=n,f.oldIndex=s,f.newIndex=r,f.oldDraggableIndex=d,f.newDraggableIndex=c,f.originalEvent=b,f.pullMode=x?x.lastPutMode:void 0;var I=fe(fe({},v),et.getEventProperties(o,t));for(var V in I)f[V]=I[V];l&&l.dispatchEvent(f),D[E]&&D[E].call(t,f)}}var ei=["evt"],le=function(e,t){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=l.evt,a=Lo(l,ei);et.pluginEvent.bind(T)(e,t,fe({dragEl:y,parentEl:H,ghostEl:C,rootEl:R,nextEl:Ie,lastDownEl:rt,cloneEl:B,cloneHidden:xe,dragStarted:Xe,putSortable:z,activeSortable:T.active,originalEvent:o,oldIndex:Be,oldDraggableIndex:Ke,newIndex:ae,newDraggableIndex:Ve,hideGhostForTarget:Il,unhideGhostForTarget:Al,cloneNowHidden:function(){xe=!0},cloneNowShown:function(){xe=!1},dispatchSortableEvent:function(n){te({sortable:t,name:n,originalEvent:o})}},a))};function te(e){Jo(fe({putSortable:z,cloneEl:B,targetEl:y,rootEl:R,oldIndex:Be,oldDraggableIndex:Ke,newIndex:ae,newDraggableIndex:Ve},e))}var y,H,C,R,Ie,rt,B,xe,Be,ae,Ke,Ve,tt,z,Re=!1,pt=!1,ft=[],Ne,de,Vt,xt,ll,ol,Xe,Pe,Qe,Ze=!1,lt=!1,ut,G,Et=[],Ot=!1,bt=[],ht=typeof document<"u",ot=Vl,il=Je||ye?"cssFloat":"float",ti=ht&&!xl&&!Vl&&"draggable"in document.createElement("div"),Nl=function(){if(ht){if(ye)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),kl=function(e,t){var l=M(e),o=parseInt(l.width)-parseInt(l.paddingLeft)-parseInt(l.paddingRight)-parseInt(l.borderLeftWidth)-parseInt(l.borderRightWidth),a=je(e,0,t),n=je(e,1,t),i=a&&M(a),u=n&&M(n),s=i&&parseInt(i.marginLeft)+parseInt(i.marginRight)+q(a).width,r=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+q(n).width;if(l.display==="flex")return l.flexDirection==="column"||l.flexDirection==="column-reverse"?"vertical":"horizontal";if(l.display==="grid")return l.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&i.float&&i.float!=="none"){var d=i.float==="left"?"left":"right";return n&&(u.clear==="both"||u.clear===d)?"vertical":"horizontal"}return a&&(i.display==="block"||i.display==="flex"||i.display==="table"||i.display==="grid"||s>=o&&l[il]==="none"||n&&l[il]==="none"&&s+r>o)?"vertical":"horizontal"},li=function(e,t,l){var o=l?e.left:e.top,a=l?e.right:e.bottom,n=l?e.width:e.height,i=l?t.left:t.top,u=l?t.right:t.bottom,s=l?t.width:t.height;return o===i||a===u||o+n/2===i+s/2},oi=function(e,t){var l;return ft.some(function(o){var a=o[ne].options.emptyInsertThreshold;if(!(!a||Ft(o))){var n=q(o),i=e>=n.left-a&&e<=n.right+a,u=t>=n.top-a&&t<=n.bottom+a;if(i&&u)return l=o}}),l},Cl=function(e){function t(a,n){return function(i,u,s,r){var d=i.options.group.name&&u.options.group.name&&i.options.group.name===u.options.group.name;if(a==null&&(n||d))return!0;if(a==null||a===!1)return!1;if(n&&a==="clone")return a;if(typeof a=="function")return t(a(i,u,s,r),n)(i,u,s,r);var c=(n?i:u).options.group.name;return a===!0||typeof a=="string"&&a===c||a.join&&a.indexOf(c)>-1}}var l={},o=e.group;(!o||nt(o)!="object")&&(o={name:o}),l.name=o.name,l.checkPull=t(o.pull,!0),l.checkPut=t(o.put),l.revertClone=o.revertClone,e.group=l},Il=function(){!Nl&&C&&M(C,"display","none")},Al=function(){!Nl&&C&&M(C,"display","")};ht&&!xl&&document.addEventListener("click",function(e){if(pt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),pt=!1,!1},!0);var ke=function(e){if(y){e=e.touches?e.touches[0]:e;var t=oi(e.clientX,e.clientY);if(t){var l={};for(var o in e)e.hasOwnProperty(o)&&(l[o]=e[o]);l.target=l.rootEl=t,l.preventDefault=void 0,l.stopPropagation=void 0,t[ne]._onDragOver(l)}}},ii=function(e){y&&y.parentNode[ne]._isOutsideThisEl(e.target)};function T(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=_e({},t),e[ne]=this;var l={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return kl(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(n,i){n.setData("Text",i.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:T.supportPointer!==!1&&"PointerEvent"in window&&!We,emptyInsertThreshold:5};et.initializePlugins(this,e,l);for(var o in l)!(o in t)&&(t[o]=l[o]);Cl(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:ti,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?U(e,"pointerdown",this._onTapStart):(U(e,"mousedown",this._onTapStart),U(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(U(e,"dragover",this),U(e,"dragenter",this)),ft.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),_e(this,Ko())}T.prototype={constructor:T,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Pe=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,y):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,l=this.el,o=this.options,a=o.preventOnFilter,n=e.type,i=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,u=(i||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||u,r=o.filter;if(mi(l),!y&&!(/mousedown|pointerdown/.test(n)&&e.button!==0||o.disabled)&&!s.isContentEditable&&!(!this.nativeDraggable&&We&&u&&u.tagName.toUpperCase()==="SELECT")&&(u=ce(u,o.draggable,l,!1),!(u&&u.animated)&&rt!==u)){if(Be=ue(u),Ke=ue(u,o.draggable),typeof r=="function"){if(r.call(this,e,u,this)){te({sortable:t,rootEl:s,name:"filter",targetEl:u,toEl:l,fromEl:l}),le("filter",t,{evt:e}),a&&e.cancelable&&e.preventDefault();return}}else if(r&&(r=r.split(",").some(function(d){if(d=ce(s,d.trim(),l,!1),d)return te({sortable:t,rootEl:d,name:"filter",targetEl:u,fromEl:l,toEl:l}),le("filter",t,{evt:e}),!0}),r)){a&&e.cancelable&&e.preventDefault();return}o.handle&&!ce(s,o.handle,l,!1)||this._prepareDragStart(e,i,u)}}},_prepareDragStart:function(e,t,l){var o=this,a=o.el,n=o.options,i=a.ownerDocument,u;if(l&&!y&&l.parentNode===a){var s=q(l);if(R=a,y=l,H=y.parentNode,Ie=y.nextSibling,rt=l,tt=n.group,T.dragged=y,Ne={target:y,clientX:(t||e).clientX,clientY:(t||e).clientY},ll=Ne.clientX-s.left,ol=Ne.clientY-s.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,y.style["will-change"]="all",u=function(){if(le("delayEnded",o,{evt:e}),T.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Zt&&o.nativeDraggable&&(y.draggable=!0),o._triggerDragStart(e,t),te({sortable:o,name:"choose",originalEvent:e}),ie(y,n.chosenClass,!0)},n.ignore.split(",").forEach(function(r){Ml(y,r.trim(),Mt)}),U(i,"dragover",ke),U(i,"mousemove",ke),U(i,"touchmove",ke),U(i,"mouseup",o._onDrop),U(i,"touchend",o._onDrop),U(i,"touchcancel",o._onDrop),Zt&&this.nativeDraggable&&(this.options.touchStartThreshold=4,y.draggable=!0),le("delayStart",this,{evt:e}),n.delay&&(!n.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(Je||ye))){if(T.eventCanceled){this._onDrop();return}U(i,"mouseup",o._disableDelayedDrag),U(i,"touchend",o._disableDelayedDrag),U(i,"touchcancel",o._disableDelayedDrag),U(i,"mousemove",o._delayedDragTouchMoveHandler),U(i,"touchmove",o._delayedDragTouchMoveHandler),n.supportPointer&&U(i,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(u,n.delay)}else u()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){y&&Mt(y),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;A(e,"mouseup",this._disableDelayedDrag),A(e,"touchend",this._disableDelayedDrag),A(e,"touchcancel",this._disableDelayedDrag),A(e,"mousemove",this._delayedDragTouchMoveHandler),A(e,"touchmove",this._delayedDragTouchMoveHandler),A(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?U(document,"pointermove",this._onTouchMove):t?U(document,"touchmove",this._onTouchMove):U(document,"mousemove",this._onTouchMove):(U(y,"dragend",this),U(R,"dragstart",this._onDragStart));try{document.selection?dt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(Re=!1,R&&y){le("dragStarted",this,{evt:t}),this.nativeDraggable&&U(document,"dragover",ii);var l=this.options;!e&&ie(y,l.dragClass,!1),ie(y,l.ghostClass,!0),T.active=this,e&&this._appendGhost(),te({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(de){this._lastX=de.clientX,this._lastY=de.clientY,Il();for(var e=document.elementFromPoint(de.clientX,de.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(de.clientX,de.clientY),e!==t);)t=e;if(y.parentNode[ne]._isOutsideThisEl(e),t)do{if(t[ne]){var l=void 0;if(l=t[ne]._onDragOver({clientX:de.clientX,clientY:de.clientY,target:e,rootEl:t}),l&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Al()}},_onTouchMove:function(e){if(Ne){var t=this.options,l=t.fallbackTolerance,o=t.fallbackOffset,a=e.touches?e.touches[0]:e,n=C&&He(C,!0),i=C&&n&&n.a,u=C&&n&&n.d,s=ot&&G&&tl(G),r=(a.clientX-Ne.clientX+o.x)/(i||1)+(s?s[0]-Et[0]:0)/(i||1),d=(a.clientY-Ne.clientY+o.y)/(u||1)+(s?s[1]-Et[1]:0)/(u||1);if(!T.active&&!Re){if(l&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<l)return;this._onDragStart(e,!0)}if(C){n?(n.e+=r-(Vt||0),n.f+=d-(xt||0)):n={a:1,b:0,c:0,d:1,e:r,f:d};var c="matrix(".concat(n.a,",").concat(n.b,",").concat(n.c,",").concat(n.d,",").concat(n.e,",").concat(n.f,")");M(C,"webkitTransform",c),M(C,"mozTransform",c),M(C,"msTransform",c),M(C,"transform",c),Vt=r,xt=d,de=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!C){var e=this.options.fallbackOnBody?document.body:R,t=q(y,!0,ot,!0,e),l=this.options;if(ot){for(G=e;M(G,"position")==="static"&&M(G,"transform")==="none"&&G!==document;)G=G.parentNode;G!==document.body&&G!==document.documentElement?(G===document&&(G=pe()),t.top+=G.scrollTop,t.left+=G.scrollLeft):G=pe(),Et=tl(G)}C=y.cloneNode(!0),ie(C,l.ghostClass,!1),ie(C,l.fallbackClass,!0),ie(C,l.dragClass,!0),M(C,"transition",""),M(C,"transform",""),M(C,"box-sizing","border-box"),M(C,"margin",0),M(C,"top",t.top),M(C,"left",t.left),M(C,"width",t.width),M(C,"height",t.height),M(C,"opacity","0.8"),M(C,"position",ot?"absolute":"fixed"),M(C,"zIndex","100000"),M(C,"pointerEvents","none"),T.ghost=C,e.appendChild(C),M(C,"transform-origin",ll/parseInt(C.style.width)*100+"% "+ol/parseInt(C.style.height)*100+"%")}},_onDragStart:function(e,t){var l=this,o=e.dataTransfer,a=l.options;if(le("dragStart",this,{evt:e}),T.eventCanceled){this._onDrop();return}le("setupClone",this),T.eventCanceled||(B=Ol(y),B.removeAttribute("id"),B.draggable=!1,B.style["will-change"]="",this._hideClone(),ie(B,this.options.chosenClass,!1),T.clone=B),l.cloneId=dt(function(){le("clone",l),!T.eventCanceled&&(l.options.removeCloneOnHide||R.insertBefore(B,y),l._hideClone(),te({sortable:l,name:"clone"}))}),!t&&ie(y,a.dragClass,!0),t?(pt=!0,l._loopId=setInterval(l._emulateDragOver,50)):(A(document,"mouseup",l._onDrop),A(document,"touchend",l._onDrop),A(document,"touchcancel",l._onDrop),o&&(o.effectAllowed="move",a.setData&&a.setData.call(l,o,y)),U(document,"drop",l),M(y,"transform","translateZ(0)")),Re=!0,l._dragStartId=dt(l._dragStarted.bind(l,t,e)),U(document,"selectstart",l),Xe=!0,We&&M(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,l=e.target,o,a,n,i=this.options,u=i.group,s=T.active,r=tt===u,d=i.sort,c=z||s,b,x=this,v=!1;if(Ot)return;function f(Le,$l){le(Le,x,fe({evt:e,isOwner:r,axis:b?"vertical":"horizontal",revert:n,dragRect:o,targetRect:a,canSort:d,fromSortable:c,target:l,completed:E,onMove:function(Bt,Fl){return it(R,t,y,o,Bt,q(Bt),e,Fl)},changed:I},$l))}function D(){f("dragOverAnimationCapture"),x.captureAnimationState(),x!==c&&c.captureAnimationState()}function E(Le){return f("dragOverCompleted",{insertion:Le}),Le&&(r?s._hideClone():s._showClone(x),x!==c&&(ie(y,z?z.options.ghostClass:s.options.ghostClass,!1),ie(y,i.ghostClass,!0)),z!==x&&x!==T.active?z=x:x===T.active&&z&&(z=null),c===x&&(x._ignoreWhileAnimating=l),x.animateAll(function(){f("dragOverAnimationComplete"),x._ignoreWhileAnimating=null}),x!==c&&(c.animateAll(),c._ignoreWhileAnimating=null)),(l===y&&!y.animated||l===t&&!l.animated)&&(Pe=null),!i.dragoverBubble&&!e.rootEl&&l!==document&&(y.parentNode[ne]._isOutsideThisEl(e.target),!Le&&ke(e)),!i.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function I(){ae=ue(y),Ve=ue(y,i.draggable),te({sortable:x,name:"change",toEl:t,newIndex:ae,newDraggableIndex:Ve,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),l=ce(l,i.draggable,t,!0),f("dragOver"),T.eventCanceled)return v;if(y.contains(e.target)||l.animated&&l.animatingX&&l.animatingY||x._ignoreWhileAnimating===l)return E(!1);if(pt=!1,s&&!i.disabled&&(r?d||(n=H!==R):z===this||(this.lastPutMode=tt.checkPull(this,s,y,e))&&u.checkPut(this,s,y,e))){if(b=this._getDirection(e,l)==="vertical",o=q(y),f("dragOverValid"),T.eventCanceled)return v;if(n)return H=R,D(),this._hideClone(),f("revert"),T.eventCanceled||(Ie?R.insertBefore(y,Ie):R.appendChild(y)),E(!0);var V=Ft(t,i.draggable);if(!V||ui(e,b,this)&&!V.animated){if(V===y)return E(!1);if(V&&t===e.target&&(l=V),l&&(a=q(l)),it(R,t,y,o,l,a,e,!!l)!==!1)return D(),V&&V.nextSibling?t.insertBefore(y,V.nextSibling):t.appendChild(y),H=t,I(),E(!0)}else if(V&&ri(e,b,this)){var K=je(t,0,i,!0);if(K===y)return E(!1);if(l=K,a=q(l),it(R,t,y,o,l,a,e,!1)!==!1)return D(),t.insertBefore(y,K),H=t,I(),E(!0)}else if(l.parentNode===t){a=q(l);var Q=0,k,$=y.parentNode!==t,Z=!li(y.animated&&y.toRect||o,l.animated&&l.toRect||a,b),L=b?"top":"left",J=el(l,"top","top")||el(y,"top","top"),g=J?J.scrollTop:void 0;Pe!==l&&(k=a[L],Ze=!1,lt=!Z&&i.invertSwap||$),Q=di(e,l,a,b,Z?1:i.swapThreshold,i.invertedSwapThreshold==null?i.swapThreshold:i.invertedSwapThreshold,lt,Pe===l);var ee;if(Q!==0){var $e=ue(y);do $e-=Q,ee=H.children[$e];while(ee&&(M(ee,"display")==="none"||ee===C))}if(Q===0||ee===l)return E(!1);Pe=l,Qe=Q;var Te=l.nextElementSibling,we=!1;we=Q===1;var Oe=it(R,t,y,o,l,a,e,we);if(Oe!==!1)return(Oe===1||Oe===-1)&&(we=Oe===1),Ot=!0,setTimeout(ni,30),D(),we&&!Te?t.appendChild(y):l.parentNode.insertBefore(y,we?Te:l),J&&Tl(J,0,g-J.scrollTop),H=y.parentNode,k!==void 0&&!lt&&(ut=Math.abs(k-q(l)[L])),I(),E(!0)}if(t.contains(y))return E(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){A(document,"mousemove",this._onTouchMove),A(document,"touchmove",this._onTouchMove),A(document,"pointermove",this._onTouchMove),A(document,"dragover",ke),A(document,"mousemove",ke),A(document,"touchmove",ke)},_offUpEvents:function(){var e=this.el.ownerDocument;A(e,"mouseup",this._onDrop),A(e,"touchend",this._onDrop),A(e,"pointerup",this._onDrop),A(e,"touchcancel",this._onDrop),A(document,"selectstart",this)},_onDrop:function(e){var t=this.el,l=this.options;if(ae=ue(y),Ve=ue(y,l.draggable),le("drop",this,{evt:e}),H=y&&y.parentNode,ae=ue(y),Ve=ue(y,l.draggable),T.eventCanceled){this._nulling();return}Re=!1,lt=!1,Ze=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Nt(this.cloneId),Nt(this._dragStartId),this.nativeDraggable&&(A(document,"drop",this),A(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),We&&M(document.body,"user-select",""),M(y,"transform",""),e&&(Xe&&(e.cancelable&&e.preventDefault(),!l.dropBubble&&e.stopPropagation()),C&&C.parentNode&&C.parentNode.removeChild(C),(R===H||z&&z.lastPutMode!=="clone")&&B&&B.parentNode&&B.parentNode.removeChild(B),y&&(this.nativeDraggable&&A(y,"dragend",this),Mt(y),y.style["will-change"]="",Xe&&!Re&&ie(y,z?z.options.ghostClass:this.options.ghostClass,!1),ie(y,this.options.chosenClass,!1),te({sortable:this,name:"unchoose",toEl:H,newIndex:null,newDraggableIndex:null,originalEvent:e}),R!==H?(ae>=0&&(te({rootEl:H,name:"add",toEl:H,fromEl:R,originalEvent:e}),te({sortable:this,name:"remove",toEl:H,originalEvent:e}),te({rootEl:H,name:"sort",toEl:H,fromEl:R,originalEvent:e}),te({sortable:this,name:"sort",toEl:H,originalEvent:e})),z&&z.save()):ae!==Be&&ae>=0&&(te({sortable:this,name:"update",toEl:H,originalEvent:e}),te({sortable:this,name:"sort",toEl:H,originalEvent:e})),T.active&&((ae==null||ae===-1)&&(ae=Be,Ve=Ke),te({sortable:this,name:"end",toEl:H,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){le("nulling",this),R=y=H=C=Ie=B=rt=xe=Ne=de=Xe=ae=Ve=Be=Ke=Pe=Qe=z=tt=T.dragged=T.ghost=T.clone=T.active=null,bt.forEach(function(e){e.checked=!0}),bt.length=Vt=xt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":y&&(this._onDragOver(e),ai(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,l=this.el.children,o=0,a=l.length,n=this.options;o<a;o++)t=l[o],ce(t,n.draggable,this.el,!1)&&e.push(t.getAttribute(n.dataIdAttr)||ci(t));return e},sort:function(e,t){var l={},o=this.el;this.toArray().forEach(function(a,n){var i=o.children[n];ce(i,this.options.draggable,o,!1)&&(l[a]=i)},this),t&&this.captureAnimationState(),e.forEach(function(a){l[a]&&(o.removeChild(l[a]),o.appendChild(l[a]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return ce(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var l=this.options;if(t===void 0)return l[e];var o=et.modifyOption(this,e,t);typeof o<"u"?l[e]=o:l[e]=t,e==="group"&&Cl(l)},destroy:function(){le("destroy",this);var e=this.el;e[ne]=null,A(e,"mousedown",this._onTapStart),A(e,"touchstart",this._onTapStart),A(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(A(e,"dragover",this),A(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ft.splice(ft.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!xe){if(le("hideClone",this),T.eventCanceled)return;M(B,"display","none"),this.options.removeCloneOnHide&&B.parentNode&&B.parentNode.removeChild(B),xe=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(xe){if(le("showClone",this),T.eventCanceled)return;y.parentNode==R&&!this.options.group.revertClone?R.insertBefore(B,y):Ie?R.insertBefore(B,Ie):R.appendChild(B),this.options.group.revertClone&&this.animate(y,B),M(B,"display",""),xe=!1}}};function ai(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function it(e,t,l,o,a,n,i,u){var s,r=e[ne],d=r.options.onMove,c;return window.CustomEvent&&!ye&&!Je?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=t,s.from=e,s.dragged=l,s.draggedRect=o,s.related=a||t,s.relatedRect=n||q(t),s.willInsertAfter=u,s.originalEvent=i,e.dispatchEvent(s),d&&(c=d.call(r,s,i)),c}function Mt(e){e.draggable=!1}function ni(){Ot=!1}function ri(e,t,l){var o=q(je(l.el,0,l.options,!0)),a=Sl(l.el),n=10;return t?e.clientX<a.left-n||e.clientY<o.top&&e.clientX<o.right:e.clientY<a.top-n||e.clientY<o.bottom&&e.clientX<o.left}function ui(e,t,l){var o=q(Ft(l.el,l.options.draggable)),a=Sl(l.el),n=10;return t?e.clientX>a.right+n||e.clientY>o.bottom&&e.clientX>o.left:e.clientY>a.bottom+n||e.clientX>o.right&&e.clientY>o.top}function di(e,t,l,o,a,n,i,u){var s=o?e.clientY:e.clientX,r=o?l.height:l.width,d=o?l.top:l.left,c=o?l.bottom:l.right,b=!1;if(!i){if(u&&ut<r*a){if(!Ze&&(Qe===1?s>d+r*n/2:s<c-r*n/2)&&(Ze=!0),Ze)b=!0;else if(Qe===1?s<d+ut:s>c-ut)return-Qe}else if(s>d+r*(1-a)/2&&s<c-r*(1-a)/2)return si(t)}return b=b||i,b&&(s<d+r*n/2||s>c-r*n/2)?s>d+r/2?1:-1:0}function si(e){return ue(y)<ue(e)?1:-1}function ci(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,l=t.length,o=0;l--;)o+=t.charCodeAt(l);return o.toString(36)}function mi(e){bt.length=0;for(var t=e.getElementsByTagName("input"),l=t.length;l--;){var o=t[l];o.checked&&bt.push(o)}}function dt(e){return setTimeout(e,0)}function Nt(e){return clearTimeout(e)}ht&&U(document,"touchmove",function(e){(T.active||Re)&&e.cancelable&&e.preventDefault()});T.utils={on:U,off:A,css:M,find:Ml,is:function(e,t){return!!ce(e,t,e,!1)},extend:Wo,throttle:Dl,closest:ce,toggleClass:ie,clone:Ol,index:ue,nextTick:dt,cancelNextTick:Nt,detectDirection:kl,getChild:je};T.get=function(e){return e[ne]};T.mount=function(){for(var e=arguments.length,t=new Array(e),l=0;l<e;l++)t[l]=arguments[l];t[0].constructor===Array&&(t=t[0]),t.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(T.utils=fe(fe({},T.utils),o.utils)),et.mount(o)})};T.create=function(e,t){return new T(e,t)};T.version=Xo;var X=[],qe,kt,Ct=!1,St,Dt,gt,ze;function pi(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(t){var l=t.originalEvent;this.sortable.nativeDraggable?U(document,"dragover",this._handleAutoScroll):this.options.supportPointer?U(document,"pointermove",this._handleFallbackAutoScroll):l.touches?U(document,"touchmove",this._handleFallbackAutoScroll):U(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var l=t.originalEvent;!this.options.dragOverBubble&&!l.rootEl&&this._handleAutoScroll(l)},drop:function(){this.sortable.nativeDraggable?A(document,"dragover",this._handleAutoScroll):(A(document,"pointermove",this._handleFallbackAutoScroll),A(document,"touchmove",this._handleFallbackAutoScroll),A(document,"mousemove",this._handleFallbackAutoScroll)),al(),st(),Go()},nulling:function(){gt=kt=qe=Ct=ze=St=Dt=null,X.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,l){var o=this,a=(t.touches?t.touches[0]:t).clientX,n=(t.touches?t.touches[0]:t).clientY,i=document.elementFromPoint(a,n);if(gt=t,l||this.options.forceAutoScrollFallback||Je||ye||We){Tt(t,this.options,i,l);var u=Se(i,!0);Ct&&(!ze||a!==St||n!==Dt)&&(ze&&al(),ze=setInterval(function(){var s=Se(document.elementFromPoint(a,n),!0);s!==u&&(u=s,st()),Tt(t,o.options,s,l)},10),St=a,Dt=n)}else{if(!this.options.bubbleScroll||Se(i,!0)===pe()){st();return}Tt(t,this.options,Se(i,!1),!1)}}},_e(e,{pluginName:"scroll",initializeByDefault:!0})}function st(){X.forEach(function(e){clearInterval(e.pid)}),X=[]}function al(){clearInterval(ze)}var Tt=Dl(function(e,t,l,o){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,n=(e.touches?e.touches[0]:e).clientY,i=t.scrollSensitivity,u=t.scrollSpeed,s=pe(),r=!1,d;kt!==l&&(kt=l,st(),qe=t.scroll,d=t.scrollFn,qe===!0&&(qe=Se(l,!0)));var c=0,b=qe;do{var x=b,v=q(x),f=v.top,D=v.bottom,E=v.left,I=v.right,V=v.width,K=v.height,Q=void 0,k=void 0,$=x.scrollWidth,Z=x.scrollHeight,L=M(x),J=x.scrollLeft,g=x.scrollTop;x===s?(Q=V<$&&(L.overflowX==="auto"||L.overflowX==="scroll"||L.overflowX==="visible"),k=K<Z&&(L.overflowY==="auto"||L.overflowY==="scroll"||L.overflowY==="visible")):(Q=V<$&&(L.overflowX==="auto"||L.overflowX==="scroll"),k=K<Z&&(L.overflowY==="auto"||L.overflowY==="scroll"));var ee=Q&&(Math.abs(I-a)<=i&&J+V<$)-(Math.abs(E-a)<=i&&!!J),$e=k&&(Math.abs(D-n)<=i&&g+K<Z)-(Math.abs(f-n)<=i&&!!g);if(!X[c])for(var Te=0;Te<=c;Te++)X[Te]||(X[Te]={});(X[c].vx!=ee||X[c].vy!=$e||X[c].el!==x)&&(X[c].el=x,X[c].vx=ee,X[c].vy=$e,clearInterval(X[c].pid),(ee!=0||$e!=0)&&(r=!0,X[c].pid=setInterval(function(){o&&this.layer===0&&T.active._onTouchMove(gt);var we=X[this.layer].vy?X[this.layer].vy*u:0,Oe=X[this.layer].vx?X[this.layer].vx*u:0;typeof d=="function"&&d.call(T.dragged.parentNode[ne],Oe,we,e,gt,X[this.layer].el)!=="continue"||Tl(X[this.layer].el,Oe,we)}.bind({layer:c}),24))),c++}while(t.bubbleScroll&&b!==s&&(b=Se(b,!1)));Ct=r}},30),Ul=function(e){var t=e.originalEvent,l=e.putSortable,o=e.dragEl,a=e.activeSortable,n=e.dispatchSortableEvent,i=e.hideGhostForTarget,u=e.unhideGhostForTarget;if(t){var s=l||a;i();var r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(r.clientX,r.clientY);u(),s&&!s.el.contains(d)&&(n("spill"),this.onSpill({dragEl:o,putSortable:l}))}};function Pt(){}Pt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,l=e.putSortable;this.sortable.captureAnimationState(),l&&l.captureAnimationState();var o=je(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),l&&l.animateAll()},drop:Ul};_e(Pt,{pluginName:"revertOnSpill"});function Rt(){}Rt.prototype={onSpill:function(e){var t=e.dragEl,l=e.putSortable,o=l||this.sortable;o.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),o.animateAll()},drop:Ul};_e(Rt,{pluginName:"removeOnSpill"});T.mount(new pi);T.mount(Rt,Pt);function fi(e){return e==null?e:JSON.parse(JSON.stringify(e))}function bi(e){$t()&&zl(e)}function gi(e){$t()?Ut(e):ul(e)}const nl=Symbol("cloneElement");function hi(...e){var t,l;const o=(t=$t())==null?void 0:t.proxy,a=e[0];let[,n,i]=e;Array.isArray(m(n))||(i=n,n=null);let u=null;const{immediate:s=!0,clone:r=fi,customUpdate:d}=(l=m(i))!=null?l:{};function c(k){var $;k.item[nl]=r(m(($=m(n))==null?void 0:$[k.oldIndex]))}function b(k){const $=k.item[nl];Uo($)||(_t(k.item),Ao(m(n),k.newDraggableIndex,$))}function x(k){const{from:$,item:Z,oldIndex:L,oldDraggableIndex:J,pullMode:g,clone:ee}=k;if(g==="clone"){Kt($,Z,L),_t(ee);return}Io(m(n),J)}function v(k){if(d){d(k);return}const{from:$,item:Z,oldIndex:L,newIndex:J}=k;if(_t(Z),Kt($,Z,L),oe(n)){const g=[...m(n)];n.value=Gt(g,L,J);return}Gt(m(n),L,J)}const f={onUpdate:v,onStart:c,onAdd:b,onRemove:x};function D(k){const $=m(a);return k||(k=$o($)?Fo($,o?.$el):$),k&&!Yo(k)&&(k=k.$el),k||No("Root element not found"),k}function E(){var k;const $=(k=m(i))!=null?k:{},Z=yl($,["immediate","clone"]);return Ro(n===null?{}:f,Z)}const I=k=>{k=D(k),u&&V.destroy(),u=new T(k,E())};ql(()=>i,()=>{u&&Bo(E(),(k,$)=>{u?.option(k,$)})},{deep:!0});const V={option:(k,$)=>u?.option(k,$),destroy:()=>{u?.destroy(),u=null},save:()=>u?.save(),toArray:()=>u?.toArray(),closest:(...k)=>u?.closest(...k)},K=()=>V?.option("disabled",!0),Q=()=>V?.option("disabled",!1);return gi(()=>{s&&I()}),bi(V.destroy),Ye({start:I,pause:K,resume:Q},V)}const It=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],vi=["animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target","customUpdate",...It.map(e=>`on${e.replace(/^\S/,t=>t.toUpperCase())}`)],_i=W({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:vi,emits:["update:modelValue",...It],setup(e,{slots:t,emit:l,expose:o,attrs:a}){const n=It.reduce((d,c)=>{const b=`on${c.replace(/^\S/,x=>x.toUpperCase())}`;return d[b]=x=>l(c,x),d},{}),i=F(()=>{const d=Bl(e),c=yl(d,["modelValue"]),b=Object.entries(c).reduce((x,[v,f])=>{const D=m(f);return D!==void 0&&(x[v]=D),x},{});return Ye(Ye({},n),Co(Ye(Ye({},a),b)))}),u=F({get:()=>e.modelValue,set:d=>l("update:modelValue",d)}),s=De(),r=Hl(hi(e.target||s,u,i));return o(r),()=>{if(t.default)return jl(e.tag||"div",{ref:s},t.default(r))}}}),yi={style:{position:"absolute",top:"-32px",right:"10px","font-size":"0.8em"}},wi={key:0,style:{height:"32px",color:"#ccc","text-align":"center",border:"2px dashed antiquewhite"}},Ce=W({__name:"DataModelFieldDrop",props:ve(["prop","checkDrop","option"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=e,l=be(e,"modelValue");l.value[t.prop]||(l.value[t.prop]=[]);const o=F({get:()=>l.value[t.prop]||[],set:r=>{l.value[t.prop]=r}}),a=F(()=>h.t("bi.components.dataModelFieldDrop.tip",[o.value.length,t.option.minRow||0,t.option.maxRow||h.t("bi.components.dataModelFieldDrop.infinit")])),n=F(()=>o.value.length+"~"+(t.option.minRow||0)+"/"+(t.option.maxRow||"∞"));function i(r){r.preventDefault()}function u(r){var d,c,b;const x=r.dataTransfer.getData("fieldJSON");if(!x)return;const v=JSON.parse(x);if(((d=t.option)==null?void 0:d.maxRow)!=null&&o.value.length>=((c=t.option)==null?void 0:c.maxRow)){jt.error(h.t("bi.components.dataModelFieldDrop.validateError",[(b=t.option)==null?void 0:b.maxRow]));return}const f=v;if(f.id="F_"+Ll.createUniqueString(),(t.prop||"").startsWith("metric")&&(v.dataType=="number"||v.dataType=="integer"?f._aggregation="SUM":f._aggregation="COUNT"),t.checkDrop&&typeof t.checkDrop=="function"){const D=t.checkDrop(o.value,v,f);if(D){jt.error(D);return}}o.value.push(f)}function s(r){const d=o.value.findIndex(c=>c.key==r.key);d>=0&&o.value.splice(d,1)}return(r,d)=>{const c=S("el-tooltip");return _(),N("div",{onDragover:i,onDrop:u,style:{"min-height":"32px",width:"100%","font-size":"0.9em"}},[me("div",yi,[p(c,{"show-after":1e3,content:a.value,placement:"top"},{default:w(()=>[at(Ae(n.value),1)]),_:1},8,["content"])]),o.value.length==0?(_(),N("div",wi,Ae(r.$t("bi.components.dataModelFieldDrop.empty")),1)):(_(),O(m(_i),{key:1,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=b=>o.value=b),handle:".handle",onEnd:r.handleUpdateModelValue},{default:w(()=>[(_(!0),N(Y,null,j(o.value,b=>(_(),O(Do,{key:b.id,modelValue:b,modelConfig:t.modelValue,prop:r.$props.prop,option:r.$props.option,style:{margin:"4px"},onDelete:s},null,8,["modelValue","modelConfig","prop","option"]))),128))]),_:1},8,["modelValue","onEnd"]))],32)}}}),Vi={class:"theme-bar-container"},xi={class:"theme-bar-name"},Ei=W({__name:"ThemeBar",props:["theme"],setup(e){const t=e,l=F(()=>{var a,n;return{"background-color":(n=(a=t.theme)==null?void 0:a.value)==null?void 0:n.backgroundColor}}),o=F(()=>a=>{var n,i;return{"background-color":(i=(n=t.theme)==null?void 0:n.value)==null?void 0:i.color[a]}});return(a,n)=>{var i,u,s;return _(),N("div",Vi,[me("span",xi,Ae(e.theme.name),1),me("span",{class:"theme-bar-content",style:Ht(l.value)},[(_(!0),N(Y,null,j(((s=(u=(i=t.theme)==null?void 0:i.value)==null?void 0:u.color)==null?void 0:s.length)||0,r=>(_(),N("span",{class:"theme-bar-item",style:Ht(o.value(r))},null,4))),256))],4)])}}}),Mi=sl(Ei,[["__scopeId","data-v-c2f89577"]]),Si=W({__name:"index",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=be(e,"modelValue"),l=Ue("globalContext"),o=Pl("themeList",[]);return(!o.value||o.value.length==0)&&l.request({method:"GET",url:"echartsTheme/query"}).then(function(a){o.value=a.list}),(a,n)=>{const i=S("el-option"),u=S("el-select");return _(),O(u,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=s=>t.value=s),placeholder:"Please choose echarts theme"},{default:w(()=>[(_(!0),N(Y,null,j(m(o),s=>(_(),O(i,{key:s.name,value:s.name},{default:w(()=>[p(Mi,{theme:s},null,8,["theme"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])}}}),ji=["filter","rowLimit","interval","refresh","showSQL","showData"];function Di(e={},t=[]){return{name:h.t("bi.widgets.utils.indexUtil.title"),sequence:1,init:e,ui:Ti(t)}}function Ti(e){return function({config:t,context:l,key:o,fullConfig:a}){const n={"~":yo,"~modelValue":a,"#":[]};return i(),n;function i(){for(const r of e||[])if(typeof r=="string"){const d=u(r);if(Array.isArray(d))for(const c of d)n["#"].push(c);else n["#"].push(d)}else if(typeof r=="object"){const d=s(r);if(Array.isArray(d))for(const c of d)n["#"].push(c);else n["#"].push(d)}else typeof r=="function"?n["#"].push(r({config:t,context:l,key:o,fullConfig:a})):n["#"].push(r)}function u(r=""){if(r=="filter"){const d={"~":ge,"~modelValue":t,config:{"~component":Ce,"~modelValue":t,"~label":h.t("bi.widgets.utils.indexUtil.filter"),"~description":h.t("bi.widgets.utils.indexUtil.filter_description"),"~hideSwitchButton":!0,prop:r,...Yt(!0)}};return d.config.option.mode=!0,d}else{if(r.startsWith("dimension"))return{"~":ge,"~modelValue":t,config:{"~component":Ce,"~modelValue":t,"~label":h.t("bi.widgets.utils.indexUtil.dimension")+r.substring(r.length),"~description":h.t("bi.widgets.utils.indexUtil.dimension_description"),"~hideSwitchButton":!0,prop:r,option:{maxRow:1}}};if(r.startsWith("metric"))return{"~":ge,"~modelValue":t,config:{"~component":Ce,"~modelValue":t,"~label":h.t("bi.widgets.utils.indexUtil.metric")+r.substring(r.length),"~description":h.t("bi.widgets.utils.indexUtil.metric_description"),"~hideSwitchButton":!0,prop:r,option:{}}};if(r.startsWith("drilling"))return{"~":ge,"~modelValue":t,config:{"~component":Ce,"~modelValue":t,"~label":h.t("bi.widgets.utils.indexUtil.drilling")+r.substring(r.length),"~description":h.t("bi.widgets.utils.indexUtil.drilling_description"),"~hideSwitchButton":!0,prop:r,option:{maxRow:10}}};if(r.startsWith("rowLimit"))return{"~":ge,"~modelValue":t,config:{"~component":"el-input-number","~prop":r,"~label":h.t("bi.widgets.utils.indexUtil.rowLimit"),"~description":h.t("bi.widgets.utils.indexUtil.rowLimit_description"),"~hideSwitchButton":!0,min:0}};if(r=="pagination")return[{"~":"el-form-item",label:h.t("bi.widgets.utils.indexUtil.pagination"),prop:"pagination_mode","#":{"~":"el-select","~modelValue":F({get:()=>{var d;return((d=t.pagination)==null?void 0:d.mode)||"NONE"},set:d=>{t.pagination||(t.pagination={}),t.pagination.mode=d}}),"#":[{"~":"el-option",value:"NONE",label:h.t("bi.widgets.utils.indexUtil.pagination_none")},{"~":"el-option",value:"CLIENT",label:h.t("bi.widgets.utils.indexUtil.pagination_client")},{"~":"el-option",value:"SERVER",label:h.t("bi.widgets.utils.indexUtil.pagination_server")}]}},{"~":"el-form-item",label:h.t("bi.widgets.utils.indexUtil.pagination_size"),prop:"pagination_size",controls:!1,"#":{"~":"el-input-number","~modelValue":F({get:()=>{var d;return((d=t.pagination)==null?void 0:d.size)||10},set:d=>{t.pagination||(t.pagination={}),t.pagination.size=d}})}}];if(r.startsWith("interval"))return[{"~":"el-form-item",label:h.t("bi.widgets.utils.indexUtil.interval"),prop:"interval","#":[{"~":"div",style:{display:"flex","justify-content":"space-between"},"#":[{"~":"el-switch","active-value":"simple","inactive-value":"none",size:"small",min:1,"~modelValue":F({get:()=>{var d;return((d=t.interval)==null?void 0:d.mode)||"none"},set:d=>{t.interval||(t.interval={}),t.interval.mode=d}})},{"~":"el-input-number","~show":F(()=>{var d;return((d=t.interval)==null?void 0:d.mode)=="simple"}),controls:!1,style:{padding:" 0px 4px"},size:"small","~modelValue":F({get:()=>{var d;return((d=t.interval)==null?void 0:d.value)||10},set:d=>{t.interval||(t.interval={}),t.interval.value=d}})},{"~":"el-select","~show":F(()=>{var d;return((d=t.interval)==null?void 0:d.mode)=="simple"}),size:"small","~modelValue":F({get:()=>{var d;return((d=t.interval)==null?void 0:d.unit)||"SECOND"},set:d=>{t.interval||(t.interval={}),t.interval.unit=d}}),"#":[{"~":"el-option",value:"SECOND",label:h.t("bi.widgets.utils.indexUtil.interval_second")},{"~":"el-option",value:"MINUTE",label:h.t("bi.widgets.utils.indexUtil.interval_minute")}]}]}]}];if(r.startsWith("refresh"))return{"~":"el-button",type:"primary","#":h.t("bi.widgets.utils.indexUtil.refresh"),style:{width:"100%","margin-left":"0px","margin-top":"10px"},"@click":function(){l.mitt.emit("bi-chart-reload-"+o,{reset:!0,showError:!0})}};if(r.startsWith("showSQL"))return{"~":"el-button",type:"","#":h.t("bi.widgets.utils.indexUtil.showSQL"),style:{width:"100%","margin-left":"0px","margin-top":"4px"},"@click":function(){l.mitt.emit("bi-chart-action-"+o,{action:"showSQL"})}};if(r.startsWith("showData"))return{"~":"el-button",type:"","#":h.t("bi.widgets.utils.indexUtil.showData"),style:{width:"100%","margin-left":"0px","margin-top":"4px"},"@click":function(){l.mitt.emit("bi-chart-action-"+o,{action:"showData"})}};console.log("Unspoported config:"+r)}}function s(r={}){const d=r._type;if(!d)return r;if(d!="sort"&&d!="filter"){if(d=="dimension")return{"~":ge,"~modelValue":t,config:{"~component":Ce,"~label":r.label||h.t("bi.widgets.utils.indexUtil.dimension"),"~description":r.description||h.t("bi.widgets.utils.indexUtil.dimension_description"),"~hideSwitchButton":!0,prop:r.prop||"dimension",checkDrop:r.checkDrop||void 0,option:r.option||{maxRow:1}}};if(d=="metric")return{"~":ge,"~modelValue":t,config:{"~component":Ce,"~label":r.label||h.t("bi.widgets.utils.indexUtil.metric"),"~description":r.description||h.t("bi.widgets.utils.indexUtil.metric_description"),"~hideSwitchButton":!0,prop:r.prop||"metric",checkDrop:r.checkDrop||void 0,option:r.option||{}}};if(d=="drilling")return{"~":ge,"~modelValue":t,config:{"~component":Ce,"~label":r.label||h.t("bi.widgets.utils.indexUtil.drilling"),"~description":r.description||h.t("bi.widgets.utils.indexUtil.drilling_description"),"~hideSwitchButton":!0,prop:r.prop||"drilling",checkDrop:r.checkDrop||void 0,option:r.option||{maxRow:10}}};if(d=="normal")return{"~":ge,"~modelValue":t,config:{"~label":r.label||"","~prop":r.prop,...r.item||{"~":"el-input"}}}}}}}function Oi({initDisplay:e=!0,initStyle:t={}}={}){return{data:{type:"Object",hide:!0,skip:!0,init:function({key:l}){return{mode:"data",dataKey:"data_bi_charts_"+l}}},event:!1,display:{hide:!1,init:e?Gl({initStyle:t}):{}}}}function Li(){return[vt.createBase(Si,"echarts-theme",h.t("bi.widgets.utils.indexUtil.echarts-theme")),vt.createInput("title-text",h.t("bi.widgets.utils.indexUtil.title-text")),vt.createInput("title-subtext",h.t("bi.widgets.utils.indexUtil.title-subtext"))]}const Ni={key:2},ki={key:3},Ci={key:0},Ii={key:1},Ai={key:4},Ui={key:5},$i={key:6},Fi=W({__name:"DataModelFieldEditFilter",props:["modelValue","modelConfig","column","prop","option"],emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=t,a=F(()=>{var v;return!!((v=l.option)!=null&&v.mode)}),n=F(()=>" "+(a.value?h.t("bi.widgets.filter.edit.value"):h.t("bi.widgets.filter.edit.initValue"))),{modelValue:i}=At(l,o),u=Ue("globalContext"),s=Ue("appContext"),r=De([]),d=De([]);c();function c(){u.request({method:"GET",url:"/bi/dataModel/query",params:{app:s.getKey()}}).then(function(v){r.value=v.list,b()})}function b(){const v=m(i)._ui_select_source_datamodel;if(!v){d.value=[];return}const f=r.value.find(E=>E._id==v);if(!f){d.value=[];return}const D=[];x(D,f.columns),d.value=D}function x(v,f){for(const D of f||[])D.type=="hierarchy"?x(v,D.children):v.push(D)}return(v,f)=>{const D=S("el-input"),E=S("el-form-item"),I=S("el-option"),V=S("el-select"),K=S("el-input-number"),Q=S("el-switch"),k=S("el-option-group"),$=S("el-radio-button"),Z=S("el-radio-group"),L=S("el-alert"),J=S("el-form");return _(),O(J,{model:m(i),"label-width":"180px","label-position":"right"},{default:w(()=>[p(E,{label:v.$t("bi.widgets.filter.edit.title")},{default:w(()=>[p(D,{modelValue:m(i).label,"onUpdate:modelValue":f[0]||(f[0]=g=>m(i).label=g),required:""},null,8,["modelValue"])]),_:1},8,["label"]),p(E,{label:v.$t("bi.widgets.filter.edit.uiMode")},{default:w(()=>[p(V,{modelValue:m(i)._ui_mode,"onUpdate:modelValue":f[1]||(f[1]=g=>m(i)._ui_mode=g)},{default:w(()=>[e.column.dataType=="string"?(_(),O(I,{key:0,label:v.$t("bi.widgets.filter.edit.uiModeInput"),value:"input"},null,8,["label"])):P("",!0),e.column.dataType=="string"||e.column.dataType=="integer"||e.column.dataType=="number"?(_(),O(I,{key:1,label:v.$t("bi.widgets.filter.edit.uiModeSelect"),value:"select"},null,8,["label"])):P("",!0),e.column.dataType=="integer"||e.column.dataType=="number"?(_(),O(I,{key:2,label:v.$t("bi.widgets.filter.edit.uiModeInputNumber"),value:"input-number"},null,8,["label"])):P("",!0),e.column.dataType=="datetime"?(_(),O(I,{key:3,label:v.$t("bi.widgets.filter.edit.uiModeDatetime"),value:"datetime"},null,8,["label"])):P("",!0),e.column.dataType=="time"?(_(),O(I,{key:4,label:v.$t("bi.widgets.filter.edit.uiModeTime"),value:"time"},null,8,["label"])):P("",!0)]),_:1},8,["modelValue"])]),_:1},8,["label"]),a.value?P("",!0):(_(),O(E,{key:0,label:v.$t("bi.widgets.filter.edit.colSpan")},{default:w(()=>[p(K,{modelValue:m(i)._colSpan,"onUpdate:modelValue":f[2]||(f[2]=g=>m(i)._colSpan=g),min:1,max:12},null,8,["modelValue"])]),_:1},8,["label"])),!a.value&&m(i)._ui_mode!="select"?(_(),O(E,{key:1,label:v.$t("bi.widgets.filter.edit.uiHideMatch")},{default:w(()=>[p(Q,{modelValue:m(i)._ui_hide_match,"onUpdate:modelValue":f[3]||(f[3]=g=>m(i)._ui_hide_match=g)},null,8,["modelValue"])]),_:1},8,["label"])):P("",!0),m(i)._ui_mode=="input"?(_(),N("div",Ni,[p(E,{label:v.$t("bi.widgets.filter.edit.uiModeInput")+" "+v.$t("bi.widgets.filter.edit.matchMode")},{default:w(()=>[p(V,{modelValue:m(i)._ui_input_match_init,"onUpdate:modelValue":f[4]||(f[4]=g=>m(i)._ui_input_match_init=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(ml),g=>(_(),O(k,{key:g.key},{default:w(()=>[(_(!0),N(Y,null,j(g.options,ee=>(_(),O(I,{key:ee.value,label:ee.label,value:ee.value},null,8,["label","value"]))),128))]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),m(pl).includes(m(i)._ui_input_match_init)?(_(),O(E,{key:0,label:v.$t("bi.widgets.filter.edit.uiModeInput")+n.value},{default:w(()=>[p(D,{modelValue:m(i)._ui_input_init,"onUpdate:modelValue":f[5]||(f[5]=g=>m(i)._ui_input_init=g),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])):P("",!0)])):P("",!0),m(i)._ui_mode=="select"?(_(),N("div",ki,[p(E,{label:v.$t("bi.widgets.filter.edit.selectMultiple")},{default:w(()=>[p(Q,{modelValue:m(i)._ui_select_multiple,"onUpdate:modelValue":f[6]||(f[6]=g=>m(i)._ui_select_multiple=g)},null,8,["modelValue"])]),_:1},8,["label"]),p(E,{label:v.$t("bi.widgets.filter.edit.selectSource")},{default:w(()=>[p(Z,{modelValue:m(i)._ui_select_source,"onUpdate:modelValue":f[7]||(f[7]=g=>m(i)._ui_select_source=g)},{default:w(()=>[p($,{label:v.$t("bi.widgets.filter.edit.selectSourceAuto"),value:"auto"},null,8,["label"]),p($,{label:v.$t("bi.widgets.filter.edit.selectSourceDatamodel"),value:"datamodel"},null,8,["label"]),p($,{label:v.$t("bi.widgets.filter.edit.selectSourceManual"),value:"manual"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),m(i)._ui_select_source=="datamodel"?(_(),N("div",Ci,[p(E,{label:v.$t("bi.widgets.filter.edit.sourceDatamodel")},{default:w(()=>[p(V,{modelValue:m(i)._ui_select_source_datamodel,"onUpdate:modelValue":f[8]||(f[8]=g=>m(i)._ui_select_source_datamodel=g),clearable:"",filterable:"",onChange:b},{default:w(()=>[(_(!0),N(Y,null,j(r.value,g=>(_(),O(I,{key:g._id,label:g.name,value:g._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(E,{label:v.$t("bi.widgets.filter.edit.datamodelValue")},{default:w(()=>[p(V,{modelValue:m(i)._ui_select_source_datamodel_value,"onUpdate:modelValue":f[9]||(f[9]=g=>m(i)._ui_select_source_datamodel_value=g),clearable:"",filterable:""},{default:w(()=>[(_(!0),N(Y,null,j(d.value,g=>(_(),O(I,{key:g.key,label:g.label,value:g.entity+"."+g.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(E,{label:v.$t("bi.widgets.filter.edit.datamodelLabel")},{default:w(()=>[p(V,{modelValue:m(i)._ui_select_source_datamodel_label,"onUpdate:modelValue":f[10]||(f[10]=g=>m(i)._ui_select_source_datamodel_label=g),clearable:"",filterable:""},{default:w(()=>[(_(!0),N(Y,null,j(d.value,g=>(_(),O(I,{key:g.key,label:g.label,value:g.entity+"."+g.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])])):P("",!0),m(i)._ui_select_source=="manual"?(_(),N("div",Ii,[p(E,{label:v.$t("bi.widgets.filter.edit.manual")},{default:w(()=>[p(D,{modelValue:m(i)._ui_select_source_manual,"onUpdate:modelValue":f[11]||(f[11]=g=>m(i)._ui_select_source_manual=g),type:"textarea",rows:5},null,8,["modelValue"]),p(L,{type:"info",closable:!1,title:v.$t("bi.widgets.filter.edit.manual_description")},null,8,["title"])]),_:1},8,["label"])])):P("",!0),p(E,{label:v.$t("bi.widgets.filter.edit.uiModeSelect")+n.value},{default:w(()=>[p(hl,{modelValue:m(i),"onUpdate:modelValue":f[12]||(f[12]=g=>oe(i)?i.value=g:null),config:l.modelConfig,c:{...m(i),id:"_ui_select_init"}},null,8,["modelValue","config","c"])]),_:1},8,["label"])])):P("",!0),m(i)._ui_mode=="input-number"?(_(),N("div",Ai,[m(i)._ui_mode=="input-number"?(_(),O(E,{key:0,label:v.$t("bi.widgets.filter.edit.uiModeInputNumber")+"  "+v.$t("bi.widgets.filter.edit.matchMode")},{default:w(()=>[p(V,{modelValue:m(i)["_ui_input-number_match_init"],"onUpdate:modelValue":f[13]||(f[13]=g=>m(i)["_ui_input-number_match_init"]=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(fl),g=>(_(),O(I,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):P("",!0),p(E,{label:v.$t("bi.widgets.filter.edit.uiModeInputNumber")+n.value},{default:w(()=>[p(K,{controls:!1,modelValue:m(i)["_ui_input-number_init"],"onUpdate:modelValue":f[14]||(f[14]=g=>m(i)["_ui_input-number_init"]=g),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),m(i)["_ui_input-number_match_init"]=="_RANGE"?(_(),O(E,{key:1,label:v.$t("bi.widgets.filter.edit.uiMuiModeInputNumberodeInput")+n.value+" "+v.$t("bi.widgets.filter.edit.to")},{default:w(()=>[p(K,{controls:!1,modelValue:m(i)["_ui_input-number_init_to"],"onUpdate:modelValue":f[15]||(f[15]=g=>m(i)["_ui_input-number_init_to"]=g),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])):P("",!0)])):P("",!0),m(i)._ui_mode=="datetime"?(_(),N("div",Ui,[p(E,{label:v.$t("bi.widgets.filter.edit.uiModeDatetime")+" "+v.$t("bi.widgets.filter.edit.matchMode")},{default:w(()=>[p(V,{modelValue:m(i)._ui_datetime_match_init,"onUpdate:modelValue":f[16]||(f[16]=g=>m(i)._ui_datetime_match_init=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(bl),g=>(_(),O(I,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(E,{label:v.$t("bi.widgets.filter.edit.uiModeDatetime")+n.value},{default:w(()=>[p(V,{modelValue:m(i)._ui_datetime_init,"onUpdate:modelValue":f[17]||(f[17]=g=>m(i)._ui_datetime_init=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(qt),g=>(_(),O(I,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),m(i)._ui_datetime_match_init=="_RANGE"?(_(),O(E,{key:0,label:v.$t("bi.widgets.filter.edit.uiModeDatetime")+n.value+" "+v.$t("bi.widgets.filter.edit.to")},{default:w(()=>[p(V,{modelValue:m(i)._ui_datetime_init_to,"onUpdate:modelValue":f[18]||(f[18]=g=>m(i)._ui_datetime_init_to=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(qt),g=>(_(),O(I,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):P("",!0)])):P("",!0),m(i)._ui_mode=="time"?(_(),N("div",$i,[p(E,{label:v.$t("bi.widgets.filter.edit.uiModeTime")+" "+v.$t("bi.widgets.filter.edit.matchMode")},{default:w(()=>[p(V,{modelValue:m(i)._ui_time_match_init,"onUpdate:modelValue":f[19]||(f[19]=g=>m(i)._ui_time_match_init=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(gl),g=>(_(),O(I,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(E,{label:v.$t("bi.widgets.filter.edit.uiModeTime")+n.value},{default:w(()=>[p(V,{modelValue:m(i)._ui_time_init,"onUpdate:modelValue":f[20]||(f[20]=g=>m(i)._ui_time_init=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(zt),g=>(_(),O(I,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),m(i)._ui_time_match_init=="_RANGE"?(_(),O(E,{key:0,label:v.$t("bi.widgets.filter.edit.uiModeTime")+n.value+" "+v.$t("bi.widgets.filter.edit.to")},{default:w(()=>[p(V,{modelValue:m(i)._ui_time_init_to,"onUpdate:modelValue":f[21]||(f[21]=g=>m(i)._ui_time_init_to=g),clearable:""},{default:w(()=>[(_(!0),N(Y,null,j(m(zt),g=>(_(),O(I,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):P("",!0)])):P("",!0)]),_:1},8,["model"])}}}),Yt=function(e=!1){return{option:{editComponent:Fi,mode:e},checkDrop:function(t,l,o){l.dataType=="string"?(o._ui_mode="input",o._ui_input_match_init="LIKE"):l.dataType=="integer"||l.dataType=="number"?(o._ui_mode="input-number",o["_ui_input-number_match_init"]=">="):l.dataType=="datetime"?(o._ui_mode="datetime",o._ui_datetime_match_init="_RANGE"):l.dataType=="time"&&(o._ui_mode="time",o._ui_time_match_init="_RANGE")}}},Pi={key:"_bi_filter",name:h.t("bi.widgets.filter.name"),description:"",icon:"mdiFilterPlusOutline",sequence:1,transform:go,editor:{model:Di({type:"filter",showButtonReset:!0,qtyPerRow:4,labelWidth:"120px",lablePosition:"left"},[{_type:"dimension",prop:"filter",label:h.t("bi.widgets.filter.filter_label"),description:h.t("bi.widgets.filter.filter_description"),...Yt(!1)},{_type:"normal",label:h.t("bi.widgets.filter.showButtonReset"),prop:"showButtonReset",item:{"~":"el-switch"}},{_type:"normal",label:h.t("bi.widgets.filter.qtyPerRow"),prop:"qtyPerRow",item:{"~":"el-select","#":[{"~":"el-option",label:"1",value:1},{"~":"el-option",label:"2",value:2},{"~":"el-option",label:"3",value:3},{"~":"el-option",label:"4",value:4},{"~":"el-option",label:"6",value:6},{"~":"el-option",label:"8",value:8},{"~":"el-option",label:"12",value:12},{"~":"el-option",label:"24",value:24}]}},{_type:"normal",label:h.t("bi.widgets.filter.labelWidth"),prop:"labelWidth"},{_type:"normal",label:h.t("bi.widgets.filter.labelPosition"),prop:"labelPosition",item:{"~":"el-select","#":[{"~":"el-option",label:h.t("bi.widgets.filter.labelPosition_left"),value:"left"},{"~":"el-option",label:h.t("bi.widgets.filter.labelPosition_right"),value:"right"},{"~":"el-option",label:h.t("bi.widgets.filter.labelPosition_top"),value:"top"}]}}]),...Oi({initDisplay:!1})}},Xi=Object.freeze(Object.defineProperty({__proto__:null,default:Pi,filterIndexOptions:Yt},Symbol.toStringTag,{value:"Module"}));export{Oi as a,Di as b,ji as c,Li as d,Xi as e,pl as i};
