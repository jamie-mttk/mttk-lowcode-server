import{d as D,r as M,D as P,z as w,a as s,b as i,c as T,f as e,g as o,p as f,j as y,F as I,v as b,i as R,q as $,h,s as j,T as B,W as c,S as F}from"./index-5e7b76fe.js";const G={class:"dialog-footer"},L=D({__name:"ApiEditorDialog",setup(S,{expose:E}){const k=P("context");function V(u,l){t.value=u,g=l,m.value=!0}const m=M(!1),t=M({});let g;const C=M(),x=async u=>{u&&await u.validate(l=>{l&&(m.value=!1,g&&g(t.value))})},v=w(()=>k.codeManager.getCode().data),n=w(()=>k.codeManager.getCode().computed);return E({show:V}),(u,l)=>{const _=s("el-input"),r=s("el-form-item"),d=s("el-option"),p=s("el-select"),q=s("el-form"),U=s("el-button"),N=s("el-dialog");return i(),b(N,{modelValue:m.value,"onUpdate:modelValue":l[13]||(l[13]=a=>m.value=a),title:u.$t("_.builtIn.plugin.apiEditor.dialogTitle"),"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:o(()=>[R("span",G,[e(U,{onClick:l[11]||(l[11]=a=>m.value=!1)},{default:o(()=>[f(y(u.$t("_._.cancel")),1)]),_:1}),e(U,{type:"primary",onClick:l[12]||(l[12]=a=>x(C.value))},{default:o(()=>[f(y(u.$t("_._.save")),1)]),_:1})])]),default:o(()=>[e(q,{ref_key:"dataEditorFormRef",ref:C,model:t.value,"label-width":"240px"},{default:o(()=>[e(r,{label:u.$t("_._.key"),prop:"key",required:""},{default:o(()=>[e(_,{modelValue:t.value.key,"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.key=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(r,{label:u.$t("_._.description"),prop:"description"},{default:o(()=>[e(_,{modelValue:t.value.description,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.description=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(r,{label:u.$t("_.builtIn.plugin.apiEditor.data.method"),prop:"method",required:""},{default:o(()=>[e(p,{modelValue:t.value.method,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.method=a)},{default:o(()=>[e(d,{label:"GET",value:"GET"}),e(d,{label:"PUT",value:"PUT"}),e(d,{label:"POST",value:"POST"}),e(d,{label:"DELETE",value:"DELETE"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(r,{label:u.$t("_.builtIn.plugin.apiEditor.data.url"),prop:"url",required:""},{default:o(()=>[e(_,{modelValue:t.value.url,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.url=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(r,{label:u.$t("_.builtIn.plugin.apiEditor.data.requestType"),prop:"requestType",required:""},{default:o(()=>[e(p,{modelValue:t.value.requestType,"onUpdate:modelValue":l[4]||(l[4]=a=>t.value.requestType=a)},{default:o(()=>[e(d,{label:u.$t("_.builtIn.plugin.apiEditor.data.requestType_none"),value:"none"},null,8,["label"]),e(d,{label:u.$t("_.builtIn.plugin.apiEditor.data.requestType_para"),value:"para"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),t.value.requestType!="none"?(i(),b(r,{key:0,label:u.$t("_.builtIn.plugin.apiEditor.data.requestMode"),prop:"requestMode",required:""},{default:o(()=>[e(p,{modelValue:t.value.requestMode,"onUpdate:modelValue":l[5]||(l[5]=a=>t.value.requestMode=a)},{default:o(()=>[e(d,{label:u.$t("_.builtIn.plugin.apiEditor.data.requestMode_data"),value:"data"},null,8,["label"]),e(d,{label:u.$t("_.builtIn.plugin.apiEditor.data.requestMode_computed"),value:"computed"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])):$("",!0),t.value.requestMode=="data"?(i(),b(r,{key:1,label:u.$t("_.builtIn.plugin.apiEditor.data.requestMode_data"),prop:"requestContentValueData",required:""},{default:o(()=>[e(p,{modelValue:t.value.requestContentValueData,"onUpdate:modelValue":l[6]||(l[6]=a=>t.value.requestContentValueData=a)},{default:o(()=>[(i(!0),T(I,null,h(v.value,a=>(i(),b(d,{key:a.key,label:a.description,value:a.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):$("",!0),t.value.requestMode=="computed"?(i(),b(r,{key:2,label:u.$t("_.builtIn.plugin.apiEditor.data.requestMode_computed"),prop:"requestContentValueComputed",required:""},{default:o(()=>[e(p,{modelValue:t.value.requestContentValueComputed,"onUpdate:modelValue":l[7]||(l[7]=a=>t.value.requestContentValueComputed=a)},{default:o(()=>[(i(!0),T(I,null,h(n.value,a=>(i(),b(d,{key:a.key,label:a.description,value:a.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):$("",!0),e(r,{label:u.$t("_.builtIn.plugin.apiEditor.data.responseMode"),prop:"responseMode",required:""},{default:o(()=>[e(p,{modelValue:t.value.responseMode,"onUpdate:modelValue":l[8]||(l[8]=a=>t.value.responseMode=a)},{default:o(()=>[e(d,{label:u.$t("_.builtIn.plugin.apiEditor.data.responseMode_none"),value:"none"},null,8,["label"]),e(d,{label:u.$t("_.builtIn.plugin.apiEditor.data.responseMode_data"),value:"data"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),t.value.responseMode!="none"?(i(),b(r,{key:3,label:u.$t("_.builtIn.plugin.apiEditor.data.responseValue"),prop:"responseValue",required:""},{default:o(()=>[e(p,{modelValue:t.value.responseValue,"onUpdate:modelValue":l[9]||(l[9]=a=>t.value.responseValue=a)},{default:o(()=>[(i(!0),T(I,null,h(v.value,a=>(i(),b(d,{key:a.key,label:a.description,value:a.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):$("",!0),t.value.responseMode!="none"?(i(),b(r,{key:4,label:u.$t("_.builtIn.plugin.apiEditor.data.responseExpression"),prop:"responseExpression"},{default:o(()=>[e(_,{modelValue:t.value.responseExpression,"onUpdate:modelValue":l[10]||(l[10]=a=>t.value.responseExpression=a)},null,8,["modelValue"])]),_:1},8,["label"])):$("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),A=D({__name:"index",setup(S){const E=M(),k=P("context");let V=-1;function m(){V=-1,E.value.show({method:"GET",requestType:"none",responseMode:"none"},g)}function t(n){V=n.$index;const u=j(n.row);E.value.show(u,g)}const g=n=>{V<0?v.value.push(n):v.value[V]=n},C=n=>{B.confirm(c("_.builtIn.plugin.apiEditor.deletePrompt"),c("_._.warning"),{confirmButtonText:c("_._.yes"),cancelButtonText:c("_._.no"),type:"warning"}).then(()=>{v.value.splice(n.$index,1)})},x=n=>{B.confirm(c("_.builtIn.plugin.apiEditor.callPrompt"),c("_._.warning"),{confirmButtonText:c("_._.yes"),cancelButtonText:c("_._.no"),type:"warning"}).then(()=>{k.apiManager.invoke(n.row.key),F({message:"API is called.",type:"success"})})},v=w(()=>k.codeManager.getCode().apis);return(n,u)=>{const l=s("el-table-column"),_=s("el-button"),r=s("el-button-group"),d=s("el-table");return i(),T(I,null,[e(d,{data:v.value,border:""},{empty:o(()=>[e(_,{type:"primary",onClick:u[1]||(u[1]=p=>m())},{default:o(()=>[f(y(n.$t("_._.add")),1)]),_:1})]),default:o(()=>[e(l,{prop:"key",label:n.$t("_._.key")},null,8,["label"]),e(l,{prop:"description",label:n.$t("_._.description")},null,8,["label"]),e(l,{prop:"method",label:n.$t("_.builtIn.plugin.apiEditor.data.method")},null,8,["label"]),e(l,{prop:"url",label:n.$t("_.builtIn.plugin.apiEditor.data.url")},null,8,["label"]),e(l,{fixed:"right",label:n.$t("_._.operation"),width:"280px"},{default:o(p=>[e(r,null,{default:o(()=>[e(_,{type:"primary",onClick:u[0]||(u[0]=q=>m())},{default:o(()=>[f(y(n.$t("_._.add")),1)]),_:1}),e(_,{type:"success",onClick:q=>t(p)},{default:o(()=>[f(y(n.$t("_._.edit")),1)]),_:2},1032,["onClick"]),e(_,{type:"danger",onClick:q=>C(p)},{default:o(()=>[f(y(n.$t("_._.del")),1)]),_:2},1032,["onClick"]),e(_,{type:"warning",onClick:q=>x(p)},{default:o(()=>[f(y(n.$t("_.builtIn.plugin.apiEditor.call")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),e(L,{ref_key:"apiEditorDialogRef",ref:E},null,512)],64)}}});export{A as default};
