import{d as T,D as q,r as w,a as d,A as B,b as _,c as S,i as k,j as m,f as e,g as o,p as f,B as $,v as V,k as D,ab as P,ac as G,F as K,ad as U}from"./index-168435c7.js";import{p as L}from"./index-a4ee6eee-be38a324.js";import"./index-3458eb1c-88d55814.js";const O={class:"dialog-footer"},W=T({__name:"ConnectionEditorDialog",setup(F,{expose:v}){function h(r,l){t.value=r,i=l,u.value=!0}const u=w(!1),t=w({});let i;const y=w(),x=async r=>{r&&await r.validate(l=>{l&&(u.value=!1,i&&i(t.value))})};return v({show:h}),(r,l)=>{const a=d("el-input"),c=d("el-form-item"),C=d("el-switch"),b=d("el-form"),g=d("el-button"),s=d("el-dialog");return _(),V(s,{modelValue:u.value,"onUpdate:modelValue":l[9]||(l[9]=n=>u.value=n),title:r.$t("_._.edit")+" "+r.$t("bi.plugin.connectionEditor.name"),"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:o(()=>[k("span",O,[e(g,{onClick:l[7]||(l[7]=n=>u.value=!1)},{default:o(()=>[f(m(r.$t("_._.cancel")),1)]),_:1}),e(g,{type:"primary",onClick:l[8]||(l[8]=n=>x(y.value))},{default:o(()=>[f(m(r.$t("_._.save")),1)]),_:1})])]),default:o(()=>[e(b,{ref_key:"connectionEditorFormRef",ref:y,model:t.value,"label-width":"120px"},{default:o(()=>[e(c,{label:r.$t("_._.name"),prop:"name",required:""},{default:o(()=>[e(a,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=n=>t.value.name=n)},null,8,["modelValue"])]),_:1},8,["label"]),e(c,{label:r.$t("_._.description"),prop:"description"},{default:o(()=>[e(a,{modelValue:t.value.description,"onUpdate:modelValue":l[1]||(l[1]=n=>t.value.description=n)},null,8,["modelValue"])]),_:1},8,["label"]),e(c,{label:r.$t("bi.plugin.connectionEditor.data.driverClass"),prop:"driverClass",required:""},{default:o(()=>[e(a,{modelValue:t.value.driverClass,"onUpdate:modelValue":l[2]||(l[2]=n=>t.value.driverClass=n)},null,8,["modelValue"])]),_:1},8,["label"]),e(c,{label:"URL",prop:"url",required:""},{default:o(()=>[e(a,{modelValue:t.value.url,"onUpdate:modelValue":l[3]||(l[3]=n=>t.value.url=n)},null,8,["modelValue"])]),_:1}),e(c,{label:r.$t("bi.plugin.connectionEditor.data.user"),prop:"user"},{default:o(()=>[e(a,{modelValue:t.value.user,"onUpdate:modelValue":l[4]||(l[4]=n=>t.value.user=n)},null,8,["modelValue"])]),_:1},8,["label"]),e(c,{label:r.$t("bi.plugin.connectionEditor.data.password"),prop:"password"},{default:o(()=>[e(a,{modelValue:t.value.password,"onUpdate:modelValue":l[5]||(l[5]=n=>t.value.password=n),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),e(c,{label:r.$t("bi.plugin.connectionEditor.data.readonly"),prop:"readonly"},{default:o(()=>[e(C,{modelValue:t.value.readonly,"onUpdate:modelValue":l[6]||(l[6]=n=>t.value.readonly=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),A={class:"toolbar-table-container",style:{margin:"0 24px 0 8px"}},H={class:"lc-common-toolbar toolbar",style:{"background-color":"var(--el-color-primary)"}},M={class:"left",style:{"font-weight":"bold",color:"var(--el-color-white)"}},J=T({__name:"index",setup(F){const v=q("globalContext"),h=q("appContext"),u=w(null),t=w([]);function i(){v.request({method:"GET",url:"/bi/jdbcConnection/query",params:{app:h.getKey()}}).then(function(a){t.value=a.list})}i();function y(){u.value.show({readonly:!0,app:h.getKey()},r)}function x(a){a.$index,u.value.show(a.row,r)}const r=a=>{v.request({method:"POST",url:"/bi/jdbcConnection/save",data:a}).then(function(){i()})},l=a=>{L.confirm(U.t("bi.plugin.connectionEditor.deleteConfirm"),"Warning",{confirmButtonText:U.t("_._.yes"),cancelButtonText:U.t("_._.no"),type:"warning"}).then(()=>{v.request({method:"POST",url:"/bi/jdbcConnection/delete",params:{id:a.row._id}}).then(function(){i()})})};return(a,c)=>{const C=d("lc-icon"),b=d("el-button"),g=d("el-button-group"),s=d("el-table-column"),n=d("el-switch"),N=d("el-table"),R=B("auth"),j=B("data-auth");return _(),S(K,null,[k("div",A,[k("div",H,[k("div",M,m(a.$t("bi.plugin.connectionEditor.name")),1),e(g,{class:"right"},{default:o(()=>[e(b,{onClick:i},{icon:o(()=>[e(C,{icon:"mdiRefresh"})]),default:o(()=>[f(" "+m(a.$t("_._.refresh")),1)]),_:1}),$((_(),V(b,{onClick:y},{icon:o(()=>[e(C,{icon:"mdiPlus"})]),default:o(()=>[f(m(a.$t("_._.add")),1)]),_:1})),[[R,void 0,"jdbcConnection_add"]])]),_:1})]),$((_(),V(N,{data:t.value,class:"table-area"},{default:o(()=>[e(s,{prop:"name",label:a.$t("_._.name")},null,8,["label"]),e(s,{prop:"description",label:a.$t("_._.description")},null,8,["label"]),e(s,{prop:"driverClass",label:a.$t("bi.plugin.connectionEditor.data.driverClass")},null,8,["label"]),e(s,{prop:"url",label:"URL"}),e(s,{prop:"readonly",label:a.$t("bi.plugin.connectionEditor.data.readonly"),width:"120px"},{default:o(p=>[e(n,{modelValue:p.row.readonly,"onUpdate:modelValue":E=>p.row.readonly=E,"before-change":function(){return!1}},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1},8,["label"]),e(s,{fixed:"right",label:a.$t("_._.operation"),width:"260px"},{default:o(p=>[e(g,null,{default:o(()=>[$((_(),V(b,{onClick:E=>x(p)},{default:o(()=>[f(m(a.$t("_._.edit")),1)]),_:2},1032,["onClick"])),[[j,p.row,"edit"]]),$((_(),V(b,{onClick:E=>l(p)},{default:o(()=>[f(m(a.$t("_._.del")),1)]),_:2},1032,["onClick"])),[[j,p.row,"del"]]),e(D(G),{data:p.row,resource:"jdbcConnection",uri:"/bi/jdbcConnection"},null,8,["data"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[D(P),8]])]),e(W,{ref_key:"connectionEditorDialogRef",ref:u},null,512)],64)}}});export{J as default};
