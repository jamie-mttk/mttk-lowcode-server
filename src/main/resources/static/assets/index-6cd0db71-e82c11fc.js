import{g as S}from"./chartActionUtil-201ccd97-6331c097.js";import{t as C,Y as R}from"./transformUtil-999da02b-e777606b.js";import{h as T}from"./tooltipUtil-4635a4f7-2c64bc23.js";import{b as V,c as q,a as L}from"./index-1ede4d6c-b9d7dc37.js";import{ad as l,aT as m,r as O,z as x,k as c}from"./index-5e7b76fe.js";import"./biTool-e603ec91-3f60f9c4.js";import"./index-3458eb1c-625f9c79.js";import"./_plugin-vue_export-helper-dad06003-f875bd67.js";const y=[{key:"_dimensionAndMetric",min:1}];function W({config:n,data:t,context:d,key:s,contextWrap:u,fullConfig:b}){const f=R({config:n,data:t,context:d,key:s,contextWrap:u,fullConfig:b},y,void 0);if(f)return f;const g=O(1),p=b.config.model,h=z(),v=I(),w=N();if(!v&&!w)return h;return{"~":"div",style:{display:"flex","flex-direction":"column",height:"100%"},"#":[v,h,w]};function z(){var e;const i={"~component":"el-table",style:{height:"100%"},border:n.border!=null?!!n.border:!0,stripe:n.stripe!=null?!!n.stripe:!1};((e=p.pagination)==null?void 0:e.mode)=="CLIENT"?i.data=x(()=>{var o;let r=((o=p.pagination)==null?void 0:o.size)||10;return r<=0&&(r=10),(c(t).data||[]).slice((g.value-1)*r,g.value*r)}):i.data=c(t).data;const a=[];i["#"]=a,n._showIndex&&a.push({"~":"el-table-column",type:"index",label:"#",width:"50"});for(const o of p.dimension||[])_(a,o,"dimension");for(const o of p.metric||[])_(a,o,"metric");return i}function N(){var e;const i=((e=p.pagination)==null?void 0:e.mode)||"NONE";return i=="CLIENT"?k():i=="SERVER"?E():void 0}function k(){var e;return{"~":"el-pagination","~modelValue":g,"~modelValueName":"current-page","hide-on-single-page":!1,layout:"total,  prev, pager, next, jumper","page-size":((e=p.pagination)==null?void 0:e.size)||10,total:(c(t).data||[]).length}}function E(){var e,i,a,o;return{"~":"el-pagination","~modelValue":x({get:()=>d.d.getWithDefault("data_bi_charts_pagination_"+s,1),set:r=>{console.log("set page to ",r),d.d.s("data_bi_charts_pagination_"+s,r)}}),"~modelValueName":"current-page","hide-on-single-page":!1,layout:"total,  prev, pager, next, jumper","page-size":((i=(e=c(t))==null?void 0:e.pagination)==null?void 0:i.size)||10,total:((o=(a=c(t))==null?void 0:a.pagination)==null?void 0:o.total)||0,"@change":function(){d.mitt.emit("bi-chart-reload-"+s,{reset:!1,showError:!0})}}}function I(){const e=n._title;if(e)return{"~":"div",style:{"text-align":"center","font-size":"1.2em","font-weight":700,"margin-top":"8px","margin-bottom":"4px"},"#":e}}}function _(n,t,d="metric"){n.push({"~":S,prop:t.id,label:t.label||t.key,align:d=="metric"?"right":"left","#":function({row:s,$index:u}){if(!(u<0))return T(s[t.id],t)}})}const j=C(W,y,void 0),F={key:"_bi_table",name:l.t("bi.widgets.table.name"),description:"",icon:"mdiTableLarge",sequence:2,transform:j,editor:{model:V({type:"table",dumpMode:"JSON"},[{_type:"dimension",dimension:"metric",label:l.t("bi.widgets.table.dimension"),option:{minRow:0}},{_type:"metric",prop:"metric",label:l.t("bi.widgets.table.metric"),option:{minRow:0}},"pagination",...q]),basic:{init:{border:!0,stripe:!1},ui:[m.createInput("_title",l.t("bi.widgets.table.title")),m.createSwitch("border",l.t("bi.widgets.table.border")),m.createSwitch("stripe",l.t("bi.widgets.table.stripe")),m.createSwitch("_showIndex",l.t("bi.widgets.table.showIndex"))]},...L(!1)}};export{F as default};
