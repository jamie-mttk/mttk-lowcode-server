import{l as f,p as g,u as m}from"./transformUtil-999da02b-e777606b.js";import{h as b}from"./tooltipUtil-4635a4f7-2c64bc23.js";import{ad as l,aT as d,k as w,aD as v}from"./index-5e7b76fe.js";import{b as y,c as k,d as _,a as x}from"./index-1ede4d6c-b9d7dc37.js";import"./biTool-e603ec91-3f60f9c4.js";import"./index-3458eb1c-625f9c79.js";import"./chartActionUtil-201ccd97-6331c097.js";import"./_plugin-vue_export-helper-dad06003-f875bd67.js";const R=[{key:"dimension",min:1},{key:"_dimensionAndMetric",min:2}];function C({config:e,data:o,context:t,key:n,contextWrap:a,fullConfig:i}){var p;const r=i.config.model,c=w(o).data||[],u=q(c),s={...g({config:e,skipLegend:!0}),tooltip:{valueFormatter(h){return b(h,m(r))}},series:[{type:"treemap",name:(p=m(r))==null?void 0:p.label,leafDepth:e["leaf-depth"]||void 0,top:"20%",data:u}]};return e["upper-label"]&&(s.series[0].upperLabel={show:!0,height:30},s.series[0].levels=D(r)),s}const L=f(C,R,void 0,{skipDataset:!0});function q(e){let o=[];for(let t=1;t<e.length;t++){let n=o;for(let i=0;i<e[t].length-2;i++){let p=n.find(r=>r.name===e[t][i]);if(p)n=p.children;else{let r={name:e[t][i],children:[]};n.push(r),n=r.children}}let a={name:e[t][e[t].length-2],value:e[t][e[t].length-1]};n.push(a)}return o}function D(e){var o,t;const n=((o=e.dimension)==null?void 0:o.length)||0+((t=e.metric)==null?void 0:t.length)||0,a=[];for(let i=0;i<n;i++)a.push({itemStyle:{borderColor:v.generateRandomColor(),borderWidth:i==0?0:5,gapWidth:i==0?1:5},upperLabel:{show:i!=0}});return a}const K={key:"_bi_treemap",name:l.t("bi.widgets.treemap.name"),description:"",icon:"mdiChartTree",sequence:31,transform:L,editor:{model:y({type:"treemap"},[{_type:"dimension",description:l.t("bi.widgets.treemap.dimension_description"),option:{maxRow:10,minRow:1}},{_type:"metric",description:l.t("bi.widgets.treemap.metric_description"),option:{maxRow:1,minRow:0}},...k]),basic:{init:{"leaf-depth":1,"upper-label":!1},ui:[..._(),d.createInputNumber("leaf-depth",l.t("bi.widgets.treemap.leaf-depth"),{min:0}),d.createSwitch("upper-label",l.t("bi.widgets.treemap.upper-label"))]},...x()}};export{K as default};
