import{n as W,t as L,i as B,a as M}from"./index-23db70af.js";import{J as P,g as m,K as C,L as F,c as R,j as O}from"./index-83dc2c00.js";function D(e,n,s){let o;P(s)?o={evaluating:s}:o=s||{};const{lazy:a=!1,evaluating:u=void 0,shallow:c=!0,onError:d=W}=o,p=m(!a),r=c?C(n):m(n);let t=0;return F(async i=>{if(!p.value)return;t++;const f=t;let v=!1;u&&Promise.resolve().then(()=>{u.value=!0});try{const h=await e(y=>{i(()=>{u&&(u.value=!1),v||y()})});f===t&&(r.value=h)}catch(h){d(h)}finally{u&&f===t&&(u.value=!1),v=!0}}),a?R(()=>(p.value=!0,r.value)):r}function T(e){var n;const s=L(e);return(n=s==null?void 0:s.$el)!=null?n:s}const H=B?window:void 0;function w(...e){let n,s,o,a;if(typeof e[0]=="string"||Array.isArray(e[0])?([s,o,a]=e,n=H):[n,s,o,a]=e,!n)return W;Array.isArray(s)||(s=[s]),Array.isArray(o)||(o=[o]);const u=[],c=()=>{u.forEach(t=>t()),u.length=0},d=(t,i,f,v)=>(t.addEventListener(i,f,v),()=>t.removeEventListener(i,f,v)),p=O(()=>[T(n),L(a)],([t,i])=>{c(),t&&u.push(...s.flatMap(f=>o.map(v=>d(t,f,v,i))))},{immediate:!0,flush:"post"}),r=()=>{p(),c()};return M(r),r}const V={page:e=>[e.pageX,e.pageY],client:e=>[e.clientX,e.clientY],screen:e=>[e.screenX,e.screenY],movement:e=>e instanceof Touch?null:[e.movementX,e.movementY]};function b(e={}){const{type:n="page",touch:s=!0,resetOnTouchEnds:o=!1,initialValue:a={x:0,y:0},window:u=H,target:c=u,eventFilter:d}=e,p=m(a.x),r=m(a.y),t=m(null),i=typeof n=="function"?n:V[n],f=l=>{const g=i(l);g&&([p.value,r.value]=g,t.value="mouse")},v=l=>{if(l.touches.length>0){const g=i(l.touches[0]);g&&([p.value,r.value]=g,t.value="touch")}},h=()=>{p.value=a.x,r.value=a.y},y=d?l=>d(()=>f(l),{}):l=>f(l),E=d?l=>d(()=>v(l),{}):l=>v(l);return c&&(w(c,"mousemove",y,{passive:!0}),w(c,"dragover",y,{passive:!0}),s&&n!=="movement"&&(w(c,"touchstart",E,{passive:!0}),w(c,"touchmove",E,{passive:!0}),o&&w(c,"touchend",h,{passive:!0}))),{x:p,y:r,sourceType:t}}function I(e,n={}){const{handleOutside:s=!0,window:o=H}=n,{x:a,y:u,sourceType:c}=b(n),d=m(e??(o==null?void 0:o.document.body)),p=m(0),r=m(0),t=m(0),i=m(0),f=m(0),v=m(0),h=m(!0);let y=()=>{};return o&&(y=O([d,a,u],()=>{const E=T(d);if(!E)return;const{left:l,top:g,width:x,height:A}=E.getBoundingClientRect();t.value=l+o.pageXOffset,i.value=g+o.pageYOffset,f.value=A,v.value=x;const X=a.value-t.value,Y=u.value-i.value;h.value=x===0||A===0||X<0||Y<0||X>x||Y>A,(s||!h.value)&&(p.value=X,r.value=Y)},{immediate:!0}),w(document,"mouseleave",()=>{h.value=!0})),{x:a,y:u,sourceType:c,elementX:p,elementY:r,elementPositionX:t,elementPositionY:i,elementHeight:f,elementWidth:v,isOutside:h,stop:y}}export{D as c,I as u};
