import{d as Wt,r as Tt,b as xt,v as Mt,D as ue,w as Ce,ah as Me,a as ft,c as Nt,i as Vt,f as Z,g as nt,p as zt,j as kt,k as _t,F as $t,A as qe,B as be,ab as Ne,ac as cn,ay as dn,aC as fe,q as Qt,h as Zt,z as Ee,N as Qe,ad as Gt,U as Je,aj as hn,m as pn,u as Xe,aD as pe}from"./index-5e7b76fe.js";import{s as Ve}from"./_plugin-vue_export-helper-dad06003-f875bd67.js";import{g as Ye,$ as fn}from"./chartActionUtil-201ccd97-6331c097.js";import{c as We,r as mn,e as Ze,u as gn}from"./biTool-e603ec91-3f60f9c4.js";import{p as ze}from"./index-a4ee6eee-59bbdb03.js";import"./index-3458eb1c-625f9c79.js";var Rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};const vn={name:"splitpanes",emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click"],props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce((B,A)=>(B[A.id]=A)&&B,{})}},methods:{updatePaneComponents(){this.panes.forEach(B=>{B.update&&B.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[B.id].size}%`})})},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(B,A){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=A},onMouseMove(B){this.touch.mouseDown&&(B.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(B)),this.$emit("resize",this.panes.map(A=>({min:A.min,max:A.max,size:A.size}))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map(B=>({min:B.min,max:B.max,size:B.size}))),this.touch.mouseDown=!1,setTimeout(()=>{this.touch.dragging=!1,this.unbindEvents()},100)},onSplitterClick(B,A){"ontouchstart"in window&&(B.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===A?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(B,A),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=A,this.splitterTaps.timeoutId=setTimeout(()=>{this.splitterTaps.splitter=null},500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[A])},onSplitterDblClick(B,A){let n=0;this.panes=this.panes.map((C,F)=>(C.size=F===A?C.max:C.min,F!==A&&(n+=C.min),C)),this.panes[A].size-=n,this.$emit("pane-maximize",this.panes[A]),this.$emit("resized",this.panes.map(C=>({min:C.min,max:C.max,size:C.size})))},onPaneClick(B,A){this.$emit("pane-click",this.indexedPanes[A])},getCurrentMouseDrag(B){const A=this.container.getBoundingClientRect(),{clientX:n,clientY:C}="ontouchstart"in window&&B.touches?B.touches[0]:B;return{x:n-A.left,y:C-A.top}},getCurrentDragPercentage(B){B=B[this.horizontal?"y":"x"];const A=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(B=A-B),B*100/A},calculatePanesSize(B){const A=this.touch.activeSplitter;let n={prevPanesSize:this.sumPrevPanesSize(A),nextPanesSize:this.sumNextPanesSize(A),prevReachedMinPanes:0,nextReachedMinPanes:0};const C=0+(this.pushOtherPanes?0:n.prevPanesSize),F=100-(this.pushOtherPanes?0:n.nextPanesSize),z=Math.max(Math.min(this.getCurrentDragPercentage(B),F),C);let H=[A,A+1],s=this.panes[H[0]]||null,P=this.panes[H[1]]||null;const a=s.max<100&&z>=s.max+n.prevPanesSize,i=P.max<100&&z<=100-(P.max+this.sumNextPanesSize(A+1));if(a||i){a?(s.size=s.max,P.size=Math.max(100-s.max-n.prevPanesSize-n.nextPanesSize,0)):(s.size=Math.max(100-P.max-n.prevPanesSize-this.sumNextPanesSize(A+1),0),P.size=P.max);return}if(this.pushOtherPanes){const m=this.doPushOtherPanes(n,z);if(!m)return;({sums:n,panesToResize:H}=m),s=this.panes[H[0]]||null,P=this.panes[H[1]]||null}s!==null&&(s.size=Math.min(Math.max(z-n.prevPanesSize-n.prevReachedMinPanes,s.min),s.max)),P!==null&&(P.size=Math.min(Math.max(100-z-n.nextPanesSize-n.nextReachedMinPanes,P.min),P.max))},doPushOtherPanes(B,A){const n=this.touch.activeSplitter,C=[n,n+1];return A<B.prevPanesSize+this.panes[C[0]].min&&(C[0]=this.findPrevExpandedPane(n).index,B.prevReachedMinPanes=0,C[0]<n&&this.panes.forEach((F,z)=>{z>C[0]&&z<=n&&(F.size=F.min,B.prevReachedMinPanes+=F.min)}),B.prevPanesSize=this.sumPrevPanesSize(C[0]),C[0]===void 0)?(B.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach((F,z)=>{z>0&&z<=n&&(F.size=F.min,B.prevReachedMinPanes+=F.min)}),this.panes[C[1]].size=100-B.prevReachedMinPanes-this.panes[0].min-B.prevPanesSize-B.nextPanesSize,null):A>100-B.nextPanesSize-this.panes[C[1]].min&&(C[1]=this.findNextExpandedPane(n).index,B.nextReachedMinPanes=0,C[1]>n+1&&this.panes.forEach((F,z)=>{z>n&&z<C[1]&&(F.size=F.min,B.nextReachedMinPanes+=F.min)}),B.nextPanesSize=this.sumNextPanesSize(C[1]-1),C[1]===void 0)?(B.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach((F,z)=>{z<this.panesCount-1&&z>=n+1&&(F.size=F.min,B.nextReachedMinPanes+=F.min)}),this.panes[C[0]].size=100-B.prevPanesSize-B.nextReachedMinPanes-this.panes[this.panesCount-1].min-B.nextPanesSize,null):{sums:B,panesToResize:C}},sumPrevPanesSize(B){return this.panes.reduce((A,n,C)=>A+(C<B?n.size:0),0)},sumNextPanesSize(B){return this.panes.reduce((A,n,C)=>A+(C>B+1?n.size:0),0)},findPrevExpandedPane(B){return[...this.panes].reverse().find(A=>A.index<B&&A.size>A.min)||{}},findNextExpandedPane(B){return this.panes.find(A=>A.index>B+1&&A.size>A.min)||{}},checkSplitpanesNodes(){Array.from(this.container.children).forEach(B=>{const A=B.classList.contains("splitpanes__pane"),n=B.classList.contains("splitpanes__splitter");!A&&!n&&(B.parentNode.removeChild(B),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))})},addSplitter(B,A,n=!1){const C=B-1,F=document.createElement("div");F.classList.add("splitpanes__splitter"),n||(F.onmousedown=z=>this.onMouseDown(z,C),typeof window<"u"&&"ontouchstart"in window&&(F.ontouchstart=z=>this.onMouseDown(z,C)),F.onclick=z=>this.onSplitterClick(z,C+1)),this.dblClickSplitter&&(F.ondblclick=z=>this.onSplitterDblClick(z,C+1)),A.parentNode.insertBefore(F,A)},removeSplitter(B){B.onmousedown=void 0,B.onclick=void 0,B.ondblclick=void 0,B.parentNode.removeChild(B)},redoSplitters(){const B=Array.from(this.container.children);B.forEach(n=>{n.className.includes("splitpanes__splitter")&&this.removeSplitter(n)});let A=0;B.forEach(n=>{n.className.includes("splitpanes__pane")&&(!A&&this.firstSplitter?this.addSplitter(A,n,!0):A&&this.addSplitter(A,n),A++)})},requestUpdate({target:B,...A}){const n=this.indexedPanes[B._.uid];Object.entries(A).forEach(([C,F])=>n[C]=F)},onPaneAdd(B){let A=-1;Array.from(B.$el.parentNode.children).some(F=>(F.className.includes("splitpanes__pane")&&A++,F===B.$el));const n=parseFloat(B.minSize),C=parseFloat(B.maxSize);this.panes.splice(A,0,{id:B._.uid,index:A,min:isNaN(n)?0:n,max:isNaN(C)?100:C,size:B.size===null?null:parseFloat(B.size),givenSize:B.size,update:B.update}),this.panes.forEach((F,z)=>F.index=z),this.ready&&this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[A]}),this.$emit("pane-add",{index:A,panes:this.panes.map(F=>({min:F.min,max:F.max,size:F.size}))})})},onPaneRemove(B){const A=this.panes.findIndex(C=>C.id===B._.uid),n=this.panes.splice(A,1)[0];this.panes.forEach((C,F)=>C.index=F),this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:{...n,index:A}}),this.$emit("pane-remove",{removed:n,panes:this.panes.map(C=>({min:C.min,max:C.max,size:C.size}))})})},resetPaneSizes(B={}){!B.addedPane&&!B.removedPane?this.initialPanesSizing():this.panes.some(A=>A.givenSize!==null||A.min||A.max<100)?this.equalizeAfterAddOrRemove(B):this.equalize(),this.ready&&this.$emit("resized",this.panes.map(A=>({min:A.min,max:A.max,size:A.size})))},equalize(){const B=100/this.panesCount;let A=0;const n=[],C=[];this.panes.forEach(F=>{F.size=Math.max(Math.min(B,F.max),F.min),A-=F.size,F.size>=F.max&&n.push(F.id),F.size<=F.min&&C.push(F.id)}),A>.1&&this.readjustSizes(A,n,C)},initialPanesSizing(){let B=100;const A=[],n=[];let C=0;this.panes.forEach(z=>{B-=z.size,z.size!==null&&C++,z.size>=z.max&&A.push(z.id),z.size<=z.min&&n.push(z.id)});let F=100;B>.1&&(this.panes.forEach(z=>{z.size===null&&(z.size=Math.max(Math.min(B/(this.panesCount-C),z.max),z.min)),F-=z.size}),F>.1&&this.readjustSizes(B,A,n))},equalizeAfterAddOrRemove({addedPane:B,removedPane:A}={}){let n=100/this.panesCount,C=0;const F=[],z=[];B&&B.givenSize!==null&&(n=(100-B.givenSize)/(this.panesCount-1)),this.panes.forEach(H=>{C-=H.size,H.size>=H.max&&F.push(H.id),H.size<=H.min&&z.push(H.id)}),!(Math.abs(C)<.1)&&(this.panes.forEach(H=>{B&&B.givenSize!==null&&B.id===H.id||(H.size=Math.max(Math.min(n,H.max),H.min)),C-=H.size,H.size>=H.max&&F.push(H.id),H.size<=H.min&&z.push(H.id)}),C>.1&&this.readjustSizes(C,F,z))},readjustSizes(B,A,n){let C;B>0?C=B/(this.panesCount-A.length):C=B/(this.panesCount-n.length),this.panes.forEach((F,z)=>{if(B>0&&!A.includes(F.id)){const H=Math.max(Math.min(F.size+C,F.max),F.min),s=H-F.size;B-=s,F.size=H}else if(!n.includes(F.id)){const H=Math.max(Math.min(F.size+C,F.max),F.min),s=H-F.size;B-=s,F.size=H}F.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[F.id].size}%`})}),Math.abs(B)>.1&&this.$nextTick(()=>{this.ready&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(B){[...this.container.querySelectorAll(".splitpanes__splitter")].forEach((A,n)=>{A.ondblclick=B?C=>this.onSplitterDblClick(C,n):void 0})}},beforeUnmount(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.$emit("ready"),this.ready=!0},render(){return dn("div",{ref:"container",class:["splitpanes",`splitpanes--${this.horizontal?"horizontal":"vertical"}`,{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default())}},bn=(B,A)=>{const n=B.__vccOpts||B;for(const[C,F]of A)n[C]=F;return n},yn={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:null},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeUnmount(){this.onPaneRemove(this)},methods:{update(B){this.style=B}},computed:{sizeNumber(){return this.size||this.size===0?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(B){this.requestUpdate({target:this,size:B})},minSizeNumber(B){this.requestUpdate({target:this,min:B})},maxSizeNumber(B){this.requestUpdate({target:this,max:B})}}};function Pn(B,A,n,C,F,z){return xt(),Nt("div",{class:"splitpanes__pane",onClick:A[0]||(A[0]=H=>z.onPaneClick(H,B._.uid)),style:Qe(B.style)},[hn(B.$slots,"default")],4)}const $e=bn(yn,[["render",Pn]]),_n={style:{display:"inline-block",cursor:"pointer"}},xn={style:{display:"inline-block",cursor:"pointer","margin-left":"10px"}},Cn=Wt({__name:"ModelHeader",props:["modelValue","entities"],emits:["update:modelValue"],setup(B,{emit:A}){const n=B,C=A,{modelValue:F}=fe(n,C),z=Tt(!1);function H(){z.value=!0}function s(){z.value=!1}return(P,a)=>{const i=ft("lc-icon"),m=ft("el-input");return xt(),Nt("div",null,[Vt("div",_n,[z.value?Qt("",!0):(xt(),Nt("span",{key:0,onClick:H},kt(_t(F).name),1)),z.value?(xt(),Mt(m,{key:1,modelValue:_t(F).name,"onUpdate:modelValue":a[0]||(a[0]=b=>_t(F).name=b),placeholder:"",size:"small"},{suffix:nt(()=>[Z(i,{icon:"mdiCheck",onClick:s,size:"medium"})]),_:1},8,["modelValue"])):Qt("",!0)]),Vt("div",xn,[z.value?Qt("",!0):(xt(),Nt("span",{key:0,onClick:H,style:{"font-size":"0.8em","margin-left":"20px"}},kt(_t(F).description),1)),z.value?(xt(),Mt(m,{key:1,modelValue:_t(F).description,"onUpdate:modelValue":a[1]||(a[1]=b=>_t(F).description=b),placeholder:P.$t("_._.description"),size:"small"},{suffix:nt(()=>[Z(i,{icon:"mdiCheck",onClick:s,size:"medium"})]),_:1},8,["modelValue","placeholder"])):Qt("",!0)])])}}}),En={style:{"font-weight":"700","margin-left":"20px","margin-bottom":"10px"}},Sn=["onDragstart"],jn={style:{"font-size":"0.8em",color:"var(--el-text-color-secondary)"}},Dn=Wt({__name:"EntityList",props:["entities"],setup(B){const A=B,n=Tt(""),C=Ee(()=>A.entities.filter(H=>n.value?H.name.indexOf(n.value)>=0:!0));function F(H,s){H.dataTransfer.setData("text",JSON.stringify(s))}function z(H){H.dataTransfer.setData("text",JSON.stringify({type:"SQL"}))}return(H,s)=>{const P=ft("lc-icon"),a=ft("el-input"),i=ft("el-scrollbar");return xt(),Nt("div",null,[Vt("div",En,kt(H.$t("bi.plugin.modelEditor.single.entityList.tableOrView")),1),Vt("div",{class:"table-button",draggable:!0,onDragstart:s[0]||(s[0]=m=>z(m))},[Z(P,{icon:"mdiDatabaseEditOutline"}),zt(" "+kt(H.$t("bi.plugin.modelEditor.single.entityList.insertSQL")),1)],32),Z(a,{style:{"margin-left":"10px",padding:"4px 4px",width:"calc(100% - 12px)"},modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=m=>n.value=m),size:"small",clearable:"",placeholder:"请输入过滤条件"},null,8,["modelValue"]),Z(i,{height:"calc(100vh - 200px)",style:{width:"98%"}},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(C.value,m=>(xt(),Nt("div",{key:m.schema+"."+m.name,size:"large",class:"table-button",draggable:!0,onDragstart:b=>F(b,m)},[Vt("div",null,[Z(P,{icon:m.type=="TABLE"?"mdiTable":"mdiViewGridPlusOutline"},null,8,["icon"]),zt(" "+kt(m.name),1)]),Vt("div",jn,kt(m.description),1)],40,Sn))),128))]),_:1})])}}}),wn=Ve(Dn,[["__scopeId","data-v-b0fb63dd"]]),kn={class:"toolbar-table-container"},An={class:"lc-common-toolbar toolbar"},In={class:"left"},Tn=Wt({__name:"DataPreview",props:["model"],setup(B){const A=ue("globalContext"),n=B,C=Tt([]),F=Tt([]),z=Tt(10);function H(){A.request({method:"POST",url:"/bi/dataModel/loadPreviewData",params:{maxRows:z.value},data:n.model}).then(function(a){a.error?fn(A,a):C.value=a.data,s()})}function s(){const a=P(n.model.columns||[]);F.value=a}function P(a){const i=[];for(const m of a){const b={prop:m.key,label:m.label};i.push(b),m.children&&Array.isArray(m.children)&&m.children.length>=0&&(b.children=P(m.children))}return i}return(a,i)=>{const m=ft("el-input-number"),b=ft("lc-icon"),D=ft("el-button"),v=ft("el-button-group"),c=ft("el-table");return xt(),Nt("div",kn,[Vt("div",An,[Vt("div",In,kt(a.$t("bi.plugin.modelEditor.single.dataPreview.lineCount"))+": "+kt(C.value.length),1),Z(v,{class:"right"},{default:nt(()=>[zt(kt(a.$t("bi.plugin.modelEditor.single.dataPreview.linePreview"))+":",1),Z(m,{modelValue:z.value,"onUpdate:modelValue":i[0]||(i[0]=t=>z.value=t),precision:0,controls:!1,style:{"margin-right":"4px","margin-left":"4px"}},null,8,["modelValue"]),Z(D,{onClick:H},{icon:nt(()=>[Z(b,{icon:"mdiRefresh"})]),default:nt(()=>[zt(kt(a.$t("bi.plugin.modelEditor.single.dataPreview.refresh")),1)]),_:1})]),_:1})]),be((xt(),Mt(c,{data:C.value,border:"",fit:!0,"empty-text":a.$t("bi.plugin.modelEditor.single.dataPreview.emptyText")},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(F.value,t=>(xt(),Mt(Ye,{key:t.prop,prop:t.prop,label:t.label},{default:nt(()=>[t.children?(xt(!0),Nt($t,{key:0},Zt(t.children,_=>(xt(),Mt(Ye,{key:_.prop,prop:_.prop,label:_.label},null,8,["prop","label"]))),128)):Qt("",!0)]),_:2},1032,["prop","label"]))),128))]),_:1},8,["data","empty-text"])),[[_t(Ne),8]])])}}});function On(B,A,n){if(B==A)return;n=_t(n);const C=Ke(B,n),F=Ke(A,n);return en(C,n),Mn(C,F,n),!0}function Ke(B,A){return A=_t(A),n(A);function n(C){for(const F of C){if(B==0)return F;if(B--,F.children&&Array.isArray(F.children)){const z=n(F.children);if(z)return z}}}}function tn(B,A){return B&&A&&B.key==A.key}function en(B,A){return A=_t(A),n(A);function n(C){for(let F=0;F<C.length;F++){const z=C[F];if(tn(B,z))return C.splice(F,1),!0;if(z.children&&Array.isArray(z.children)&&n(z.children))return!0}return!1}}function Mn(B,A,n){return n=_t(n),C(n);function C(F){for(let z=0;z<F.length;z++){const H=F[z];if(tn(A,H))return H.children&&Array.isArray(H.children)?H.children.push(B):F.splice(z+1,0,B),!0;if(H.children&&Array.isArray(H.children)&&C(H.children))return!0}return!1}}const Vn={class:"dialog-footer"},zn=Wt({__name:"AddExpressionDialog",props:pn(["model","callback"],{modelValue:{},modelModifiers:{},data:{},dataModifiers:{}}),emits:["update:modelValue","update:data"],setup(B){const A=B,n=Xe(B,"modelValue"),C=Xe(B,"data"),F=Tt(null);function z(){F.value.validate(H=>{H&&(C.value.type="expression",A.callback(C.value),n.value=!1)})}return(H,s)=>{const P=ft("el-input"),a=ft("el-form-item"),i=ft("el-option"),m=ft("el-select"),b=ft("el-form"),D=ft("el-button"),v=ft("el-dialog");return xt(),Mt(v,{modelValue:n.value,"onUpdate:modelValue":s[5]||(s[5]=c=>n.value=c),title:H.$t("bi.plugin.modelEditor.single.fieldEditor.expression"),width:"30%","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0},{footer:nt(()=>[Vt("span",Vn,[Z(D,{onClick:s[4]||(s[4]=c=>n.value=!1)},{default:nt(()=>[zt(kt(H.$t("_._.cancel")),1)]),_:1}),Z(D,{type:"primary",onClick:z},{default:nt(()=>[zt(kt(H.$t("_._.ok")),1)]),_:1})])]),default:nt(()=>[Z(b,{ref_key:"addExpressionFormRef",ref:F,model:C.value,"label-width":"100px"},{default:nt(()=>[Z(a,{label:H.$t("_._.name"),prop:"label",required:""},{default:nt(()=>[Z(P,{modelValue:C.value.label,"onUpdate:modelValue":s[0]||(s[0]=c=>C.value.label=c)},null,8,["modelValue"])]),_:1},8,["label"]),Z(a,{label:H.$t("bi.plugin.modelEditor.single.fieldEditor.expression"),prop:"expression",required:""},{default:nt(()=>[Z(P,{modelValue:C.value.expression,"onUpdate:modelValue":s[1]||(s[1]=c=>C.value.expression=c)},null,8,["modelValue"])]),_:1},8,["label"]),Z(a,{label:H.$t("bi.plugin.modelEditor.single.fieldEditor.dataType"),prop:"dataType",required:""},{default:nt(()=>[Z(m,{modelValue:C.value.dataType,"onUpdate:modelValue":s[2]||(s[2]=c=>C.value.dataType=c)},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(_t(Ze),c=>(xt(),Mt(i,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),Z(a,{label:H.$t("bi.plugin.modelEditor.single.fieldEditor.entity"),prop:"entities"},{default:nt(()=>[Z(m,{modelValue:C.value.entities,"onUpdate:modelValue":s[3]||(s[3]=c=>C.value.entities=c),multiple:""},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(B.model.entities,c=>(xt(),Mt(i,{key:c.key,label:c.name,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Fn={class:"dialog-footer"},Ln=Wt({__name:"AddHierarchyDialog",props:["modelValue","callback"],emits:["update:modelValue"],setup(B,{emit:A}){const n=B,C=A,{modelValue:F}=fe(n,C),z=Tt({}),H=Tt(null);function s(){H.value.validate(P=>{P&&(z.value.key="h"+pe.createUniqueString(),z.value.type="hierarchy",z.value.children=[],n.callback(z.value),F.value=!1)})}return(P,a)=>{const i=ft("el-input"),m=ft("el-form-item"),b=ft("el-form"),D=ft("el-button"),v=ft("el-dialog");return xt(),Mt(v,{modelValue:_t(F),"onUpdate:modelValue":a[2]||(a[2]=c=>Je(F)?F.value=c:null),title:P.$t("bi.plugin.modelEditor.single.fieldEditor.addHierarchy"),width:"30%","close-on-click-modal":!1,"close-on-press-escape":!1,onOpen:a[3]||(a[3]=c=>z.value={})},{footer:nt(()=>[Vt("span",Fn,[Z(D,{onClick:a[1]||(a[1]=c=>F.value=!1)},{default:nt(()=>[zt(kt(P.$t("_._.cancel")),1)]),_:1}),Z(D,{type:"primary",onClick:s},{default:nt(()=>[zt(kt(P.$t("_._.ok")),1)]),_:1})])]),default:nt(()=>[Z(b,{ref_key:"addHierarchyFormRef",ref:H,model:z.value,"label-width":"80px"},{default:nt(()=>[Z(m,{label:P.$t("_._.name"),prop:"label",required:""},{default:nt(()=>[Z(i,{modelValue:z.value.label,"onUpdate:modelValue":a[0]||(a[0]=c=>z.value.label=c)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});function nn(B,A){if(!A)return-1;for(let n=0;n<B.entities.length;n++)if(B.entities[n].key==A)return n;return-1}function Se(B,A){const n=nn(B,A);if(n>=0)return B.entities[n]}function on(B,A,n){for(let C=0;C<B.relations.length;C++){const F=B.relations[C];if(F.source==A&&F.target==n)return C}return-1}function Nn(B,A){for(let n=0;n<B.columns.length;n++)if(B.columns[n].entity==A)return n;return-1}function Un(B,A){for(let n=0;n<B.columns.length;n++)if(B.columns[n].key==A)return n;return-1}function Rn(B,A){const n=Un(B,A);if(n>=0)return B.columns[n]}function Gn(B,A,n){const C=on(B,A,n);if(C>=0)return B.relations[C]}function Ue(B,A,n){return B({method:"POST",url:"/bi/dataModel/loadEntityFields",params:{model:A},data:n})}function Fe(B,A,n,C){if(!n){C.value=[];return}Ue(B,A,n).then(function(F){C.value=F.data})}function Bn(B,A){const n=B.columns.filter(C=>C.entity==A);for(const C of B.columns)for(const F of C.children||[])F.entity==A&&n.push(F);return n}function Le(B,A){for(const n of Object.keys(A))B[n]=A[n]}const Hn={class:"toolbar-table-container"},qn={class:"lc-common-toolbar toolbar"},Xn={class:"left"},Yn=Wt({__name:"FieldEditor",props:["modelValue"],emits:["update:modelValue"],setup(B,{emit:A}){const n=B,C=A,{modelValue:F}=fe(n,C),z=Ee(()=>L=>L.type=="hierarchy"?{icon:"mdiFileTreeOutline",tooltip:Gt.t("bi.plugin.modelEditor.single.fieldEditor.hierarchy")}:L.type=="expression"?{icon:"mdiCalculatorVariantOutline",tooltip:Gt.t("bi.plugin.modelEditor.single.fieldEditor.expression")}:{}),H=Tt(!1),s=Tt({});function P(L={}){s.value=L,H.value=!0}function a(L){if(!L.key)L.key="e"+pe.createUniqueString(),F.value.columns.push(L);else{const U=Rn(F?.value,L.key);U&&Le(U,L)}c()}const i=Tt(!1);function m(L){F.value.columns.push(L),c()}function b(L){ze.confirm(Gt.t("bi.plugin.modelEditor.single.fieldEditor.deleteConfirm",[L.label]),Gt.t("_._.warning"),{confirmButtonText:Gt.t("_._.ok"),cancelButtonText:Gt.t("_._.cancel"),type:"warning"}).then(()=>{en(L,F?.value.columns),c()})}Ce(()=>F.value.columns,()=>{c()},{immediate:!0,deep:!0});let D=-1,v=-1;function c(){Me(()=>{document.querySelectorAll(".draggableTreeTable .isDragBox").forEach((L,U)=>{L.setAttribute("draggable","true"),L.ondragstart=()=>t(U),L.ondragover=y=>_(U,y),L.ondragend=()=>j()})})}function t(L){v=L}function _(L,U){U.preventDefault(),D=L}function j(){On(v,D,F?.value.columns),c()}return(L,U)=>{const y=ft("lc-icon"),I=ft("el-button"),r=ft("el-button-group"),p=ft("el-table-column"),d=ft("el-input"),w=ft("el-option"),M=ft("el-select"),h=ft("el-table");return xt(),Nt($t,null,[Vt("div",Hn,[Vt("div",qn,[Vt("div",Xn,kt(L.$t("bi.plugin.modelEditor.single.fieldEditor.prompt")),1),Z(r,{class:"right"},{default:nt(()=>[Z(I,{onClick:U[0]||(U[0]=k=>P())},{icon:nt(()=>[Z(y,{icon:"mdiCalculatorVariantOutline"})]),default:nt(()=>[zt(kt(L.$t("bi.plugin.modelEditor.single.fieldEditor.addExpression")),1)]),_:1})]),_:1})]),be((xt(),Mt(h,{data:_t(F).columns,style:{width:"100%"},"row-key":"key",border:"","default-expand-all":"","highlight-current-row":"","row-class-name":"",class:"draggableTreeTable table-area"},{default:nt(()=>[Z(p,{prop:"",label:"",width:"32px"}),Z(p,{prop:"",label:L.$t("bi.plugin.modelEditor.single.fieldEditor.drag"),width:"60px"},{default:nt(()=>[Vt("span",null,[Z(y,{class:"isDragBox",icon:"mdiDialpad"})])]),_:1},8,["label"]),Z(p,{prop:"column",label:L.$t("bi.plugin.modelEditor.single.fieldEditor.field")},{default:nt(k=>[Z(y,{icon:z.value(k.row).icon,tooltip:z.value(k.row).tooltip,size:"1.2em",color:"#A9A9A9",style:{"margin-right":"4px"}},null,8,["icon","tooltip"]),zt(" "+kt(k.row.column),1)]),_:1},8,["label"]),Z(p,{prop:"label",label:L.$t("_._.name")},{default:nt(k=>[Z(d,{modelValue:k.row.label,"onUpdate:modelValue":x=>k.row.label=x},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),Z(p,{prop:"entity",label:L.$t("bi.plugin.modelEditor.single.fieldEditor.entity")},{default:nt(k=>{var x;return[zt(kt((x=_t(Se)(_t(F),k.row.entity))==null?void 0:x.name),1)]}),_:1},8,["label"]),Z(p,{prop:"type",label:L.$t("bi.plugin.modelEditor.single.fieldEditor.type")},{default:nt(k=>[Z(M,{modelValue:k.row.type,"onUpdate:modelValue":x=>k.row.type=x,disabled:!0},{default:nt(()=>[Z(w,{label:L.$t("bi.plugin.modelEditor.single.fieldEditor.field"),value:"field"},null,8,["label"]),Z(w,{label:L.$t("bi.plugin.modelEditor.single.fieldEditor.expression"),value:"expression"},null,8,["label"]),Z(w,{label:L.$t("bi.plugin.modelEditor.single.fieldEditor.hierarchy"),value:"hierarchy"},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),Z(p,{prop:"dataType",label:L.$t("bi.plugin.modelEditor.single.fieldEditor.dataType")},{default:nt(k=>[k.row.type!="hierarchy"?(xt(),Mt(M,{key:0,modelValue:k.row.dataType,"onUpdate:modelValue":x=>k.row.dataType=x},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(_t(Ze),x=>(xt(),Mt(w,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):Qt("",!0)]),_:1},8,["label"]),Z(p,{prop:"expression",label:L.$t("bi.plugin.modelEditor.single.fieldEditor.expression")},{default:nt(k=>[k.row.type=="expression"?(xt(),Mt(d,{key:0,modelValue:k.row.expression,"onUpdate:modelValue":x=>k.row.expression=x},{suffix:nt(()=>[Z(y,{icon:"mdiPencilOutline",style:{cursor:"pointer"},onClick:x=>P(k.row)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])):Qt("",!0)]),_:1},8,["label"]),Z(p,{prop:"",label:L.$t("_._.operation"),width:"100px"},{default:nt(k=>[Z(y,{icon:"mdiTrashCanOutline",style:{cursor:"pointer"},onClick:x=>b(k.row)},null,8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[_t(Ne),8]])]),Z(zn,{modelValue:H.value,"onUpdate:modelValue":U[1]||(U[1]=k=>H.value=k),data:s.value,"onUpdate:data":U[2]||(U[2]=k=>s.value=k),model:_t(F),callback:a},null,8,["modelValue","data","model"]),Z(Ln,{modelValue:i.value,"onUpdate:modelValue":U[3]||(U[3]=k=>i.value=k),callback:m},null,8,["modelValue"])],64)}}}),Wn=Ve(Yn,[["__scopeId","data-v-d43dd62e"]]);function $n(B){const A=Qn(B);return Kn(A)}function Kn(B){if(!B)return[];const A=[B];return sn(A,B.children||[]),A}function sn(B,A){for(const n of A)B.push(n),sn(B,n.children)}function Qn(B){const A=Jn(B);if(A)return rn(A),an([A]),A}function rn(B){if(B.children.length==0)return B.leafCount=1,1;let A=0;for(const n of B.children)A+=rn(n);return B.leafCount=A,A}function an(B){var A;if(B.length==0)return;let n=((A=B[0].parent)==null?void 0:A.leafAbove)||0;for(const C of B)C.leafAbove=n,n+=C.leafCount,an(C.children)}function Jn(B){const A=B.entities||[];if(A.length<=0)return;const n={entity:A[0],parent:void 0,level:0,relation:void 0,children:[]};return ln(B,n),n}function ln(B,A){for(const n of B.relations||[])if(n.source==A.entity.key){const C=Se(B,n.target);if(!C)continue;const F={entity:C,parent:A,level:A.level+1,relation:n,children:[]};A.children.push(F),ln(B,F)}}var Zn={};(function(B){(function(){typeof Math.sgn>"u"&&(Math.sgn=function(f){return f==0?0:f>0?1:-1});var A={subtract:function(f,O){return{x:f.x-O.x,y:f.y-O.y}},dotProduct:function(f,O){return f.x*O.x+f.y*O.y},square:function(f){return Math.sqrt(f.x*f.x+f.y*f.y)},scale:function(f,O){return{x:f.x*O,y:f.y*O}}},n=64,C=Math.pow(2,-n-1),F=function(f,O){for(var X=[],W=H(f,O),$=O.length-1,o=2*$-1,u=s(W,o,X,0),e=A.subtract(f,O[0]),g=A.square(e),E=0,G=0;G<u;G++){e=A.subtract(f,m(O,$,X[G],null,null));var R=A.square(e);R<g&&(g=R,E=X[G])}return e=A.subtract(f,O[$]),R=A.square(e),R<g&&(g=R,E=1),{location:E,distance:g}},z=function(f,O){var X=F(f,O);return{point:m(O,O.length-1,X.location,null,null),location:X.location}},H=function(f,O){for(var X=O.length-1,W=2*X-1,$=[],o=[],u=[],e=[],g=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],E=0;E<=X;E++)$[E]=A.subtract(O[E],f);for(var E=0;E<=X-1;E++)o[E]=A.subtract(O[E+1],O[E]),o[E]=A.scale(o[E],3);for(var G=0;G<=X-1;G++)for(var R=0;R<=X;R++)u[G]||(u[G]=[]),u[G][R]=A.dotProduct(o[G],$[R]);for(E=0;E<=W;E++)e[E]||(e[E]=[]),e[E].y=0,e[E].x=parseFloat(E)/W;for(var K=X,q=X-1,Q=0;Q<=K+q;Q++){var ct=Math.max(0,Q-q),at=Math.min(Q,K);for(E=ct;E<=at;E++){var rt=Q-E;e[E+rt].y+=u[rt][E]*g[rt][E]}}return e},s=function(f,O,X,W){var $=[],o=[],u,e,g=[],E=[];switch(P(f,O)){case 0:return 0;case 1:{if(W>=n)return X[0]=(f[0].x+f[O].x)/2,1;if(a(f,O))return X[0]=i(f,O),1;break}}m(f,O,.5,$,o),u=s($,O,g,W+1),e=s(o,O,E,W+1);for(var G=0;G<u;G++)X[G]=g[G];for(var G=0;G<e;G++)X[G+u]=E[G];return u+e},P=function(f,O){var X=0,W,$;W=$=Math.sgn(f[0].y);for(var o=1;o<=O;o++)W=Math.sgn(f[o].y),W!=$&&X++,$=W;return X},a=function(f,O){var X,W,$,o,u,e,g,E,G,R,K,q,Q,ct,at,rt;e=f[0].y-f[O].y,g=f[O].x-f[0].x,E=f[0].x*f[O].y-f[O].x*f[0].y;var lt,bt;lt=bt=0;for(var vt=1;vt<O;vt++){var dt=e*f[vt].x+g*f[vt].y+E;dt>lt?lt=dt:dt<bt&&(bt=dt)}return K=0,q=1,Q=0,ct=e,at=g,rt=E-lt,G=K*at-ct*q,R=1/G,W=(q*rt-at*Q)*R,ct=e,at=g,rt=E-bt,G=K*at-ct*q,R=1/G,$=(q*rt-at*Q)*R,o=Math.min(W,$),u=Math.max(W,$),X=u-o,X<C?1:0},i=function(f,O){var X=1,W=0,$=f[O].x-f[0].x,o=f[O].y-f[0].y,u=f[0].x-0,e=f[0].y-0,g=$*W-o*X,E=1/g,G=($*e-o*u)*E;return 0+X*G},m=function(f,O,X,W,$){for(var o=[[]],u=0;u<=O;u++)o[0][u]=f[u];for(var e=1;e<=O;e++)for(var u=0;u<=O-e;u++)o[e]||(o[e]=[]),o[e][u]||(o[e][u]={}),o[e][u].x=(1-X)*o[e-1][u].x+X*o[e-1][u+1].x,o[e][u].y=(1-X)*o[e-1][u].y+X*o[e-1][u+1].y;if(W!=null)for(u=0;u<=O;u++)W[u]=o[u][0];if($!=null)for(u=0;u<=O;u++)$[u]=o[O-u][u];return o[O][0]},b={},D=function(f){var O=b[f];if(!O){O=[];var X=function(){return function(R){return Math.pow(R,f)}},W=function(){return function(R){return Math.pow(1-R,f)}},$=function(R){return function(K){return R}},o=function(){return function(R){return R}},u=function(){return function(R){return 1-R}},e=function(R){return function(K){for(var q=1,Q=0;Q<R.length;Q++)q=q*R[Q](K);return q}};O.push(new X);for(var g=1;g<f;g++){for(var E=[new $(f)],G=0;G<f-g;G++)E.push(new o);for(var G=0;G<g;G++)E.push(new u);O.push(new e(E))}O.push(new W),b[f]=O}return O},v=function(f,O){for(var X=D(f.length-1),W=0,$=0,o=0;o<f.length;o++)W=W+f[o].x*X[o](O),$=$+f[o].y*X[o](O);return{x:W,y:$}},c=function(f,O){return Math.sqrt(Math.pow(f.x-O.x,2)+Math.pow(f.y-O.y,2))},t=function(f){return f[0].x===f[1].x&&f[0].y===f[1].y},_=function(f,O,X){if(t(f))return{point:f[0],location:O};for(var W=v(f,O),$=0,o=O,u=X>0?1:-1,e=null;$<Math.abs(X);)o+=.005*u,e=v(f,o),$+=c(e,W),W=e;return{point:e,location:o}},j=function(f){var O=new Date().getTime();if(t(f))return 0;for(var X=v(f,0),W=0,$=0,o=1,u=null;$<1;)$+=.005*o,u=v(f,$),W+=c(u,X),X=u;return console.log("length",new Date().getTime()-O),W},L=function(f,O,X){return _(f,O,X).point},U=function(f,O,X){return _(f,O,X).location},y=function(f,O){var X=v(f,O),W=v(f.slice(0,f.length-1),O),$=W.y-X.y,o=W.x-X.x;return $===0?1/0:Math.atan($/o)},I=function(f,O,X){var W=_(f,O,X);return W.location>1&&(W.location=1),W.location<0&&(W.location=0),y(f,W.location)},r=function(f,O,X,W){W=W??0;var $=_(f,O,W),o=y(f,$.location),u=Math.atan(-1/o),e=X/2*Math.sin(u),g=X/2*Math.cos(u);return[{x:$.point.x+g,y:$.point.y+e},{x:$.point.x-g,y:$.point.y-e}]},p=function(f,O,X,W,$){var o=W-O,u=f-X,e=f*(O-W)+O*(X-f),g=h($),E=[o*g[0][0]+u*g[1][0],o*g[0][1]+u*g[1][1],o*g[0][2]+u*g[1][2],o*g[0][3]+u*g[1][3]+e],G=x.apply(null,E),R=[];if(G!=null)for(var K=0;K<3;K++){var q=G[K],Q=Math.pow(q,2),ct=Math.pow(q,3),at=[g[0][0]*ct+g[0][1]*Q+g[0][2]*q+g[0][3],g[1][0]*ct+g[1][1]*Q+g[1][2]*q+g[1][3]],rt;X-f!==0?rt=(at[0]-f)/(X-f):rt=(at[1]-O)/(W-O),q>=0&&q<=1&&rt>=0&&rt<=1&&R.push(at)}return R},d=function(f,O,X,W,$){var o=[];return o.push.apply(o,p(f,O,f+X,O,$)),o.push.apply(o,p(f+X,O,f+X,O+W,$)),o.push.apply(o,p(f+X,O+W,f,O+W,$)),o.push.apply(o,p(f,O+W,f,O,$)),o},w=function(f,O){var X=[];return X.push.apply(X,p(f.x,f.y,f.x+f.w,f.y,O)),X.push.apply(X,p(f.x+f.w,f.y,f.x+f.w,f.y+f.h,O)),X.push.apply(X,p(f.x+f.w,f.y+f.h,f.x,f.y+f.h,O)),X.push.apply(X,p(f.x,f.y+f.h,f.x,f.y,O)),X};function M(f,O){return[-f[0][O]+3*f[1][O]+-3*f[2][O]+f[3][O],3*f[0][O]-6*f[1][O]+3*f[2][O],-3*f[0][O]+3*f[1][O],f[0][O]]}function h(f){return[M(f,"x"),M(f,"y")]}function k(f){return f<0?-1:f>0?1:0}function x(f,O,X,W){var $=O/f,o=X/f,u=W/f,e=(3*o-Math.pow($,2))/9,g=(9*$*o-27*u-2*Math.pow($,3))/54,E=Math.pow(e,3)+Math.pow(g,2),G,R,K=[];if(E>=0)G=k(g+Math.sqrt(E))*Math.pow(Math.abs(g+Math.sqrt(E)),1/3),R=k(g-Math.sqrt(E))*Math.pow(Math.abs(g-Math.sqrt(E)),1/3),K[0]=-$/3+(G+R),K[1]=-$/3-(G+R)/2,K[2]=-$/3-(G+R)/2,Math.abs(Math.sqrt(3)*(G-R)/2)!==0&&(K[1]=-1,K[2]=-1);else{var q=Math.acos(g/Math.sqrt(-Math.pow(e,3)));K[0]=2*Math.sqrt(-e)*Math.cos(q/3)-$/3,K[1]=2*Math.sqrt(-e)*Math.cos((q+2*Math.PI)/3)-$/3,K[2]=2*Math.sqrt(-e)*Math.cos((q+4*Math.PI)/3)-$/3}for(var Q=0;Q<3;Q++)(K[Q]<0||K[Q]>1)&&(K[Q]=-1);return K}var T=this.jsBezier={distanceFromCurve:F,gradientAtPoint:y,gradientAtPointAlongCurveFrom:I,nearestPointOnCurve:z,pointOnCurve:v,pointAlongCurveFrom:L,perpendicularToCurveAt:r,locationAlongCurveFrom:U,getLength:j,lineIntersection:p,boxIntersection:d,boundingBoxIntersection:w,version:"0.9.0"};B.jsBezier=T}).call(typeof window<"u"?window:Rt),function(){var A=this,n=A.Biltong={version:"0.4.0"};B.Biltong=n;var C=function(a){return Object.prototype.toString.call(a)==="[object Array]"},F=function(a,i,m){return a=C(a)?a:[a.x,a.y],i=C(i)?i:[i.x,i.y],m(a,i)},z=n.gradient=function(a,i){return F(a,i,function(m,b){return b[0]==m[0]?b[1]>m[1]?1/0:-1/0:b[1]==m[1]?b[0]>m[0]?0:-0:(b[1]-m[1])/(b[0]-m[0])})};n.normal=function(a,i){return-1/z(a,i)},n.lineLength=function(a,i){return F(a,i,function(m,b){return Math.sqrt(Math.pow(b[1]-m[1],2)+Math.pow(b[0]-m[0],2))})};var H=n.quadrant=function(a,i){return F(a,i,function(m,b){return b[0]>m[0]||b[0]==m[0]?b[1]>m[1]?2:1:b[1]>m[1]?3:4})};n.theta=function(a,i){return F(a,i,function(m,b){var D=z(m,b),v=Math.atan(D),c=H(m,b);return(c==4||c==3)&&(v+=Math.PI),v<0&&(v+=2*Math.PI),v})},n.intersects=function(a,i){var m=a.x,b=a.x+a.w,D=a.y,v=a.y+a.h,c=i.x,t=i.x+i.w,_=i.y,j=i.y+i.h;return m<=c&&c<=b&&D<=_&&_<=v||m<=t&&t<=b&&D<=_&&_<=v||m<=c&&c<=b&&D<=j&&j<=v||m<=t&&c<=b&&D<=j&&j<=v||c<=m&&m<=t&&_<=D&&D<=j||c<=b&&b<=t&&_<=D&&D<=j||c<=m&&m<=t&&_<=v&&v<=j||c<=b&&m<=t&&_<=v&&v<=j},n.encloses=function(a,i,m){var b=a.x,D=a.x+a.w,v=a.y,c=a.y+a.h,t=i.x,_=i.x+i.w,j=i.y,L=i.y+i.h,U=function(y,I,r,p){return m?y<=I&&r>=p:y<I&&r>p};return U(b,t,D,_)&&U(v,j,c,L)};var s=[null,[1,-1],[1,1],[-1,1],[-1,-1]],P=[null,[-1,-1],[-1,1],[1,1],[1,-1]];n.pointOnLine=function(a,i,m){var b=z(a,i),D=H(a,i),v=m>0?s[D]:P[D],c=Math.atan(b),t=Math.abs(m*Math.sin(c))*v[1],_=Math.abs(m*Math.cos(c))*v[0];return{x:a.x+_,y:a.y+t}},n.perpendicularLineTo=function(a,i,m){var b=z(a,i),D=Math.atan(-1/b),v=m/2*Math.sin(D),c=m/2*Math.cos(D);return[{x:i.x+c,y:i.y+v},{x:i.x-c,y:i.y-v}]}}.call(typeof window<"u"?window:Rt),function(){function A(o,u,e,g,E,G,R,K){return new Touch({target:u,identifier:$(),pageX:e,pageY:g,screenX:E,screenY:G,clientX:R||E,clientY:K||G})}function n(){var o=[];return Array.prototype.push.apply(o,arguments),o.item=function(u){return this[u]},o}function C(o,u,e,g,E,G,R,K){return n(A.apply(null,arguments))}var F=this,z=function(o,u,e){e=e||o.parentNode;for(var g=e.querySelectorAll(u),E=0;E<g.length;E++)if(g[E]===o)return!0;return!1},H=function(o){return typeof o=="string"||o.constructor===String?document.getElementById(o):o},s=function(o){return o.srcElement||o.target},P=function(o,u,e,g){if(g){if(typeof o.path<"u"&&o.path.indexOf)return{path:o.path,end:o.path.indexOf(e)};var E={path:[],end:-1},G=function(R){E.path.push(R),R===e?E.end=E.path.length-1:R.parentNode!=null&&G(R.parentNode)};return G(u),E}else return{path:[u],end:1}},a=function(o,u){for(var e=0,g=o.length;e<g&&o[e]!=u;e++);e<o.length&&o.splice(e,1)},i=1,m=function(o,u,e){var g=i++;return o.__ta=o.__ta||{},o.__ta[u]=o.__ta[u]||{},o.__ta[u][g]=e,e.__tauid=g,g},b=function(o,u,e){if(o.__ta&&o.__ta[u]&&delete o.__ta[u][e.__tauid],e.__taExtra){for(var g=0;g<e.__taExtra.length;g++)X(o,e.__taExtra[g][0],e.__taExtra[g][1]);e.__taExtra.length=0}e.__taUnstore&&e.__taUnstore()},D=function(o,u,e,g){if(o==null)return e;var E=o.split(","),G=function(R){G.__tauid=e.__tauid;var K=s(R),q=K,Q=P(R,K,u,o!=null);if(Q.end!=-1)for(var ct=0;ct<Q.end;ct++){q=Q.path[ct];for(var at=0;at<E.length;at++)z(q,E[at],u)&&e.apply(q,arguments)}};return v(e,g,G),G},v=function(o,u,e){o.__taExtra=o.__taExtra||[],o.__taExtra.push([u,e])},c=function(o,u,e,g){if(y&&r[u]){var E=D(g,o,e,r[u]);O(o,r[u],E,e)}u==="focus"&&o.getAttribute("tabindex")==null&&o.setAttribute("tabindex","1"),O(o,u,D(g,o,e,u),e)},t=function(o,u,e,g){if(o.__taSmartClicks==null){var E=function(K){o.__tad=M(K)},G=function(K){o.__tau=M(K)},R=function(K){if(o.__tad&&o.__tau&&o.__tad[0]===o.__tau[0]&&o.__tad[1]===o.__tau[1])for(var q=0;q<o.__taSmartClicks.length;q++)o.__taSmartClicks[q].apply(s(K),[K])};c(o,"mousedown",E,g),c(o,"mouseup",G,g),c(o,"click",R,g),o.__taSmartClicks=[]}o.__taSmartClicks.push(e),e.__taUnstore=function(){a(o.__taSmartClicks,e)}},_={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},j=function(o,u){return function(e,g,E,G){if(g=="contextmenu"&&I)c(e,g,E,G);else{if(e.__taTapHandler==null){var R=e.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},K=function(at){for(var rt=s(at),lt=P(at,rt,e,G!=null),bt=!1,vt=0;vt<lt.end;vt++){if(bt)return;rt=lt.path[vt];for(var dt=0;dt<R.downSelectors.length;dt++)if(R.downSelectors[dt]==null||z(rt,R.downSelectors[dt],e)){R.down=!0,setTimeout(Q,o),setTimeout(ct,u),bt=!0;break}}},q=function(at){if(R.down){var rt=s(at),lt,bt;R.taps++;var vt=f(at);for(var dt in _)if(_.hasOwnProperty(dt)){var Et=_[dt];if(Et.touches===vt&&(Et.taps===1||Et.taps===R.taps))for(var yt=0;yt<R[dt].length;yt++){bt=P(at,rt,e,R[dt][yt][1]!=null);for(var et=0;et<bt.end;et++)if(lt=bt.path[et],R[dt][yt][1]==null||z(lt,R[dt][yt][1],e)){R[dt][yt][0].apply(lt,[at]);break}}}}},Q=function(){R.down=!1},ct=function(){R.taps=0};c(e,"mousedown",K),c(e,"mouseup",q)}e.__taTapHandler.downSelectors.push(G),e.__taTapHandler[g].push([E,G]),E.__taUnstore=function(){a(e.__taTapHandler[g],E)}}}},L=function(o,u,e,g){for(var E in e.__tamee[o])e.__tamee[o].hasOwnProperty(E)&&e.__tamee[o][E].apply(g,[u])},U=function(){var o=[];return function(u,e,g,E){if(!u.__tamee){u.__tamee={over:!1,mouseenter:[],mouseexit:[]};var G=function(K){var q=s(K);(E==null&&q==u&&!u.__tamee.over||z(q,E,u)&&(q.__tamee==null||!q.__tamee.over))&&(L("mouseenter",K,u,q),q.__tamee=q.__tamee||{},q.__tamee.over=!0,o.push(q))},R=function(K){for(var q=s(K),Q=0;Q<o.length;Q++)q==o[Q]&&!z(K.relatedTarget||K.toElement,"*",q)&&(q.__tamee.over=!1,o.splice(Q,1),L("mouseexit",K,u,q))};O(u,"mouseover",D(E,u,G,"mouseover"),G),O(u,"mouseout",D(E,u,R,"mouseout"),R)}g.__taUnstore=function(){delete u.__tamee[e][g.__tauid]},m(u,e,g),u.__tamee[e][g.__tauid]=g}},y="ontouchstart"in document.documentElement||navigator.maxTouchPoints,I="onmousedown"in document.documentElement,r={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},p=function(){var o=-1;if(navigator.appName=="Microsoft Internet Explorer"){var u=navigator.userAgent,e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");e.exec(u)!=null&&(o=parseFloat(RegExp.$1))}return o}(),d=p>-1&&p<9,w=function(o,u){if(o==null)return[0,0];var e=T(o),g=x(e,0);return[g[u+"X"],g[u+"Y"]]},M=function(o){return o==null?[0,0]:d?[o.clientX+document.documentElement.scrollLeft,o.clientY+document.documentElement.scrollTop]:w(o,"page")},h=function(o){return w(o,"screen")},k=function(o){return w(o,"client")},x=function(o,u){return o.item?o.item(u):o[u]},T=function(o){return o.touches&&o.touches.length>0?o.touches:o.changedTouches&&o.changedTouches.length>0?o.changedTouches:o.targetTouches&&o.targetTouches.length>0?o.targetTouches:[o]},f=function(o){return T(o).length},O=function(o,u,e,g){if(m(o,u,e),g.__tauid=e.__tauid,o.addEventListener)o.addEventListener(u,e,!1);else if(o.attachEvent){var E=u+e.__tauid;o["e"+E]=e,o[E]=function(){o["e"+E]&&o["e"+E](window.event)},o.attachEvent("on"+u,o[E])}},X=function(o,u,e){e!=null&&W(o,function(){var g=H(this);if(b(g,u,e),e.__tauid!=null){if(g.removeEventListener)g.removeEventListener(u,e,!1),y&&r[u]&&g.removeEventListener(r[u],e,!1);else if(this.detachEvent){var E=u+e.__tauid;g[E]&&g.detachEvent("on"+u,g[E]),g[E]=null,g["e"+E]=null}}e.__taTouchProxy&&X(o,e.__taTouchProxy[1],e.__taTouchProxy[0])})},W=function(o,u){if(o!=null){o=typeof Window<"u"&&typeof o.top!="unknown"&&o==o.top?[o]:typeof o!="string"&&o.tagName==null&&o.length!=null?o:typeof o=="string"?document.querySelectorAll(o):[o];for(var e=0;e<o.length;e++)u.apply(o[e])}},$=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var u=Math.random()*16|0,e=o=="x"?u:u&3|8;return e.toString(16)})};F.Mottle=function(o){o=o||{};var u=o.clickThreshold||250,e=o.dblClickThreshold||450,g=new U,E=new j(u,e),G=o.smartClicks,R=function(K,q,Q,ct){Q!=null&&W(K,function(){var at=H(this);G&&q==="click"?t(at,q,Q,ct):q==="tap"||q==="dbltap"||q==="contextmenu"?E(at,q,Q,ct):q==="mouseenter"||q=="mouseexit"?g(at,q,Q,ct):c(at,q,Q,ct)})};this.remove=function(K){return W(K,function(){var q=H(this);if(q.__ta){for(var Q in q.__ta)if(q.__ta.hasOwnProperty(Q))for(var ct in q.__ta[Q])q.__ta[Q].hasOwnProperty(ct)&&X(q,Q,q.__ta[Q][ct])}q.parentNode&&q.parentNode.removeChild(q)}),this},this.on=function(K,q,Q,ct){var at=arguments[0],rt=arguments.length==4?arguments[2]:null,lt=arguments[1],bt=arguments[arguments.length-1];return R(at,lt,bt,rt),this},this.off=function(K,q,Q){return X(K,q,Q),this},this.trigger=function(K,q,Q,ct){var at=I&&(typeof MouseEvent>"u"||Q==null||Q.constructor===MouseEvent),rt=y&&!I&&r[q]?r[q]:q,lt=!(y&&!I&&r[q]),bt=M(Q),vt=h(Q),dt=k(Q);return W(K,function(){var Et=H(this),yt;Q=Q||{screenX:vt[0],screenY:vt[1],clientX:dt[0],clientY:dt[1]};var et=function(Pt){ct&&(Pt.payload=ct)},tt={TouchEvent:function(Pt){var Ot=C(window,Et,0,bt[0],bt[1],vt[0],vt[1],dt[0],dt[1]),Bt=Pt.initTouchEvent||Pt.initEvent;Bt(rt,!0,!0,window,null,vt[0],vt[1],dt[0],dt[1],!1,!1,!1,!1,Ot,Ot,Ot,1,0)},MouseEvents:function(Pt){Pt.initMouseEvent(rt,!0,!0,window,0,vt[0],vt[1],dt[0],dt[1],!1,!1,!1,!1,1,Et)}};if(document.createEvent){var it=!lt&&!at&&y&&r[q],ht=it?"TouchEvent":"MouseEvents";yt=document.createEvent(ht),tt[ht](yt),et(yt),Et.dispatchEvent(yt)}else document.createEventObject&&(yt=document.createEventObject(),yt.eventType=yt.eventName=rt,yt.screenX=vt[0],yt.screenY=vt[1],yt.clientX=dt[0],yt.clientY=dt[1],et(yt),Et.fireEvent("on"+rt,yt))}),this}},F.Mottle.consume=function(o,u){o.stopPropagation?o.stopPropagation():o.returnValue=!1,!u&&o.preventDefault&&o.preventDefault()},F.Mottle.pageLocation=M,F.Mottle.setForceTouchEvents=function(o){y=o},F.Mottle.setForceMouseEvents=function(o){I=o},F.Mottle.version="0.8.0",B.Mottle=F.Mottle}.call(typeof window>"u"?Rt:window),function(){var A=this,n=function(o,u,e){return o.indexOf(u)===-1?(e?o.unshift(u):o.push(u),!0):!1},C=function(o,u){var e=o.indexOf(u);e!==-1&&o.splice(e,1)},F=function(o,u){for(var e=[],g=0;g<o.length;g++)u.indexOf(o[g])===-1&&e.push(o[g]);return e},z=function(o){return o==null?!1:typeof o=="string"||o.constructor===String},H=function(o){var u=o.getBoundingClientRect(),e=document.body,g=document.documentElement,E=window.pageYOffset||g.scrollTop||e.scrollTop,G=window.pageXOffset||g.scrollLeft||e.scrollLeft,R=g.clientTop||e.clientTop||0,K=g.clientLeft||e.clientLeft||0,q=u.top+E-R,Q=u.left+G-K;return{top:Math.round(q),left:Math.round(Q)}},s=function(o,u,e){e=e||o.parentNode;for(var g=e.querySelectorAll(u),E=0;E<g.length;E++)if(g[E]===o)return!0;return!1},P=function(o,u,e){if(s(u,e,o))return u;for(var g=u.parentNode;g!=null&&g!==o;){if(s(g,e,o))return g;g=g.parentNode}},a=function(o,u,e){for(var g=null,E=u.getAttribute("katavorio-draggable"),G=E!=null?"[katavorio-draggable='"+E+"'] ":"",R=0;R<o.length;R++)if(g=P(u,e,G+o[R].selector),g!=null){if(o[R].filter){var K=s(e,o[R].filter,g),q=o[R].filterExclude===!0;if(q&&!K||K)return null}return[o[R],g]}return null},i=function(){var o=-1;if(navigator.appName==="Microsoft Internet Explorer"){var u=navigator.userAgent,e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");e.exec(u)!=null&&(o=parseFloat(RegExp.$1))}return o}(),m=10,b=10,D=i>-1&&i<9,v=i===9,c=function(o){if(D)return[o.clientX+document.documentElement.scrollLeft,o.clientY+document.documentElement.scrollTop];var u=_(o),e=t(u,0);return v?[e.pageX||e.clientX,e.pageY||e.clientY]:[e.pageX,e.pageY]},t=function(o,u){return o.item?o.item(u):o[u]},_=function(o){return o.touches&&o.touches.length>0?o.touches:o.changedTouches&&o.changedTouches.length>0?o.changedTouches:o.targetTouches&&o.targetTouches.length>0?o.targetTouches:[o]},j={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},L="katavorio-drag-scope",U=["stop","start","drag","drop","over","out","beforeStart"],y=function(){},I=function(){return!0},r=function(o,u,e){for(var g=0;g<o.length;g++)o[g]!=e&&u(o[g])},p=function(o,u,e,g){r(o,function(E){E.setActive(u),u&&E.updatePosition(),e&&E.setHover(g,u)})},d=function(o,u){if(o!=null){o=!z(o)&&o.tagName==null&&o.length!=null?o:[o];for(var e=0;e<o.length;e++)u.apply(o[e],[o[e]])}},w=function(o){o.stopPropagation?(o.stopPropagation(),o.preventDefault()):o.returnValue=!1},M="input,textarea,select,button,option",h=function(o,u,e){var g=o.srcElement||o.target;return!s(g,e.getInputFilterSelector(),u)},k=function(o,u,e,g){this.params=u||{},this.el=o,this.params.addClass(this.el,this._class),this.uuid=X();var E=!0;return this.setEnabled=function(G){E=G},this.isEnabled=function(){return E},this.toggleEnabled=function(){E=!E},this.setScope=function(G){this.scopes=G?G.split(/\s+/):[g]},this.addScope=function(G){var R={};d(this.scopes,function(q){R[q]=!0}),d(G?G.split(/\s+/):[],function(q){R[q]=!0}),this.scopes=[];for(var K in R)this.scopes.push(K)},this.removeScope=function(G){var R={};d(this.scopes,function(q){R[q]=!0}),d(G?G.split(/\s+/):[],function(q){delete R[q]}),this.scopes=[];for(var K in R)this.scopes.push(K)},this.toggleScope=function(G){var R={};d(this.scopes,function(q){R[q]=!0}),d(G?G.split(/\s+/):[],function(q){R[q]?delete R[q]:R[q]=!0}),this.scopes=[];for(var K in R)this.scopes.push(K)},this.setScope(u.scope),this.k=u.katavorio,u.katavorio},x=function(){return!0},T=function(){return!1},f=function(o,u,e,g){this._class=e.draggable;var E=k.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var G=[0,0],R=null,K=null,q=[0,0],Q=!1,ct=[0,0],at=this.params.consumeStartEvent!==!1,rt=this.el,lt=this.params.clone;this.params.scroll;var bt=u.multipleDrop!==!1,vt=!1,dt,Et,yt=null,et=[],tt=null,it=u.ghostProxyParent,ht,Pt,Ot,Bt;if(u.ghostProxy===!0?dt=x:u.ghostProxy&&typeof u.ghostProxy=="function"?dt=u.ghostProxy:dt=function(ot,jt){return tt&&tt.useGhostProxy?tt.useGhostProxy(ot,jt):!1},u.makeGhostProxy?Et=u.makeGhostProxy:Et=function(ot){return tt&&tt.makeGhostProxy?tt.makeGhostProxy(ot):ot.cloneNode(!0)},u.selector){var Kt=o.getAttribute("katavorio-draggable");Kt==null&&(Kt=""+new Date().getTime(),o.setAttribute("katavorio-draggable",Kt)),et.push(u)}var ae=u.snapThreshold,te=function(ot,jt,Dt,St,At){var Ft=Math.floor(ot[0]/jt),l=jt*Ft,V=l+jt,S=Math.abs(ot[0]-l)<=St?l:Math.abs(V-ot[0])<=St?V:ot[0],N=Math.floor(ot[1]/Dt),Y=Dt*N,J=Y+Dt,st=Math.abs(ot[1]-Y)<=At?Y:Math.abs(J-ot[1])<=At?J:ot[1];return[S,st]};this.posses=[],this.posseRoles={},this.toGrid=function(ot){if(this.params.grid==null)return ot;var jt=this.params.grid?this.params.grid[0]/2:ae||m/2,Dt=this.params.grid?this.params.grid[1]/2:ae||b/2;return te(ot,this.params.grid[0],this.params.grid[1],jt,Dt)},this.snap=function(ot,jt){if(rt!=null){ot=ot||(this.params.grid?this.params.grid[0]:m),jt=jt||(this.params.grid?this.params.grid[1]:b);var Dt=this.params.getPosition(rt),St=this.params.grid?this.params.grid[0]/2:ae,At=this.params.grid?this.params.grid[1]/2:ae,Ft=te(Dt,ot,jt,St,At);return this.params.setPosition(rt,Ft),Ft}},this.setUseGhostProxy=function(ot){dt=ot?x:T};var ee,je=function(ot){return u.allowNegative===!1?[Math.max(0,ot[0]),Math.max(0,ot[1])]:ot},De=function(ot){ee=typeof ot=="function"?ot:ot?function(jt,Dt,St,At){return je([Math.max(0,Math.min(St.w-At[0],jt[0])),Math.max(0,Math.min(St.h-At[1],jt[1]))])}.bind(this):function(jt){return je(jt)}}.bind(this);De(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(ot){De(ot)};var we=function(ot,jt,Dt,St){return tt!=null&&tt.constrain&&typeof tt.constrain=="function"?tt.constrain(ot,jt,Dt,St):ee(ot,jt,Dt,St)},ne;this.setRevert=function(ot){ne=ot},this.params.revert&&(ne=this.params.revert);var me=function(ot){return typeof ot=="function"?(ot._katavorioId=X(),ot._katavorioId):ot},ie={},ge=function(ot){for(var jt in ie){var Dt=ie[jt],St=Dt[0](ot);if(Dt[1]&&(St=!St),!St)return!1}return!0},ye=this.setFilter=function(ot,jt){if(ot){var Dt=me(ot);ie[Dt]=[function(St){var At=St.srcElement||St.target,Ft;return z(ot)?Ft=s(At,ot,o):typeof ot=="function"&&(Ft=ot(St,o)),Ft},jt!==!1]}};this.addFilter=ye,this.removeFilter=function(ot){var jt=typeof ot=="function"?ot._katavorioId:ot;delete ie[jt]},this.clearAllFilters=function(){ie={}},this.canDrag=this.params.canDrag||I;var Pe,Ut=[],oe=[];this.addSelector=function(ot){ot.selector&&et.push(ot)},this.downListener=function(ot){if(!ot.defaultPrevented){var jt=this.rightButtonCanDrag||ot.which!==3&&ot.button!==2;if(jt&&this.isEnabled()&&this.canDrag()){var Dt=ge(ot)&&h(ot,this.el,this.k);if(Dt){if(tt=null,yt=null,et.length>0){var St=a(et,this.el,ot.target||ot.srcElement);if(St!=null&&(tt=St[0],yt=St[1]),yt==null)return}else yt=this.el;if(lt)if(rt=yt.cloneNode(!0),this.params.addClass(rt,j.clonedDrag),rt.setAttribute("id",null),rt.style.position="absolute",this.params.parent!=null){var At=this.params.getPosition(this.el);rt.style.left=At[0]+"px",rt.style.top=At[1]+"px",this.params.parent.appendChild(rt)}else{var Ft=H(yt);rt.style.left=Ft.left+"px",rt.style.top=Ft.top+"px",document.body.appendChild(rt)}else rt=yt;at&&w(ot),G=c(ot),rt&&rt.parentNode&&(ct=[rt.parentNode.scrollLeft,rt.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),E.markSelection(this),E.markPosses(this),this.params.addClass(document.body,e.noSelect),se("beforeStart",{el:this.el,pos:R,e:ot,drag:this})}else this.params.consumeFilteredEvents&&w(ot)}}}.bind(this),this.moveListener=function(ot){if(G){if(!Q){var jt=se("start",{el:this.el,pos:R,e:ot,drag:this});if(jt!==!1){if(!G)return;this.mark(!0),Q=!0}else this.abort()}if(G){oe.length=0;var Dt=c(ot),St=Dt[0]-G[0],At=Dt[1]-G[1],Ft=this.params.ignoreZoom?1:E.getZoom();rt&&rt.parentNode&&(St+=rt.parentNode.scrollLeft-ct[0],At+=rt.parentNode.scrollTop-ct[1]),St/=Ft,At/=Ft,this.moveBy(St,At,ot),E.updateSelection(St,At,this),E.updatePosses(St,At,this)}}}.bind(this),this.upListener=function(ot){G&&(G=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,e.noSelect),this.unmark(ot),E.unmarkSelection(this,ot),E.unmarkPosses(this,ot),this.stop(ot),E.notifyPosseDragStop(this,ot),Q=!1,oe.length=0,lt?(rt&&rt.parentNode&&rt.parentNode.removeChild(rt),rt=null):ne&&ne(rt,this.params.getPosition(rt))===!0&&(this.params.setPosition(rt,R),se("revert",rt)))}.bind(this),this.getFilters=function(){return ie},this.abort=function(){G!=null&&this.upListener()},this.getDragElement=function(ot){return ot?yt||this.el:rt||this.el};var qt={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};u.events.start&&qt.start.push(u.events.start),u.events.beforeStart&&qt.beforeStart.push(u.events.beforeStart),u.events.stop&&qt.stop.push(u.events.stop),u.events.drag&&qt.drag.push(u.events.drag),u.events.revert&&qt.revert.push(u.events.revert),this.on=function(ot,jt){qt[ot]&&qt[ot].push(jt)},this.off=function(ot,jt){if(qt[ot]){for(var Dt=[],St=0;St<qt[ot].length;St++)qt[ot][St]!==jt&&Dt.push(qt[ot][St]);qt[ot]=Dt}};var se=function(ot,jt){var Dt=null;if(tt&&tt[ot])Dt=tt[ot](jt);else if(qt[ot])for(var St=0;St<qt[ot].length;St++)try{var At=qt[ot][St](jt);At!=null&&(Dt=At)}catch{}return Dt};this.notifyStart=function(ot){se("start",{el:this.el,pos:this.params.getPosition(rt),e:ot,drag:this})},this.stop=function(ot,jt){if(jt||Q){var Dt=[],St=E.getSelection(),At=this.params.getPosition(rt);if(St.length>0)for(var Ft=0;Ft<St.length;Ft++){var l=this.params.getPosition(St[Ft].el);Dt.push([St[Ft].el,{left:l[0],top:l[1]},St[Ft]])}else Dt.push([rt,{left:At[0],top:At[1]},this]);se("stop",{el:rt,pos:ce||At,finalPos:At,e:ot,drag:this,selection:Dt})}},this.mark=function(ot){R=this.params.getPosition(rt),K=this.params.getPosition(rt,!0),q=[K[0]-R[0],K[1]-R[1]],this.size=this.params.getSize(rt),Ut=E.getMatchingDroppables(this),p(Ut,!0,!1,this),this.params.addClass(rt,this.params.dragClass||e.drag);var jt;this.params.getConstrainingRectangle?jt=this.params.getConstrainingRectangle(rt):jt=this.params.getSize(rt.parentNode),Pe={w:jt[0],h:jt[1]},Ot=0,Bt=0,ot&&E.notifySelectionDragStart(this)};var ce;this.unmark=function(ot,jt){if(p(Ut,!1,!0,this),vt&&dt(yt,rt)?(ce=[rt.offsetLeft-Ot,rt.offsetTop-Bt],rt.parentNode.removeChild(rt),rt=yt):ce=null,this.params.removeClass(rt,this.params.dragClass||e.drag),Ut.length=0,vt=!1,!jt){oe.length>0&&ce&&u.setPosition(yt,ce),oe.sort(W);for(var Dt=0;Dt<oe.length;Dt++){var St=oe[Dt].drop(this,ot);if(St===!0)break}}},this.moveBy=function(ot,jt,Dt){oe.length=0;var St=this.toGrid([R[0]+ot,R[1]+jt]),At=we(St,rt,Pe,this.size);if(dt(this.el,rt))if(St[0]!==At[0]||St[1]!==At[1]){if(!vt){var Ft=Et(yt);u.addClass(Ft,j.ghostProxy),it?(it.appendChild(Ft),ht=u.getPosition(yt.parentNode,!0),Pt=u.getPosition(u.ghostProxyParent,!0),Ot=ht[0]-Pt[0],Bt=ht[1]-Pt[1]):yt.parentNode.appendChild(Ft),rt=Ft,vt=!0}At=St}else vt&&(rt.parentNode.removeChild(rt),rt=yt,vt=!1,ht=null,Pt=null,Ot=0,Bt=0);var l={x:At[0],y:At[1],w:this.size[0],h:this.size[1]},V={x:l.x+q[0],y:l.y+q[1],w:l.w,h:l.h},S=null;this.params.setPosition(rt,[At[0]+Ot,At[1]+Bt]);for(var N=0;N<Ut.length;N++){var Y={x:Ut[N].pagePosition[0],y:Ut[N].pagePosition[1],w:Ut[N].size[0],h:Ut[N].size[1]};this.params.intersects(V,Y)&&(bt||S==null||S===Ut[N].el)&&Ut[N].canDrop(this)?(S||(S=Ut[N].el),oe.push(Ut[N]),Ut[N].setHover(this,!0,Dt)):Ut[N].isHover()&&Ut[N].setHover(this,!1,Dt)}se("drag",{el:this.el,pos:At,e:Dt,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?ye(this.params.handle,!1):ye(this.params.filter,this.params.filterExclude)},O=function(o,u,e,g){this._class=e.droppable,this.params=u||{},this.rank=u.rank||0,this._activeClass=this.params.activeClass||e.active,this._hoverClass=this.params.hoverClass||e.hover,k.apply(this,arguments);var E=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(G){this.params[G?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(G){return!0},this.isHover=function(){return E},this.setHover=function(G,R,K){(R||this.el._katavorioDragHover==null||this.el._katavorioDragHover===G.el._katavorio)&&(this.params[R?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=R?G.el._katavorio:null,E!==R&&this.params.events[R?"over":"out"]({el:this.el,e:K,drag:G,drop:this}),E=R)},this.drop=function(G,R){return this.params.events.drop({drag:G,e:R,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,E=null}},X=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var u=Math.random()*16|0,e=o==="x"?u:u&3|8;return e.toString(16)})},W=function(o,u){return o.rank<u.rank?1:o.rank>u.rank?-1:0},$=function(o){return o==null||(o=typeof o=="string"||o.constructor===String?document.getElementById(o):o,o==null)?null:(o._katavorio=o._katavorio||X(),o)};A.Katavorio=function(o){var u=[],e={};this._dragsByScope={},this._dropsByScope={};var g=1,E=function(et,tt){d(et,function(it){for(var ht=0;ht<it.scopes.length;ht++)tt[it.scopes[ht]]=tt[it.scopes[ht]]||[],tt[it.scopes[ht]].push(it)})},G=function(et,tt){var it=0;return d(et,function(ht){for(var Pt=0;Pt<ht.scopes.length;Pt++)if(tt[ht.scopes[Pt]]){var Ot=o.indexOf(tt[ht.scopes[Pt]],ht);Ot!==-1&&(tt[ht.scopes[Pt]].splice(Ot,1),it++)}}),it>0};this.getMatchingDroppables=function(et){for(var tt=[],it={},ht=0;ht<et.scopes.length;ht++){var Pt=this._dropsByScope[et.scopes[ht]];if(Pt)for(var Ot=0;Ot<Pt.length;Ot++)Pt[Ot].canDrop(et)&&!it[Pt[Ot].uuid]&&(Pt[Ot].allowLoopback||Pt[Ot].el!==et.el)&&(it[Pt[Ot].uuid]=!0,tt.push(Pt[Ot]))}return tt.sort(W),tt};var R=function(et){et=et||{};var tt={events:{}},it;for(it in o)tt[it]=o[it];for(it in et)tt[it]=et[it];for(it=0;it<U.length;it++)tt.events[U[it]]=et[U[it]]||y;return tt.katavorio=this,tt}.bind(this),K=function(et,tt){for(var it=0;it<U.length;it++)tt[U[it]]&&et.on(U[it],tt[U[it]])}.bind(this),q={},Q=o.css||{},ct=o.scope||L;for(var at in j)q[at]=j[at];for(var at in Q)q[at]=Q[at];var rt=o.inputFilterSelector||M;this.getInputFilterSelector=function(){return rt},this.setInputFilterSelector=function(et){return rt=et,this},this.draggable=function(et,tt){var it=[];return d(et,function(ht){if(ht=$(ht),ht!=null)if(ht._katavorioDrag==null){var Pt=R(tt);ht._katavorioDrag=new f(ht,Pt,q,ct),E(ht._katavorioDrag,this._dragsByScope),it.push(ht._katavorioDrag),o.addClass(ht,Pt.selector?q.delegatedDraggable:q.draggable)}else K(ht._katavorioDrag,tt)}.bind(this)),it},this.droppable=function(et,tt){var it=[];return d(et,function(ht){if(ht=$(ht),ht!=null){var Pt=new O(ht,R(tt),q,ct);ht._katavorioDrop=ht._katavorioDrop||[],ht._katavorioDrop.push(Pt),E(Pt,this._dropsByScope),it.push(Pt),o.addClass(ht,q.droppable)}}.bind(this)),it},this.select=function(et){return d(et,function(){var tt=$(this);tt&&tt._katavorioDrag&&(e[tt._katavorio]||(u.push(tt._katavorioDrag),e[tt._katavorio]=[tt,u.length-1],o.addClass(tt,q.selected)))}),this},this.deselect=function(et){return d(et,function(){var tt=$(this);if(tt&&tt._katavorio){var it=e[tt._katavorio];if(it){for(var ht=[],Pt=0;Pt<u.length;Pt++)u[Pt].el!==tt&&ht.push(u[Pt]);u=ht,delete e[tt._katavorio],o.removeClass(tt,q.selected)}}}),this},this.deselectAll=function(){for(var et in e){var tt=e[et];o.removeClass(tt[0],q.selected)}u.length=0,e={}},this.markSelection=function(et){r(u,function(tt){tt.mark()},et)},this.markPosses=function(et){et.posses&&d(et.posses,function(tt){et.posseRoles[tt]&&Et[tt]&&r(Et[tt].members,function(it){it.mark()},et)})},this.unmarkSelection=function(et,tt){r(u,function(it){it.unmark(tt)},et)},this.unmarkPosses=function(et,tt){et.posses&&d(et.posses,function(it){et.posseRoles[it]&&Et[it]&&r(Et[it].members,function(ht){ht.unmark(tt,!0)},et)})},this.getSelection=function(){return u.slice(0)},this.updateSelection=function(et,tt,it){r(u,function(ht){ht.moveBy(et,tt)},it)};var lt=function(et,tt){tt.posses&&d(tt.posses,function(it){tt.posseRoles[it]&&Et[it]&&r(Et[it].members,function(ht){et(ht)},tt)})};this.updatePosses=function(et,tt,it){lt(function(ht){ht.moveBy(et,tt)},it)},this.notifyPosseDragStop=function(et,tt){lt(function(it){it.stop(tt,!0)},et)},this.notifySelectionDragStop=function(et,tt){r(u,function(it){it.stop(tt,!0)},et)},this.notifySelectionDragStart=function(et,tt){r(u,function(it){it.notifyStart(tt)},et)},this.setZoom=function(et){g=et},this.getZoom=function(){return g};var bt=function(et,tt,it,ht){d(et,function(Pt){G(Pt,it),Pt[ht](tt),E(Pt,it)})};d(["set","add","remove","toggle"],function(et){this[et+"Scope"]=function(tt,it){bt(tt._katavorioDrag,it,this._dragsByScope,et+"Scope"),bt(tt._katavorioDrop,it,this._dropsByScope,et+"Scope")}.bind(this),this[et+"DragScope"]=function(tt,it){bt(tt.constructor===f?tt:tt._katavorioDrag,it,this._dragsByScope,et+"Scope")}.bind(this),this[et+"DropScope"]=function(tt,it){bt(tt.constructor===O?tt:tt._katavorioDrop,it,this._dropsByScope,et+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(et,tt){for(var it in this._dragsByScope)r(this._dragsByScope[it],function(ht){ht.snap(et,tt)})},this.getDragsForScope=function(et){return this._dragsByScope[et]},this.getDropsForScope=function(et){return this._dropsByScope[et]};var vt=function(et,tt,it){if(et=$(et),et[tt]){var ht=u.indexOf(et[tt]);ht>=0&&u.splice(ht,1),G(et[tt],it)&&d(et[tt],function(Pt){Pt.destroy()}),delete et[tt]}},dt=function(et,tt,it,ht){et=$(et),et[tt]&&et[tt].off(it,ht)};this.elementRemoved=function(et){et._katavorioDrag&&this.destroyDraggable(et),et._katavorioDrop&&this.destroyDroppable(et)},this.destroyDraggable=function(et,tt,it){arguments.length===1?vt(et,"_katavorioDrag",this._dragsByScope):dt(et,"_katavorioDrag",tt,it)},this.destroyDroppable=function(et,tt,it){arguments.length===1?vt(et,"_katavorioDrop",this._dropsByScope):dt(et,"_katavorioDrop",tt,it)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},u=[],e={},Et={}};var Et={},yt=function(et,tt,it){var ht=z(tt)?tt:tt.id,Pt=z(tt)?!0:tt.active!==!1,Ot=Et[ht]||function(){var Bt={name:ht,members:[]};return Et[ht]=Bt,Bt}();return d(et,function(Bt){if(Bt._katavorioDrag){if(it&&Bt._katavorioDrag.posseRoles[Ot.name]!=null)return;n(Ot.members,Bt._katavorioDrag),n(Bt._katavorioDrag.posses,Ot.name),Bt._katavorioDrag.posseRoles[Ot.name]=Pt}}),Ot};this.addToPosse=function(et,tt){for(var it=[],ht=1;ht<arguments.length;ht++)it.push(yt(et,arguments[ht]));return it.length===1?it[0]:it},this.setPosse=function(et,tt){for(var it=[],ht=1;ht<arguments.length;ht++)it.push(yt(et,arguments[ht],!0).name);return d(et,function(Pt){if(Pt._katavorioDrag){var Ot=F(Pt._katavorioDrag.posses,it),Bt=[];Array.prototype.push.apply(Bt,Pt._katavorioDrag.posses);for(var Kt=0;Kt<Ot.length;Kt++)this.removeFromPosse(Pt,Ot[Kt])}}.bind(this)),it.length===1?it[0]:it},this.removeFromPosse=function(et,tt){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var it=1;it<arguments.length;it++)tt=arguments[it],d(et,function(ht){if(ht._katavorioDrag&&ht._katavorioDrag.posses){var Pt=ht._katavorioDrag;d(tt,function(Ot){C(Et[Ot].members,Pt),C(Pt.posses,Ot),delete Pt.posseRoles[Ot]})}})},this.removeFromAllPosses=function(et){d(et,function(tt){if(tt._katavorioDrag&&tt._katavorioDrag.posses){var it=tt._katavorioDrag;d(it.posses,function(ht){C(Et[ht].members,it)}),it.posses.length=0,it.posseRoles={}}})},this.setPosseState=function(et,tt,it){var ht=Et[tt];ht&&d(et,function(Pt){Pt._katavorioDrag&&Pt._katavorioDrag.posses&&(Pt._katavorioDrag.posseRoles[ht.name]=it)})}},A.Katavorio.version="1.0.0",B.Katavorio=A.Katavorio}.call(typeof window<"u"?window:Rt),function(){var A=this;A.jsPlumbUtil=A.jsPlumbUtil||{};var n=A.jsPlumbUtil;B.jsPlumbUtil=n;function C(o){return Object.prototype.toString.call(o)==="[object Array]"}n.isArray=C;function F(o){return Object.prototype.toString.call(o)==="[object Number]"}n.isNumber=F;function z(o){return typeof o=="string"}n.isString=z;function H(o){return typeof o=="boolean"}n.isBoolean=H;function s(o){return o==null}n.isNull=s;function P(o){return o==null?!1:Object.prototype.toString.call(o)==="[object Object]"}n.isObject=P;function a(o){return Object.prototype.toString.call(o)==="[object Date]"}n.isDate=a;function i(o){return Object.prototype.toString.call(o)==="[object Function]"}n.isFunction=i;function m(o){return i(o)&&o.name!=null&&o.name.length>0}n.isNamedFunction=m;function b(o){for(var u in o)if(o.hasOwnProperty(u))return!1;return!0}n.isEmpty=b;function D(o){if(z(o))return""+o;if(H(o))return!!o;if(a(o))return new Date(o.getTime());if(i(o))return o;if(C(o)){for(var u=[],e=0;e<o.length;e++)u.push(D(o[e]));return u}else if(P(o)){var g={};for(var E in o)g[E]=D(o[E]);return g}else return o}n.clone=D;function v(o,u,e,g){var E={},G,R,K={};for(e=e||[],g=g||[],R=0;R<e.length;R++)E[e[R]]=!0;for(R=0;R<g.length;R++)K[g[R]]=!0;var q=D(o);for(R in u)if(q[R]==null||K[R])q[R]=u[R];else if(z(u[R])||H(u[R]))E[R]?(G=[],G.push.apply(G,C(q[R])?q[R]:[q[R]]),G.push.apply(G,H(u[R])?u[R]:[u[R]]),q[R]=G):q[R]=u[R];else if(C(u[R]))G=[],C(q[R])&&G.push.apply(G,q[R]),G.push.apply(G,u[R]),q[R]=G;else if(P(u[R])){P(q[R])||(q[R]={});for(var Q in u[R])q[R][Q]=u[R][Q]}return q}n.merge=v;function c(o,u,e){if(o!=null){var g=o,E=g;return u.replace(/([^\.])+/g,function(G,R,K,q){var Q=G.match(/([^\[0-9]+){1}(\[)([0-9+])/),ct=K+G.length>=q.length,at=function(){return E[Q[1]]||function(){return E[Q[1]]=[],E[Q[1]]}()};if(ct)Q?at()[Q[3]]=e:E[G]=e;else if(Q){var rt=at();E=rt[Q[3]]||function(){return rt[Q[3]]={},rt[Q[3]]}()}else E=E[G]||function(){return E[G]={},E[G]}();return""}),o}}n.replace=c;function t(o,u,e){for(var g=0;g<e.length;g++){var E=e[g][0][e[g][1]].apply(e[g][0],e[g][2]);if(E===u)return E}return o}n.functionChain=t;function _(o,u,e,g){var E=function(R){var K=R.match(/(\${.*?})/g);if(K!=null)for(var q=0;q<K.length;q++){var Q=u[K[q].substring(2,K[q].length-1)]||"";Q!=null&&(R=R.replace(K[q],Q))}return R},G=function(R){if(R!=null){if(z(R))return E(R);if(i(R)&&!g&&(e==null||(R.name||"").indexOf(e)===0))return R(u);if(C(R)){for(var K=[],q=0;q<R.length;q++)K.push(G(R[q]));return K}else if(P(R)){var Q={};for(var ct in R)Q[ct]=G(R[ct]);return Q}else return R}};return G(o)}n.populate=_;function j(o,u){if(o){for(var e=0;e<o.length;e++)if(u(o[e]))return e}return-1}n.findWithFunction=j;function L(o,u){var e=j(o,u);return e>-1&&o.splice(e,1),e!==-1}n.removeWithFunction=L;function U(o,u){var e=o.indexOf(u);return e>-1&&o.splice(e,1),e!==-1}n.remove=U;function y(o,u,e){j(o,e)===-1&&o.push(u)}n.addWithFunction=y;function I(o,u,e,g){var E=o[u];return E==null&&(E=[],o[u]=E),E[g?"unshift":"push"](e),E}n.addToList=I;function r(o,u,e){return o.indexOf(u)===-1?(e?o.unshift(u):o.push(u),!0):!1}n.suggest=r;function p(o,u,e){var g;u=C(u)?u:[u];var E=function(q){for(var Q=q.__proto__;Q!=null;)if(Q.prototype!=null){for(var ct in Q.prototype)Q.prototype.hasOwnProperty(ct)&&!o.prototype.hasOwnProperty(ct)&&(o.prototype[ct]=Q.prototype[ct]);Q=Q.prototype.__proto__}else Q=null};for(g=0;g<u.length;g++){for(var G in u[g].prototype)u[g].prototype.hasOwnProperty(G)&&!o.prototype.hasOwnProperty(G)&&(o.prototype[G]=u[g].prototype[G]);E(u[g])}var R=function(q,Q){return function(){for(g=0;g<u.length;g++)u[g].prototype[q]&&u[g].prototype[q].apply(this,arguments);return Q.apply(this,arguments)}},K=function(q){for(var Q in q)o.prototype[Q]=R(Q,q[Q])};if(arguments.length>2)for(g=2;g<arguments.length;g++)K(arguments[g]);return o}n.extend=p;for(var d=[],w=0;w<256;w++)d[w]=(w<16?"0":"")+w.toString(16);function M(){var o=Math.random()*4294967295|0,u=Math.random()*4294967295|0,e=Math.random()*4294967295|0,g=Math.random()*4294967295|0;return d[o&255]+d[o>>8&255]+d[o>>16&255]+d[o>>24&255]+"-"+d[u&255]+d[u>>8&255]+"-"+d[u>>16&15|64]+d[u>>24&255]+"-"+d[e&63|128]+d[e>>8&255]+"-"+d[e>>16&255]+d[e>>24&255]+d[g&255]+d[g>>8&255]+d[g>>16&255]+d[g>>24&255]}n.uuid=M;function h(o){if(o==null)return null;for(var u=o.replace(/^\s\s*/,""),e=/\s/,g=u.length;e.test(u.charAt(--g)););return u.slice(0,g+1)}n.fastTrim=h;function k(o,u){o=o.length==null||typeof o=="string"?[o]:o;for(var e=0;e<o.length;e++)u(o[e])}n.each=k;function x(o,u){for(var e=[],g=0;g<o.length;g++)e.push(u(o[g]));return e}n.map=x;function T(o,u,e){e=e||"parent";var g=function(q){return q?u[q]:null},E=function(q){return q?g(q[e]):null},G=function(q,Q){if(q==null)return Q;var ct=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];Q.mergeStrategy==="override"&&Array.prototype.push.apply(ct,["events","overlays"]);var at=v(q,Q,[],ct);return G(E(q),at)},R=function(q){if(q==null)return{};if(typeof q=="string")return g(q);if(q.length){for(var Q=!1,ct=0,at=void 0;!Q&&ct<q.length;)at=R(q[ct]),at?Q=!0:ct++;return at}},K=R(o);return K?G(E(K),K):{}}n.mergeWithParents=T,n.logEnabled=!0;function f(){if(n.logEnabled&&typeof console<"u")try{var o=arguments[arguments.length-1];console.log(o)}catch{}}n.log=f;function O(o,u,e){return function(){var g=null;try{u!=null&&(g=u.apply(this,arguments))}catch(E){f("jsPlumb function failed : "+E)}if(o!=null&&(e==null||g!==e))try{g=o.apply(this,arguments)}catch(E){f("wrapped function failed : "+E)}return g}}n.wrap=O;var X=function(){function o(){var u=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(e,g,E){var G=function(K){I(u._listeners,K,g,E),g.__jsPlumb=g.__jsPlumb||{},g.__jsPlumb[M()]=K};if(typeof e=="string")G(e);else if(e.length!=null)for(var R=0;R<e.length;R++)G(e[R]);return u},this.fire=function(e,g,E){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[e]){var G=this._listeners[e].length,R=0,K=!1,q=null;if(!this.shouldFireEvent||this.shouldFireEvent(e,g,E))for(;!K&&R<G&&q!==!1;){if(this.eventsToDieOn[e])this._listeners[e][R].apply(this,[g,E]);else try{q=this._listeners[e][R].apply(this,[g,E])}catch(Q){f("jsPlumb: fire failed for event "+e+" : "+Q)}R++,(this._listeners==null||this._listeners[e]==null)&&(K=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var e=u.queue.pop();e&&u.fire.apply(u,e)},this.unbind=function(e,g){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof e=="string")delete this._listeners[e];else if(e.__jsPlumb){var E=void 0;for(var G in e.__jsPlumb)E=e.__jsPlumb[G],U(this._listeners[E]||[],e)}}else arguments.length===2&&U(this._listeners[e]||[],g);return this},this.getListener=function(e){return u._listeners[e]},this.setSuspendEvents=function(e){u.eventsSuspended=e},this.isSuspendEvents=function(){return u.eventsSuspended},this.silently=function(e){u.setSuspendEvents(!0);try{e()}catch(g){f("Cannot execute silent function "+g)}u.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var e in u._listeners)u._listeners[e]=null}}return o}();n.EventGenerator=X;function W(o,u,e){var g=[o[0]-u[0],o[1]-u[1]],E=Math.cos(e/360*Math.PI*2),G=Math.sin(e/360*Math.PI*2);return[g[0]*E-g[1]*G+u[0],g[1]*E+g[0]*G+u[1],E,G]}n.rotatePoint=W;function $(o,u){var e=W(o,[0,0],u);return[Math.round(e[0]),Math.round(e[1])]}n.rotateAnchorOrientation=$}.call(typeof window<"u"?window:Rt),function(){var A=this;A.jsPlumbUtil.matchesSelector=function(n,C,F){F=F||n.parentNode;for(var z=F.querySelectorAll(C),H=0;H<z.length;H++)if(z[H]===n)return!0;return!1},A.jsPlumbUtil.consume=function(n,C){n.stopPropagation?n.stopPropagation():n.returnValue=!1,!C&&n.preventDefault&&n.preventDefault()},A.jsPlumbUtil.sizeElement=function(n,C,F,z,H){n&&(n.style.height=H+"px",n.height=H,n.style.width=z+"px",n.width=z,n.style.left=C+"px",n.style.top=F+"px")}}.call(typeof window<"u"?window:Rt),function(){var A={deriveAnchor:function(z,H,s,P){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[z][H]}},n=this,C=function(z,H){this.count=0,this.instance=z,this.lists={},this.options=H||{},this.instance.addList=function(s,P){return this.listManager.addList(s,P)},this.instance.removeList=function(s){this.listManager.removeList(s)},this.instance.bind("manageElement",function(s){for(var P=this.instance.getSelector(s.el,"[jtk-scrollable-list]"),a=0;a<P.length;a++)this.addList(P[a])}.bind(this)),this.instance.bind("unmanageElement",function(s){this.removeList(s.el)}),this.instance.bind("connection",function(s,P){P==null&&(this._maybeUpdateParentList(s.source),this._maybeUpdateParentList(s.target))}.bind(this))};n.jsPlumbListManager=C,C.prototype={addList:function(z,H){var s=this.instance.extend({},A);this.instance.extend(s,this.options),H=this.instance.extend(s,H||{});var P=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[P]=new F(this.instance,z,H,P)},removeList:function(z){var H=this.lists[z._jsPlumbList];H&&(H.destroy(),delete this.lists[z._jsPlumbList])},_maybeUpdateParentList:function(z){for(var H=z.parentNode,s=this.instance.getContainer();H!=null&&H!==s;){if(H._jsPlumbList!=null&&this.lists[H._jsPlumbList]!=null){H._jsPlumbScrollHandler();return}H=H.parentNode}}};var F=function(z,H,s,P){H._jsPlumbList=P;function a(D,v,c,t){return s.anchor?s.anchor:s.deriveAnchor(D,v,c,t)}function i(D,v,c,t){return s.deriveEndpoint?s.deriveEndpoint(D,v,c,t):s.endpoint?s.endpoint:c.type}function m(D){for(var v=D.parentNode,c=z.getContainer();v!=null&&v!==c;){if(z.hasClass(v,"jtk-managed")){z.recalculateOffsets(v);return}v=v.parentNode}}var b=function(D){for(var v=z.getSelector(H,".jtk-managed"),c=z.getId(H),t=0;t<v.length;t++){if(v[t].offsetTop<H.scrollTop)v[t]._jsPlumbProxies||(v[t]._jsPlumbProxies=v[t]._jsPlumbProxies||[],z.select({source:v[t]}).each(function(j){z.proxyConnection(j,0,H,c,function(){return i("top",0,j.endpoints[0],j)},function(){return a("top",0,j.endpoints[0],j)}),v[t]._jsPlumbProxies.push([j,0])}),z.select({target:v[t]}).each(function(j){z.proxyConnection(j,1,H,c,function(){return i("top",1,j.endpoints[1],j)},function(){return a("top",1,j.endpoints[1],j)}),v[t]._jsPlumbProxies.push([j,1])}));else if(v[t].offsetTop+v[t].offsetHeight>H.scrollTop+H.offsetHeight)v[t]._jsPlumbProxies||(v[t]._jsPlumbProxies=v[t]._jsPlumbProxies||[],z.select({source:v[t]}).each(function(j){z.proxyConnection(j,0,H,c,function(){return i("bottom",0,j.endpoints[0],j)},function(){return a("bottom",0,j.endpoints[0],j)}),v[t]._jsPlumbProxies.push([j,0])}),z.select({target:v[t]}).each(function(j){z.proxyConnection(j,1,H,c,function(){return i("bottom",1,j.endpoints[1],j)},function(){return a("bottom",1,j.endpoints[1],j)}),v[t]._jsPlumbProxies.push([j,1])}));else if(v[t]._jsPlumbProxies){for(var _=0;_<v[t]._jsPlumbProxies.length;_++)z.unproxyConnection(v[t]._jsPlumbProxies[_][0],v[t]._jsPlumbProxies[_][1],c);delete v[t]._jsPlumbProxies}z.revalidate(v[t])}m(H)};z.setAttribute(H,"jtk-scrollable-list","true"),H._jsPlumbScrollHandler=b,z.on(H,"scroll",b),b(),this.destroy=function(){z.off(H,"scroll",b),delete H._jsPlumbScrollHandler;for(var D=z.getSelector(H,".jtk-managed"),v=z.getId(H),c=0;c<D.length;c++)if(D[c]._jsPlumbProxies){for(var t=0;t<D[c]._jsPlumbProxies.length;t++)z.unproxyConnection(D[c]._jsPlumbProxies[t][0],D[c]._jsPlumbProxies[t][1],v);delete D[c]._jsPlumbProxies}}}}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumbUtil,C=function(c){if(c._jsPlumb.paintStyle&&c._jsPlumb.hoverPaintStyle){var t={};v.extend(t,c._jsPlumb.paintStyle),v.extend(t,c._jsPlumb.hoverPaintStyle),delete c._jsPlumb.hoverPaintStyle,t.gradient&&c._jsPlumb.paintStyle.fill&&delete t.gradient,c._jsPlumb.hoverPaintStyle=t}},F=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],z=function(c,t,_,j){var L=c.getAttachedElements();if(L)for(var U=0,y=L.length;U<y;U++)(!j||j!==L[U])&&L[U].setHover(t,!0,_)},H=function(c){return c==null?null:c.split(" ")},s=function(c,t,_){for(var j in t)c[j]=_},P=function(c,t,_){if(c.getDefaultType){var j=c.getTypeDescriptor(),L={},U=c.getDefaultType(),y=n.merge({},U);s(L,U,"__default");for(var I=0,r=c._jsPlumb.types.length;I<r;I++){var p=c._jsPlumb.types[I];if(p!=="__default"){var d=c._jsPlumb.instance.getType(p,j);if(d!=null){var w=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],M=[];d.mergeStrategy==="override"?Array.prototype.push.apply(w,["events","overlays","cssClass"]):M.push("cssClass"),y=n.merge(y,d,M,w),s(L,d,p)}}}t&&(y=n.populate(y,t,"_")),c.applyType(y,_,L),_||c.repaint()}},a=A.jsPlumbUIComponent=function(c){n.EventGenerator.apply(this,arguments);var t=this,_=arguments,j=t.idPrefix,L=j+new Date().getTime();this._jsPlumb={instance:c._jsPlumb,parameters:c.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:c.beforeDetach,beforeDrop:c.beforeDrop,overlayPlacements:[],hoverClass:c.hoverClass||c._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(M,h,k){this._jsPlumb.typeCache[k]=this._jsPlumb.typeCache[k]||{},this._jsPlumb.typeCache[k][M]=h},this.getCachedTypeItem=function(M,h){return this._jsPlumb.typeCache[h]?this._jsPlumb.typeCache[h][M]:null},this.getId=function(){return L};var U=c.overlays||[],y={};if(this.defaultOverlayKeys){for(var I=0;I<this.defaultOverlayKeys.length;I++)Array.prototype.push.apply(U,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[I]]||[]);for(I=0;I<U.length;I++){var r=v.convertToFullOverlaySpec(U[I]);y[r[1].id]=r}}var p={overlays:y,parameters:c.parameters||{},scope:c.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return p},this.appendToDefaultType=function(M){for(var h in M)p[h]=M[h]},c.events)for(var d in c.events)t.bind(d,c.events[d]);this.clone=function(){var M=Object.create(this.constructor.prototype);return this.constructor.apply(M,_),M}.bind(this),this.isDetachAllowed=function(M){var h=!0;if(this._jsPlumb.beforeDetach)try{h=this._jsPlumb.beforeDetach(M)}catch(k){n.log("jsPlumb: beforeDetach callback failed",k)}return h},this.isDropAllowed=function(M,h,k,x,T,f,O){var X=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:M,targetId:h,scope:k,connection:x,dropEndpoint:T,source:f,target:O});if(this._jsPlumb.beforeDrop)try{X=this._jsPlumb.beforeDrop({sourceId:M,targetId:h,scope:k,connection:x,dropEndpoint:T,source:f,target:O})}catch(W){n.log("jsPlumb: beforeDrop callback failed",W)}return X};var w=[];this.setListenerComponent=function(M){for(var h=0;h<w.length;h++)w[h][3]=M}},i=function(c,t){var _=c._jsPlumb.types[t],j=c._jsPlumb.instance.getType(_,c.getTypeDescriptor());j!=null&&j.cssClass&&c.canvas&&c._jsPlumb.instance.removeClass(c.canvas,j.cssClass)};n.extend(A.jsPlumbUIComponent,n.EventGenerator,{getParameter:function(c){return this._jsPlumb.parameters[c]},setParameter:function(c,t){this._jsPlumb.parameters[c]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(c){this._jsPlumb.parameters=c},getClass:function(){return v.getClass(this.canvas)},hasClass:function(c){return v.hasClass(this.canvas,c)},addClass:function(c){v.addClass(this.canvas,c)},removeClass:function(c){v.removeClass(this.canvas,c)},updateClasses:function(c,t){v.updateClasses(this.canvas,c,t)},setType:function(c,t,_){this.clearTypes(),this._jsPlumb.types=H(c)||[],P(this,t,_)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(c,t){P(this,c,t)},hasType:function(c){return this._jsPlumb.types.indexOf(c)!==-1},addType:function(c,t,_){var j=H(c),L=!1;if(j!=null){for(var U=0,y=j.length;U<y;U++)this.hasType(j[U])||(this._jsPlumb.types.push(j[U]),L=!0);L&&P(this,t,_)}},removeType:function(c,t,_){var j=H(c),L=!1,U=function(r){var p=this._jsPlumb.types.indexOf(r);return p!==-1?(i(this,p),this._jsPlumb.types.splice(p,1),!0):!1}.bind(this);if(j!=null){for(var y=0,I=j.length;y<I;y++)L=U(j[y])||L;L&&P(this,t,_)}},clearTypes:function(c,t){for(var _=this._jsPlumb.types.length,j=0;j<_;j++)i(this,0),this._jsPlumb.types.splice(0,1);P(this,c,t)},toggleType:function(c,t,_){var j=H(c);if(j!=null){for(var L=0,U=j.length;L<U;L++){var y=this._jsPlumb.types.indexOf(j[L]);y!==-1?(i(this,y),this._jsPlumb.types.splice(y,1)):this._jsPlumb.types.push(j[L])}P(this,t,_)}},applyType:function(c,t){if(this.setPaintStyle(c.paintStyle,t),this.setHoverPaintStyle(c.hoverPaintStyle,t),c.parameters)for(var _ in c.parameters)this.setParameter(_,c.parameters[_]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(c,t){this._jsPlumb.paintStyle=c,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,C(this),t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(c,t){this._jsPlumb.hoverPaintStyle=c,C(this),t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(c){(c||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(c,t,_){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=c;var j=c?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[j](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[j](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=c?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(_=_||jsPlumbUtil.uuid(),this.repaint({timestamp:_,recalc:!1}))),this.getAttachedElements&&!t&&z(this,c,jsPlumbUtil.uuid(),this)}}});var m=0,b=function(){var c=m+1;return m++,c},D=A.jsPlumbInstance=function(c){this.version="2.15.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},ListStyle:{},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},c&&v.extend(this.Defaults,c),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},n.EventGenerator.apply(this);var t=this,_=b(),j=t.bind,L={},U=1,y=function(l){if(l==null)return null;if(l.nodeType===3||l.nodeType===8)return{el:l,text:!0};var V=t.getElement(l);return{el:V,id:n.isString(l)&&V==null?l:dt(V)}};this.getInstanceIndex=function(){return _},this.setZoom=function(l,V){return U=l,t.fire("zoom",U),V&&t.repaintEverything(),!0},this.getZoom=function(){return U};for(var I in this.Defaults)L[I]=this.Defaults[I];var r,p=[];this.unbindContainer=function(){if(r!=null&&p.length>0)for(var l=0;l<p.length;l++)t.off(r,p[l][0],p[l][1])},this.setContainer=function(l){this.unbindContainer(),l=this.getElement(l),this.select().each(function(mt){mt.moveParent(l)}),this.selectEndpoints().each(function(mt){mt.moveParent(l)});var V=r;r=l,p.length=0;for(var S={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},N=function(mt,pt,wt){var Ct=pt.srcElement||pt.target,It=(Ct&&Ct.parentNode?Ct.parentNode._jsPlumb:null)||(Ct?Ct._jsPlumb:null)||(Ct&&Ct.parentNode&&Ct.parentNode.parentNode?Ct.parentNode.parentNode._jsPlumb:null);if(It){It.fire(mt,It,pt);var Lt=wt&&S[wt+mt]||mt;t.fire(Lt,It.component||It,pt)}},Y=function(mt,pt,wt){p.push([mt,wt]),t.on(r,mt,pt,wt)},J=function(mt){Y(mt,".jtk-connector",function(pt){N(mt,pt)}),Y(mt,".jtk-endpoint",function(pt){N(mt,pt,"endpoint")}),Y(mt,".jtk-overlay",function(pt){N(mt,pt)})},st=0;st<F.length;st++)J(F[st]);for(var gt in x){var ut=x[gt].el;ut.parentNode===V&&(V.removeChild(ut),r.appendChild(ut))}},this.getContainer=function(){return r},this.bind=function(l,V){l==="ready"&&w?V():j.apply(t,[l,V])},t.importDefaults=function(l){for(var V in l)t.Defaults[V]=l[V];return l.Container&&t.setContainer(l.Container),t},t.restoreDefaults=function(){return t.Defaults=v.extend({},L),t};var d=null,w=!1,M=[],h={},k={},x={},T={},f={},O=!1,X=[],W=!1,$=null,o=this.Defaults.Scope,u=1,e=function(){return""+u++},g=function(l,V){r?r.appendChild(l):V?this.getElement(V).appendChild(l):this.appendToRoot(l)}.bind(this),E=function(l,V,S,N){var Y={c:[],e:[]};if(!W&&(l=t.getElement(l),l!=null)){var J=dt(l),st=l.querySelectorAll(".jtk-managed");S==null&&(S=jsPlumbUtil.uuid()),Ut({elId:J,offset:V,recalc:!1,timestamp:S});for(var gt=0;gt<st.length;gt++)Ut({elId:st[gt].getAttribute("id"),recalc:!0,timestamp:S});var ut=t.router.redraw(J,V,S,null,N);if(Array.prototype.push.apply(Y.c,ut.c),Array.prototype.push.apply(Y.e,ut.e),st)for(var mt=0;mt<st.length;mt++)ut=t.router.redraw(st[mt].getAttribute("id"),null,S,null,N,!0),Array.prototype.push.apply(Y.c,ut.c),Array.prototype.push.apply(Y.e,ut.e)}return Y},G=function(l){return k[l]},R=function(l,V){for(var S=l.scope.split(/\s/),N=V.scope.split(/\s/),Y=0;Y<S.length;Y++)for(var J=0;J<N.length;J++)if(N[J]===S[Y])return!0;return!1},K=function(l,V){var S=v.extend({},l);for(var N in V)V[N]&&(S[N]=V[N]);return S},q=function(l,V){var S=v.extend({},l);if(V&&v.extend(S,V),S.source&&(S.source.endpoint?S.sourceEndpoint=S.source:S.source=t.getElement(S.source)),S.target&&(S.target.endpoint?S.targetEndpoint=S.target:S.target=t.getElement(S.target)),l.uuids&&(S.sourceEndpoint=G(l.uuids[0]),S.targetEndpoint=G(l.uuids[1])),S.sourceEndpoint&&S.sourceEndpoint.isFull()){n.log(t,"could not add connection; source endpoint is full");return}if(S.targetEndpoint&&S.targetEndpoint.isFull()){n.log(t,"could not add connection; target endpoint is full");return}if(!S.type&&S.sourceEndpoint&&(S.type=S.sourceEndpoint.connectionType),S.sourceEndpoint&&S.sourceEndpoint.connectorOverlays){S.overlays=S.overlays||[];for(var N=0,Y=S.sourceEndpoint.connectorOverlays.length;N<Y;N++)S.overlays.push(S.sourceEndpoint.connectorOverlays[N])}S.sourceEndpoint&&S.sourceEndpoint.scope&&(S.scope=S.sourceEndpoint.scope),!S["pointer-events"]&&S.sourceEndpoint&&S.sourceEndpoint.connectorPointerEvents&&(S["pointer-events"]=S.sourceEndpoint.connectorPointerEvents);var J=function(gt,ut,mt){var pt=K(ut,{anchor:S.anchors?S.anchors[mt]:S.anchor,endpoint:S.endpoints?S.endpoints[mt]:S.endpoint,paintStyle:S.endpointStyles?S.endpointStyles[mt]:S.endpointStyle,hoverPaintStyle:S.endpointHoverStyles?S.endpointHoverStyles[mt]:S.endpointHoverStyle});return t.addEndpoint(gt,pt)},st=function(gt,ut,mt,pt){if(S[gt]&&!S[gt].endpoint&&!S[gt+"Endpoint"]&&!S.newConnection){var wt=dt(S[gt]),Ct=mt[wt];if(Ct=Ct?Ct[pt]:null,Ct){if(!Ct.enabled)return!1;var It=v.extend({},Ct.def);delete It.label;var Lt=Ct.endpoint!=null&&Ct.endpoint._jsPlumb?Ct.endpoint:J(S[gt],It,ut);if(Lt.isFull())return!1;S[gt+"Endpoint"]=Lt,!S.scope&&It.scope&&(S.scope=It.scope),Ct.uniqueEndpoint?Ct.endpoint?Lt.finalEndpoint=Ct.endpoint:(Ct.endpoint=Lt,Lt.setDeleteOnEmpty(!1)):Lt.setDeleteOnEmpty(!0),ut===0&&Ct.def.connectorOverlays&&(S.overlays=S.overlays||[],Array.prototype.push.apply(S.overlays,Ct.def.connectorOverlays))}}};if(st("source",0,this.sourceEndpointDefinitions,S.type||"default")!==!1&&st("target",1,this.targetEndpointDefinitions,S.type||"default")!==!1)return S.sourceEndpoint&&S.targetEndpoint&&(R(S.sourceEndpoint,S.targetEndpoint)||(S=null)),S}.bind(t),Q=function(l){var V=t.Defaults.ConnectionType||t.getDefaultConnectionType();l._jsPlumb=t,l.newConnection=Q,l.newEndpoint=at,l.endpointsByUUID=k,l.endpointsByElement=h,l.finaliseConnection=ct,l.id="con_"+e();var S=new V(l);return S.isDetachable()&&(S.endpoints[0].initDraggable("_jsPlumbSource"),S.endpoints[1].initDraggable("_jsPlumbTarget")),S},ct=t.finaliseConnection=function(l,V,S,N){if(V=V||{},l.suspendedEndpoint||M.push(l),l.pending=null,l.endpoints[0].isTemporarySource=!1,N!==!1&&t.router.newConnection(l),E(l.source),!V.doNotFireConnectionEvent&&V.fireEvent!==!1){var Y={connection:l,source:l.source,target:l.target,sourceId:l.sourceId,targetId:l.targetId,sourceEndpoint:l.endpoints[0],targetEndpoint:l.endpoints[1]};t.fire("connection",Y,S)}},at=function(l,V){var S=t.Defaults.EndpointType||v.Endpoint,N=v.extend({},l);N._jsPlumb=t,N.newConnection=Q,N.newEndpoint=at,N.endpointsByUUID=k,N.endpointsByElement=h,N.fireDetachEvent=et,N.elementId=V||dt(N.source);var Y=new S(N);return Y.id="ep_"+e(),Pe(N.elementId,N.source),v.headless||t.getDragManager().endpointAdded(N.source,V),Y},rt=function(l,V,S){var N=h[l];if(N&&N.length)for(var Y=0,J=N.length;Y<J;Y++){for(var st=0,gt=N[Y].connections.length;st<gt;st++){var ut=V(N[Y].connections[st]);if(ut)return}S&&S(N[Y])}},lt=function(l,V,S){V=V==="block";var N=null;S&&(N=function(J){J.setVisible(V,!0,!0)});var Y=y(l);rt(Y.id,function(J){if(V&&S){var st=J.sourceId===Y.id?1:0;J.endpoints[st].isVisible()&&J.setVisible(!0)}else J.setVisible(V)},N)},bt=function(l,V){var S=null;V&&(S=function(N){var Y=N.isVisible();N.setVisible(!Y)}),rt(l,function(N){var Y=N.isVisible();N.setVisible(!Y)},S)},vt=function(l){var V=T[l];return V?{o:V,s:X[l]}:Ut({elId:l})},dt=function(l,V,S){if(n.isString(l))return l;if(l==null)return null;var N=t.getAttribute(l,"id");return(!N||N==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?N=V:(arguments.length===1||arguments.length===3&&!arguments[2])&&(N="jsPlumb_"+_+"_"+e()),S||t.setAttribute(l,"id",N)),N};this.setConnectionBeingDragged=function(l){O=l},this.isConnectionBeingDragged=function(){return O},this.getManagedElements=function(){return x},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(l,V,S){S=S||{};var N=v.extend({},S);v.extend(N,V),N.endpoint=N.endpoint||t.Defaults.Endpoint,N.paintStyle=N.paintStyle||t.Defaults.EndpointStyle;for(var Y=[],J=n.isArray(l)||l.length!=null&&!n.isString(l)?l:[l],st=0,gt=J.length;st<gt;st++){N.source=t.getElement(J[st]),ge(N.source);var ut=dt(N.source),mt=at(N,ut),pt=Pe(ut,N.source,null,!W).info.o;n.addToList(h,ut,mt),W||mt.paint({anchorLoc:mt.anchor.compute({xy:[pt.left,pt.top],wh:X[ut],element:mt,timestamp:$,rotation:this.getRotation(ut)}),timestamp:$}),Y.push(mt)}return Y.length===1?Y[0]:Y},this.addEndpoints=function(l,V,S){for(var N=[],Y=0,J=V.length;Y<J;Y++){var st=t.addEndpoint(l,V[Y],S);n.isArray(st)?Array.prototype.push.apply(N,st):N.push(st)}return N},this.animate=function(l,V,S){if(!this.animationSupported)return!1;S=S||{};var N=t.getElement(l),Y=dt(N),J=v.animEvents.step,st=v.animEvents.complete;S[J]=n.wrap(S[J],function(){t.revalidate(Y)}),S[st]=n.wrap(S[st],function(){t.revalidate(Y)}),t.doAnimate(N,V,S)},this.checkCondition=function(l,V){var S=t.getListener(l),N=!0;if(S&&S.length>0){var Y=Array.prototype.slice.call(arguments,1);try{for(var J=0,st=S.length;J<st;J++)N=N&&S[J].apply(S[J],Y)}catch(gt){n.log(t,"cannot check condition ["+l+"]"+gt)}}return N},this.connect=function(l,V){var S=q(l,V),N;if(S){if(S.source==null&&S.sourceEndpoint==null){n.log("Cannot establish connection - source does not exist");return}if(S.target==null&&S.targetEndpoint==null){n.log("Cannot establish connection - target does not exist");return}ge(S.source),N=Q(S),ct(N,S)}return N};var Et=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],yt=function(l,V,S,N){var Y,J=Et[S],st=l[J.elId];l[J.el];var gt,ut,mt=l.endpoints[S],pt={index:S,originalSourceId:S===0?st:l.sourceId,newSourceId:l.sourceId,originalTargetId:S===1?st:l.targetId,newTargetId:l.targetId,connection:l};if(V.constructor===v.Endpoint)Y=V,Y.addConnection(l),V=Y.element;else if(gt=dt(V),ut=this[J.epDefs][gt],gt===l[J.elId])Y=null;else if(ut)for(var wt in ut){if(!ut[wt].enabled)return;Y=ut[wt].endpoint!=null&&ut[wt].endpoint._jsPlumb?ut[wt].endpoint:this.addEndpoint(V,ut[wt].def),ut[wt].uniqueEndpoint&&(ut[wt].endpoint=Y),Y.addConnection(l)}else Y=l.makeEndpoint(S===0,V,gt);return Y!=null&&(mt.detachFromConnection(l),l.endpoints[S]=Y,l[J.el]=Y.element,l[J.elId]=Y.elementId,pt[S===0?"newSourceId":"newTargetId"]=Y.elementId,tt(pt),N||l.repaint()),pt.element=V,pt}.bind(this);this.setSource=function(l,V,S){var N=yt(l,V,0,S);this.router.sourceOrTargetChanged(N.originalSourceId,N.newSourceId,l,N.el,0)},this.setTarget=function(l,V,S){var N=yt(l,V,1,S);this.router.sourceOrTargetChanged(N.originalTargetId,N.newTargetId,l,N.el,1)},this.deleteEndpoint=function(l,V,S){var N=typeof l=="string"?k[l]:l;return N&&t.deleteObject({endpoint:N,dontUpdateHover:V,deleteAttachedObjects:S}),t},this.deleteEveryEndpoint=function(){var l=t.setSuspendDrawing(!0);for(var V in h){var S=h[V];if(S&&S.length)for(var N=0,Y=S.length;N<Y;N++)t.deleteEndpoint(S[N],!0)}h={},x={},k={},T={},f={},t.router.reset();var J=t.getDragManager();return J&&J.reset(),l||t.setSuspendDrawing(!1),t};var et=function(l,V,S){var N=t.Defaults.ConnectionType||t.getDefaultConnectionType(),Y=l.constructor===N,J=Y?{connection:l,source:l.source,target:l.target,sourceId:l.sourceId,targetId:l.targetId,sourceEndpoint:l.endpoints[0],targetEndpoint:l.endpoints[1]}:l;V&&t.fire("connectionDetached",J,S),t.fire("internal.connectionDetached",J,S),t.router.connectionDetached(J)},tt=t.fireMoveEvent=function(l,V){t.fire("connectionMoved",l,V)};this.unregisterEndpoint=function(l){l._jsPlumb.uuid&&(k[l._jsPlumb.uuid]=null),t.router.deleteEndpoint(l);for(var V in h){var S=h[V];if(S){for(var N=[],Y=0,J=S.length;Y<J;Y++)S[Y]!==l&&N.push(S[Y]);h[V]=N}h[V].length<1&&delete h[V]}};var it="isDetachAllowed",ht="beforeDetach",Pt="checkCondition";this.deleteConnection=function(l,V){return l!=null&&(V=V||{},V.force||n.functionChain(!0,!1,[[l.endpoints[0],it,[l]],[l.endpoints[1],it,[l]],[l,it,[l]],[t,Pt,[ht,l]]]))?(l.setHover(!1),et(l,!l.pending&&V.fireEvent!==!1,V.originalEvent),l.endpoints[0].detachFromConnection(l),l.endpoints[1].detachFromConnection(l),n.removeWithFunction(M,function(S){return l.id===S.id}),l.cleanup(),l.destroy(),!0):!1},this.deleteEveryConnection=function(l){l=l||{};var V=M.length,S=0;return t.batch(function(){for(var N=0;N<V;N++)S+=t.deleteConnection(M[0],l)?1:0}),S},this.deleteConnectionsForElement=function(l,V){V=V||{},l=t.getElement(l);var S=dt(l),N=h[S];if(N&&N.length)for(var Y=0,J=N.length;Y<J;Y++)N[Y].deleteEveryConnection(V);return t},this.deleteObject=function(l){var V={endpoints:{},connections:{},endpointCount:0,connectionCount:0},S=l.deleteAttachedObjects!==!1,N=function(pt){pt!=null&&V.connections[pt.id]==null&&(!l.dontUpdateHover&&pt._jsPlumb!=null&&pt.setHover(!1),V.connections[pt.id]=pt,V.connectionCount++)},Y=function(pt){if(pt!=null&&V.endpoints[pt.id]==null&&(!l.dontUpdateHover&&pt._jsPlumb!=null&&pt.setHover(!1),V.endpoints[pt.id]=pt,V.endpointCount++,S))for(var wt=0;wt<pt.connections.length;wt++){var Ct=pt.connections[wt];N(Ct)}};l.connection?N(l.connection):Y(l.endpoint);for(var J in V.connections){var st=V.connections[J];if(st._jsPlumb){n.removeWithFunction(M,function(pt){return st.id===pt.id}),et(st,l.fireEvent===!1?!1:!st.pending,l.originalEvent);var gt=l.deleteAttachedObjects==null?null:!l.deleteAttachedObjects;st.endpoints[0].detachFromConnection(st,null,gt),st.endpoints[1].detachFromConnection(st,null,gt),st.cleanup(!0),st.destroy(!0)}}for(var ut in V.endpoints){var mt=V.endpoints[ut];mt._jsPlumb&&(t.unregisterEndpoint(mt),mt.cleanup(!0),mt.destroy(!0))}return V};var Ot=function(l,V,S,N){for(var Y=0,J=l.length;Y<J;Y++)l[Y][V].apply(l[Y],S);return N(l)},Bt=function(l,V,S){for(var N=[],Y=0,J=l.length;Y<J;Y++)N.push([l[Y][V].apply(l[Y],S),l[Y]]);return N},Kt=function(l,V,S){return function(){return Ot(l,V,arguments,S)}},ae=function(l,V){return function(){return Bt(l,V,arguments)}},te=function(l,V){var S=[];if(l)if(typeof l=="string"){if(l==="*")return l;S.push(l)}else if(V)S=l;else if(l.length)for(var N=0,Y=l.length;N<Y;N++)S.push(y(l[N]).id);else S.push(y(l).id);return S},ee=function(l,V,S){return l==="*"?!0:l.length>0?l.indexOf(V)!==-1:!S};this.getConnections=function(l,V){l?l.constructor===String&&(l={scope:l}):l={};for(var S=l.scope||t.getDefaultScope(),N=te(S,!0),Y=te(l.source),J=te(l.target),st=!V&&N.length>1?{}:[],gt=function(It,Lt){if(!V&&N.length>1){var Ht=st[It];Ht==null&&(Ht=st[It]=[]),Ht.push(Lt)}else st.push(Lt)},ut=0,mt=M.length;ut<mt;ut++){var pt=M[ut],wt=pt.proxies&&pt.proxies[0]?pt.proxies[0].originalEp.elementId:pt.sourceId,Ct=pt.proxies&&pt.proxies[1]?pt.proxies[1].originalEp.elementId:pt.targetId;ee(N,pt.scope)&&ee(Y,wt)&&ee(J,Ct)&&gt(pt.scope,pt)}return st};var je=function(l,V){return function(S){for(var N=0,Y=l.length;N<Y;N++)S(l[N]);return V(l)}},De=function(l){return function(V){return l[V]}},we=function(l,V){var S={length:l.length,each:je(l,V),get:De(l)},N=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],Y=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],J,st;for(J=0,st=N.length;J<st;J++)S[N[J]]=Kt(l,N[J],V);for(J=0,st=Y.length;J<st;J++)S[Y[J]]=ae(l,Y[J]);return S},ne=function(l){var V=we(l,ne);return v.extend(V,{setDetachable:Kt(l,"setDetachable",ne),setReattach:Kt(l,"setReattach",ne),setConnector:Kt(l,"setConnector",ne),delete:function(){for(var S=0,N=l.length;S<N;S++)t.deleteConnection(l[S])},isDetachable:ae(l,"isDetachable"),isReattach:ae(l,"isReattach")})},me=function(l){var V=we(l,me);return v.extend(V,{setEnabled:Kt(l,"setEnabled",me),setAnchor:Kt(l,"setAnchor",me),isEnabled:ae(l,"isEnabled"),deleteEveryConnection:function(){for(var S=0,N=l.length;S<N;S++)l[S].deleteEveryConnection()},delete:function(){for(var S=0,N=l.length;S<N;S++)t.deleteEndpoint(l[S])}})};this.select=function(l){return l=l||{},l.scope=l.scope||"*",ne(l.connections||t.getConnections(l,!0))},this.selectEndpoints=function(l){l=l||{},l.scope=l.scope||"*";var V=!l.element&&!l.source&&!l.target,S=V?"*":te(l.element),N=V?"*":te(l.source),Y=V?"*":te(l.target),J=te(l.scope,!0),st=[];for(var gt in h){var ut=ee(S,gt,!0),mt=ee(N,gt,!0),pt=N!=="*",wt=ee(Y,gt,!0),Ct=Y!=="*";if(ut||mt||wt)t:for(var It=0,Lt=h[gt].length;It<Lt;It++){var Ht=h[gt][It];if(ee(J,Ht.scope,!0)){var ke=pt&&N.length>0&&!Ht.isSource,Ae=Ct&&Y.length>0&&!Ht.isTarget;if(ke||Ae)continue t;st.push(Ht)}}}return me(st)},this.getAllConnections=function(){return M},this.getDefaultScope=function(){return o},this.getEndpoint=G,this.getEndpoints=function(l){return h[y(l).id]||[]},this.getDefaultEndpointType=function(){return v.Endpoint},this.getDefaultConnectionType=function(){return v.Connection},this.getId=dt,this.draw=E,this.info=y,this.appendElement=g;var ie=!1;this.isHoverSuspended=function(){return ie},this.setHoverSuspended=function(l){ie=l},this.hide=function(l,V){return lt(l,"none",V),t},this.idstamp=e;var ge=function(l){if(!r&&l){var V=t.getElement(l);V.offsetParent&&t.setContainer(V.offsetParent)}},ye=function(){t.Defaults.Container&&t.setContainer(t.Defaults.Container)},Pe=t.manage=function(l,V,S,N){return x[l]?N&&(x[l].info=Ut({elId:l,timestamp:$,recalc:!0})):(x[l]={el:V,endpoints:[],connections:[],rotation:0},x[l].info=Ut({elId:l,timestamp:$}),t.addClass(V,"jtk-managed"),S||t.fire("manageElement",{id:l,info:x[l].info,el:V})),x[l]};this.unmanage=function(l){if(x[l]){var V=x[l].el;t.removeClass(V,"jtk-managed"),delete x[l],t.fire("unmanageElement",{id:l,el:V})}},this.rotate=function(l,V,S){return x[l]&&(x[l].rotation=V,x[l].el.style.transform="rotate("+V+"deg)",x[l].el.style.transformOrigin="center center",S!==!0)?this.revalidate(l):{c:[],e:[]}},this.getRotation=function(l){return x[l]&&x[l].rotation||0};var Ut=function(l){var V=l.timestamp,S=l.recalc,N=l.offset,Y=l.elId,J;return W&&!V&&(V=$),!S&&V&&V===f[Y]?{o:l.offset||T[Y],s:X[Y]}:(S||!N&&T[Y]==null?(J=x[Y]?x[Y].el:null,J!=null&&(X[Y]=t.getSize(J),T[Y]=t.getOffset(J),f[Y]=V)):(T[Y]=N||T[Y],X[Y]==null&&(J=x[Y].el,J!=null&&(X[Y]=t.getSize(J))),f[Y]=V),T[Y]&&!T[Y].right&&(T[Y].right=T[Y].left+X[Y][0],T[Y].bottom=T[Y].top+X[Y][1],T[Y].width=X[Y][0],T[Y].height=X[Y][1],T[Y].centerx=T[Y].left+T[Y].width/2,T[Y].centery=T[Y].top+T[Y].height/2),{o:T[Y],s:X[Y]})};this.updateOffset=Ut,this.init=function(){w||(ye(),t.router=new A.jsPlumb.DefaultRouter(t),t.anchorManager=t.router.anchorManager,w=!0,t.fire("ready",t))}.bind(this),this.log=d,this.jsPlumbUIComponent=a,this.makeAnchor=function(){var l,V=function(st,gt){if(A.jsPlumb.Anchors[st])return new A.jsPlumb.Anchors[st](gt);if(!t.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+st+"'"}};if(arguments.length===0)return null;var S=arguments[0],N=arguments[1],Y=null;if(S.compute&&S.getOrientation)return S;if(typeof S=="string")Y=V(arguments[0],{elementId:N,jsPlumbInstance:t});else if(n.isArray(S))if(n.isArray(S[0])||n.isString(S[0]))S.length===2&&n.isObject(S[1])?n.isString(S[0])?(l=A.jsPlumb.extend({elementId:N,jsPlumbInstance:t},S[1]),Y=V(S[0],l)):(l=A.jsPlumb.extend({elementId:N,jsPlumbInstance:t,anchors:S[0]},S[1]),Y=new A.jsPlumb.DynamicAnchor(l)):Y=new v.DynamicAnchor({anchors:S,selector:null,elementId:N,jsPlumbInstance:t});else{var J={x:S[0],y:S[1],orientation:S.length>=4?[S[2],S[3]]:[0,0],offsets:S.length>=6?[S[4],S[5]]:[0,0],elementId:N,jsPlumbInstance:t,cssClass:S.length===7?S[6]:null};Y=new A.jsPlumb.Anchor(J),Y.clone=function(){return new A.jsPlumb.Anchor(J)}}return Y.id||(Y.id="anchor_"+e()),Y},this.makeAnchors=function(l,V,S){for(var N=[],Y=0,J=l.length;Y<J;Y++)typeof l[Y]=="string"?N.push(A.jsPlumb.Anchors[l[Y]]({elementId:V,jsPlumbInstance:S})):n.isArray(l[Y])&&N.push(t.makeAnchor(l[Y],V,S));return N},this.makeDynamicAnchor=function(l,V){return new A.jsPlumb.DynamicAnchor({anchors:l,selector:V,elementId:null,jsPlumbInstance:t})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var oe=function(l,V,S,N,Y){for(var J=l.target||l.srcElement,st=!1,gt=N.getSelector(V,S),ut=0;ut<gt.length;ut++)if(gt[ut]===J){st=!0;break}return Y?!st:st},qt=function(l,V,S,N,Y){var J=new a(V),st=V._jsPlumb.EndpointDropHandler({jsPlumb:t,enabled:function(){return l.def.enabled},isFull:function(){var ut=t.select({target:l.id}).length;return l.def.maxConnections>0&&ut>=l.def.maxConnections},element:l.el,elementId:l.id,isSource:N,isTarget:Y,addClass:function(ut){t.addClass(l.el,ut)},removeClass:function(ut){t.removeClass(l.el,ut)},onDrop:function(ut){var mt=ut.endpoints[0];mt.anchor.locked=!1},isDropAllowed:function(){return J.isDropAllowed.apply(J,arguments)},isRedrop:function(ut){return ut.suspendedElement!=null&&ut.suspendedEndpoint!=null&&ut.suspendedEndpoint.element===l.el},getEndpoint:function(ut){var mt=l.def.endpoint;if(mt==null||mt._jsPlumb==null){var pt=t.deriveEndpointAndAnchorSpec(ut.getType().join(" "),!0),wt=pt.endpoints?A.jsPlumb.extend(V,{endpoint:l.def.def.endpoint||pt.endpoints[1]}):V;pt.anchors&&(wt=A.jsPlumb.extend(wt,{anchor:l.def.def.anchor||pt.anchors[1]})),mt=t.addEndpoint(l.el,wt),mt._mtNew=!0}if(V.uniqueEndpoint&&(l.def.endpoint=mt),mt.setDeleteOnEmpty(!0),ut.isDetachable()&&mt.initDraggable(),mt.anchor.positionFinder!=null){var Ct=t.getUIPosition(arguments,t.getZoom()),It=t.getOffset(l.el),Lt=t.getSize(l.el),Ht=Ct==null?[0,0]:mt.anchor.positionFinder(Ct,It,Lt,mt.anchor.constructorParams);mt.anchor.x=Ht[0],mt.anchor.y=Ht[1]}return mt},maybeCleanup:function(ut){ut._mtNew&&ut.connections.length===0?t.deleteObject({endpoint:ut}):delete ut._mtNew}}),gt=A.jsPlumb.dragEvents.drop;return S.scope=S.scope||V.scope||t.Defaults.Scope,S[gt]=n.wrap(S[gt],st,!0),S.rank=V.rank||0,Y&&(S[A.jsPlumb.dragEvents.over]=function(){return!0}),V.allowLoopback===!1&&(S.canDrop=function(ut){var mt=ut.getDragElement()._jsPlumbRelatedElement;return mt!==l.el}),t.initDroppable(l.el,S,"internal"),st};this.makeTarget=function(l,V,S){var N=A.jsPlumb.extend({_jsPlumb:this},S);A.jsPlumb.extend(N,V);for(var Y=N.maxConnections||-1,J=function(mt){var pt=y(mt),wt=pt.id,Ct=A.jsPlumb.extend({},N.dropOptions||{}),It=N.connectionType||"default";this.targetEndpointDefinitions[wt]=this.targetEndpointDefinitions[wt]||{},ge(wt),pt.el._isJsPlumbGroup&&Ct.rank==null&&(Ct.rank=-1);var Lt={def:A.jsPlumb.extend({},N),uniqueEndpoint:N.uniqueEndpoint,maxConnections:Y,enabled:!0};N.createEndpoint&&(Lt.uniqueEndpoint=!0,Lt.endpoint=t.addEndpoint(mt,Lt.def),Lt.endpoint.setDeleteOnEmpty(!1)),pt.def=Lt,this.targetEndpointDefinitions[wt][It]=Lt,qt(pt,N,Ct,N.isSource===!0,!0),pt.el._katavorioDrop[pt.el._katavorioDrop.length-1].targetDef=Lt}.bind(this),st=l.length&&l.constructor!==String?l:[l],gt=0,ut=st.length;gt<ut;gt++)J(st[gt]);return this},this.unmakeTarget=function(l,V){var S=y(l);return t.destroyDroppable(S.el,"internal"),V||delete this.targetEndpointDefinitions[S.id],this},this.makeSource=function(l,V,S){var N=A.jsPlumb.extend({_jsPlumb:this},S);A.jsPlumb.extend(N,V);var Y=N.connectionType||"default",J=t.deriveEndpointAndAnchorSpec(Y);N.endpoint=N.endpoint||J.endpoints[0],N.anchor=N.anchor||J.anchors[0];for(var st=N.maxConnections||-1,gt=N.onMaxConnections,ut=function(Ct){var It=Ct.id,Lt=this.getElement(Ct.el);this.sourceEndpointDefinitions[It]=this.sourceEndpointDefinitions[It]||{},ge(It);var Ht={def:A.jsPlumb.extend({},N),uniqueEndpoint:N.uniqueEndpoint,maxConnections:st,enabled:!0};N.createEndpoint&&(Ht.uniqueEndpoint=!0,Ht.endpoint=t.addEndpoint(l,Ht.def),Ht.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[It][Y]=Ht,Ct.def=Ht;var ke=A.jsPlumb.dragEvents.stop,Ae=A.jsPlumb.dragEvents.drag,le=A.jsPlumb.extend({},N.dragOptions||{}),Re=le.drag,Ge=le.stop,Xt=null,Ie=!1;le.scope=le.scope||N.scope,le[Ae]=n.wrap(le[Ae],function(){Re&&Re.apply(this,arguments),Ie=!1}),le[ke]=n.wrap(le[ke],function(){if(Ge&&Ge.apply(this,arguments),this.currentlyDragging=!1,Xt._jsPlumb!=null){var Jt=N.anchor||this.Defaults.Anchor,Yt=Xt.anchor,Te=Xt.connections[0],de=this.makeAnchor(Jt,It,this),_e=Xt.element;if(de.positionFinder!=null){var re=t.getOffset(_e),he=this.getSize(_e),Oe={left:re.left+Yt.x*he[0],top:re.top+Yt.y*he[1]},xe=de.positionFinder(Oe,re,he,de.constructorParams);de.x=xe[0],de.y=xe[1]}Xt.setAnchor(de,!0),Xt.repaint(),this.repaint(Xt.elementId),Te!=null&&this.repaint(Te.targetId)}}.bind(this));var Be=function(Jt){if(!(Jt.which===3||Jt.button===2)){It=this.getId(this.getElement(Ct.el));var Yt=this.sourceEndpointDefinitions[It][Y];if(Yt.enabled){if(N.filter){var Te=n.isString(N.filter)?oe(Jt,Ct.el,N.filter,this,N.filterExclude):N.filter(Jt,Ct.el);if(Te===!1)return}var de=this.select({source:It}).length;if(Yt.maxConnections>=0&&de>=Yt.maxConnections)return gt&&gt({element:Ct.el,maxConnections:st},Jt),!1;var _e=A.jsPlumb.getPositionOnElement(Jt,Lt,U),re={};A.jsPlumb.extend(re,Yt.def),re.isTemporarySource=!0,re.anchor=[_e[0],_e[1],0,0],re.dragOptions=le,Yt.def.scope&&(re.scope=Yt.def.scope),Xt=this.addEndpoint(It,re),Ie=!0,Xt.setDeleteOnEmpty(!0),Yt.uniqueEndpoint&&(Yt.endpoint?Xt.finalEndpoint=Yt.endpoint:(Yt.endpoint=Xt,Xt.setDeleteOnEmpty(!1)));var he=function(){t.off(Xt.canvas,"mouseup",he),t.off(Ct.el,"mouseup",he),Ie&&(Ie=!1,t.deleteEndpoint(Xt))};t.on(Xt.canvas,"mouseup",he),t.on(Ct.el,"mouseup",he);var Oe={};if(Yt.def.extract)for(var xe in Yt.def.extract){var He=(Jt.srcElement||Jt.target).getAttribute(xe);He&&(Oe[Yt.def.extract[xe]]=He)}t.trigger(Xt.canvas,"mousedown",Jt,Oe),n.consume(Jt)}}}.bind(this);this.on(Ct.el,"mousedown",Be),Ht.trigger=Be,N.filter&&(n.isString(N.filter)||n.isFunction(N.filter))&&t.setDragFilter(Ct.el,N.filter);var un=A.jsPlumb.extend({},N.dropOptions||{});qt(Ct,N,un,!0,N.isTarget===!0)}.bind(this),mt=l.length&&l.constructor!==String?l:[l],pt=0,wt=mt.length;pt<wt;pt++)ut(y(mt[pt]));return this},this.unmakeSource=function(l,V,S){var N=y(l);t.destroyDroppable(N.el,"internal");var Y=this.sourceEndpointDefinitions[N.id];if(Y){for(var J in Y)if(V==null||V===J){var st=Y[J].trigger;st&&t.off(N.el,"mousedown",st),S||delete this.sourceEndpointDefinitions[N.id][J]}}return this},this.unmakeEverySource=function(){for(var l in this.sourceEndpointDefinitions)t.unmakeSource(l,null,!0);return this.sourceEndpointDefinitions={},this};var se=function(l,V,S){V=n.isArray(V)?V:[V];var N=dt(l);S=S||"default";for(var Y=0;Y<V.length;Y++){var J=this[V[Y]][N];if(J&&J[S])return J[S].def.scope||this.Defaults.Scope}}.bind(this),ce=function(l,V,S,N){S=n.isArray(S)?S:[S];var Y=dt(l);N=N||"default";for(var J=0;J<S.length;J++){var st=this[S[J]][Y];st&&st[N]&&(st[N].def.scope=V)}}.bind(this);this.getScope=function(l,V){return se(l,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(l){return se(l,"sourceEndpointDefinitions")},this.getTargetScope=function(l){return se(l,"targetEndpointDefinitions")},this.setScope=function(l,V,S){this.setSourceScope(l,V,S),this.setTargetScope(l,V,S)},this.setSourceScope=function(l,V,S){ce(l,V,"sourceEndpointDefinitions",S),this.setDragScope(l,V)},this.setTargetScope=function(l,V,S){ce(l,V,"targetEndpointDefinitions",S),this.setDropScope(l,V)},this.unmakeEveryTarget=function(){for(var l in this.targetEndpointDefinitions)t.unmakeTarget(l,!0);return this.targetEndpointDefinitions={},this};var ot=function(l,V,S,N,Y){var J=l==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,st,gt,ut;if(Y=Y||"default",V.length&&!n.isString(V)){st=[];for(var mt=0,pt=V.length;mt<pt;mt++)gt=y(V[mt]),J[gt.id]&&J[gt.id][Y]&&(st[mt]=J[gt.id][Y].enabled,ut=N?!st[mt]:S,J[gt.id][Y].enabled=ut,t[ut?"removeClass":"addClass"](gt.el,"jtk-"+l+"-disabled"))}else{gt=y(V);var wt=gt.id;J[wt]&&J[wt][Y]&&(st=J[wt][Y].enabled,ut=N?!st:S,J[wt][Y].enabled=ut,t[ut?"removeClass":"addClass"](gt.el,"jtk-"+l+"-disabled"))}return st}.bind(this),jt=function(l,V){if(l!=null){if(n.isString(l)||!l.length)return V.apply(this,[l]);if(l.length)return V.apply(this,[l[0]])}}.bind(this);this.toggleSourceEnabled=function(l,V){return ot("source",l,null,!0,V),this.isSourceEnabled(l,V)},this.setSourceEnabled=function(l,V,S){return ot("source",l,V,null,S)},this.isSource=function(l,V){return V=V||"default",jt(l,function(S){var N=this.sourceEndpointDefinitions[y(S).id];return N!=null&&N[V]!=null}.bind(this))},this.isSourceEnabled=function(l,V){return V=V||"default",jt(l,function(S){var N=this.sourceEndpointDefinitions[y(S).id];return N&&N[V]&&N[V].enabled===!0}.bind(this))},this.toggleTargetEnabled=function(l,V){return ot("target",l,null,!0,V),this.isTargetEnabled(l,V)},this.isTarget=function(l,V){return V=V||"default",jt(l,function(S){var N=this.targetEndpointDefinitions[y(S).id];return N!=null&&N[V]!=null}.bind(this))},this.isTargetEnabled=function(l,V){return V=V||"default",jt(l,function(S){var N=this.targetEndpointDefinitions[y(S).id];return N&&N[V]&&N[V].enabled===!0}.bind(this))},this.setTargetEnabled=function(l,V,S){return ot("target",l,V,null,S)},this.ready=function(l){t.bind("ready",l)};var Dt=function(l,V){if(typeof l=="object"&&l.length)for(var S=0,N=l.length;S<N;S++)V(l[S]);else V(l);return t};this.repaint=function(l,V,S){return Dt(l,function(N){E(N,V,S)})},this.revalidate=function(l,V,S){var N=S?l:t.getId(l);t.updateOffset({elId:N,recalc:!0,timestamp:V});var Y=t.getDragManager();return Y&&Y.updateOffsets(N),E(l,null,V)},this.repaintEverything=function(){var l=jsPlumbUtil.uuid(),V;for(V in h)t.updateOffset({elId:V,recalc:!0,timestamp:l});for(V in h)E(V,null,l);return this},this.removeAllEndpoints=function(l,V,S){S=S||[];var N=function(Y){var J=y(Y),st=h[J.id],gt,ut;if(st)for(S.push(J),gt=0,ut=st.length;gt<ut;gt++)t.deleteEndpoint(st[gt],!1);if(delete h[J.id],V&&J.el&&J.el.nodeType!==3&&J.el.nodeType!==8)for(gt=0,ut=J.el.childNodes.length;gt<ut;gt++)N(J.el.childNodes[gt])};return N(l),this};var St=function(l,V){t.removeAllEndpoints(l.id,!0,V);for(var S=t.getDragManager(),N=function(J){S&&S.elementRemoved(J.id),t.router.elementRemoved(J.id),t.isSource(J.el)&&t.unmakeSource(J.el),t.isTarget(J.el)&&t.unmakeTarget(J.el),t.destroyDraggable(J.el),t.destroyDroppable(J.el),delete t.floatingConnections[J.id],delete x[J.id],delete T[J.id],J.el&&(t.removeElement(J.el),J.el._jsPlumb=null)},Y=1;Y<V.length;Y++)N(V[Y]);N(l)};this.remove=function(l,V){var S=y(l),N=[];return S.text&&S.el.parentNode?S.el.parentNode.removeChild(S.el):S.id&&t.batch(function(){St(S,N)},V===!0),t},this.empty=function(l,V){var S=[],N=function(Y,J){var st=y(Y);if(st.text)st.el.parentNode.removeChild(st.el);else if(st.el){for(;st.el.childNodes.length>0;)N(st.el.childNodes[0]);J||St(st,S)}};return t.batch(function(){N(l,!0)},V===!1),t},this.reset=function(l){t.silently(function(){ie=!1,t.removeAllGroups(),t.removeGroupManager(),t.deleteEveryEndpoint(),l||t.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},M.length=0,this.doReset&&this.doReset()}.bind(this))},this.destroy=function(){this.reset(),r=null,p=null};var At=function(l){l.canvas&&l.canvas.parentNode&&l.canvas.parentNode.removeChild(l.canvas),l.cleanup(),l.destroy()};this.clear=function(){t.select().each(At),t.selectEndpoints().each(At),h={},k={}},this.setDefaultScope=function(l){return o=l,t},this.deriveEndpointAndAnchorSpec=function(l,V){for(var S=((V?"":"default ")+l).split(/[\s]/),N=null,Y=null,J=null,st=null,gt=0;gt<S.length;gt++){var ut=t.getType(S[gt],"connection");ut&&(ut.endpoints&&(N=ut.endpoints),ut.endpoint&&(Y=ut.endpoint),ut.anchors&&(st=ut.anchors),ut.anchor&&(J=ut.anchor))}return{endpoints:N||[Y,Y],anchors:st||[J,J]}},this.setId=function(l,V,S){var N;n.isString(l)?N=l:(l=this.getElement(l),N=this.getId(l));var Y=this.getConnections({source:N,scope:"*"},!0),J=this.getConnections({target:N,scope:"*"},!0);V=""+V,S?l=this.getElement(V):(l=this.getElement(N),this.setAttribute(l,"id",V)),h[V]=h[N]||[];for(var st=0,gt=h[V].length;st<gt;st++)h[V][st].setElementId(V),h[V][st].setReferenceElement(l);delete h[N],this.sourceEndpointDefinitions[V]=this.sourceEndpointDefinitions[N],delete this.sourceEndpointDefinitions[N],this.targetEndpointDefinitions[V]=this.targetEndpointDefinitions[N],delete this.targetEndpointDefinitions[N],this.router.changeId(N,V);var ut=this.getDragManager();ut&&ut.changeId(N,V),x[V]=x[N],delete x[N];var mt=function(pt,wt,Ct){for(var It=0,Lt=pt.length;It<Lt;It++)pt[It].endpoints[wt].setElementId(V),pt[It].endpoints[wt].setReferenceElement(l),pt[It][Ct+"Id"]=V,pt[It][Ct]=l};mt(Y,0,"source"),mt(J,1,"target"),this.repaint(V)},this.setDebugLog=function(l){d=l},this.setSuspendDrawing=function(l,V){var S=W;return W=l,l?$=new Date().getTime():$=null,V&&this.repaintEverything(),S},this.isSuspendDrawing=function(){return W},this.getSuspendedAt=function(){return $},this.batch=function(l,V){var S=this.isSuspendDrawing();S||this.setSuspendDrawing(!0);try{l()}catch(N){n.log("Function run while suspended failed",N)}S||this.setSuspendDrawing(!1,!V)},this.doWhileSuspended=this.batch,this.getCachedData=vt,this.show=function(l,V){return lt(l,"block",V),t},this.toggleVisible=bt,this.addListener=this.bind;var Ft=[];this.registerFloatingConnection=function(l,V,S){Ft[l.id]=V,n.addToList(h,l.id,S)},this.getFloatingConnectionFor=function(l){return Ft[l]},this.listManager=new A.jsPlumbListManager(this,this.Defaults.ListStyle)};n.extend(A.jsPlumbInstance,n.EventGenerator,{setAttribute:function(c,t,_){this.setAttribute(c,t,_)},getAttribute:function(c,t){return this.getAttribute(A.jsPlumb.getElement(c),t)},convertToFullOverlaySpec:function(c){return n.isString(c)&&(c=[c,{}]),c[1].id=c[1].id||n.uuid(),c},registerConnectionType:function(c,t){if(this._connectionTypes[c]=A.jsPlumb.extend({},t),t.overlays){for(var _={},j=0;j<t.overlays.length;j++){var L=this.convertToFullOverlaySpec(t.overlays[j]);_[L[1].id]=L}this._connectionTypes[c].overlays=_}},registerConnectionTypes:function(c){for(var t in c)this.registerConnectionType(t,c[t])},registerEndpointType:function(c,t){if(this._endpointTypes[c]=A.jsPlumb.extend({},t),t.overlays){for(var _={},j=0;j<t.overlays.length;j++){var L=this.convertToFullOverlaySpec(t.overlays[j]);_[L[1].id]=L}this._endpointTypes[c].overlays=_}},registerEndpointTypes:function(c){for(var t in c)this.registerEndpointType(t,c[t])},getType:function(c,t){return t==="connection"?this._connectionTypes[c]:this._endpointTypes[c]},setIdChanged:function(c,t){this.setId(c,t,!0)},setParent:function(c,t){var _=this.getElement(c),j=this.getId(_),L=this.getElement(t),U=this.getId(L),y=this.getDragManager();_.parentNode.removeChild(_),L.appendChild(_),y&&y.setParent(_,j,L,U)},extend:function(c,t,_){var j;if(_)for(j=0;j<_.length;j++)c[_[j]]=t[_[j]];else for(j in t)c[j]=t[j];return c},floatingConnections:{},getFloatingAnchorIndex:function(c){return c.endpoints[0].isFloating()?0:c.endpoints[1].isFloating()?1:-1},proxyConnection:function(c,t,_,j,L,U){var y,I=c.endpoints[t].elementId,r=c.endpoints[t];c.proxies=c.proxies||[],c.proxies[t]?y=c.proxies[t].ep:y=this.addEndpoint(_,{endpoint:L(c,t),anchor:U(c,t),parameters:{isProxyEndpoint:!0}}),y.setDeleteOnEmpty(!0),c.proxies[t]={ep:y,originalEp:r},t===0?this.router.sourceOrTargetChanged(I,j,c,_,0):this.router.sourceOrTargetChanged(I,j,c,_,1),r.detachFromConnection(c,null,!0),y.connections=[c],c.endpoints[t]=y,r.setVisible(!1),c.setVisible(!0),this.revalidate(_)},unproxyConnection:function(c,t,_){if(!(c._jsPlumb==null||c.proxies==null||c.proxies[t]==null)){var j=c.proxies[t].originalEp.element,L=c.proxies[t].originalEp.elementId;c.endpoints[t]=c.proxies[t].originalEp,t===0?this.router.sourceOrTargetChanged(_,L,c,j,0):this.router.sourceOrTargetChanged(_,L,c,j,1),c.proxies[t].ep.detachFromConnection(c,null),c.proxies[t].originalEp.addConnection(c),c.isVisible()&&c.proxies[t].originalEp.setVisible(!0),delete c.proxies[t]}}});var v=new D;A.jsPlumb=v,v.getInstance=function(c,t){var _=new D(c);if(t)for(var j in t)_[j]=t[j];return _.init(),_},v.each=function(c,t){if(c!=null)if(typeof c=="string")t(v.getElement(c));else if(c.length!=null)for(var _=0;_<c.length;_++)t(v.getElement(c[_]));else t(c)},B.jsPlumb=v}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F="__label",z=function(s,P){var a={cssClass:P.cssClass,labelStyle:s.labelStyle,id:F,component:s,_jsPlumb:s._jsPlumb.instance},i=n.extend(a,P);return new n.Overlays[s._jsPlumb.instance.getRenderMode()].Label(i)},H=function(s,P){var a=null;if(C.isArray(P)){var i=P[0],m=n.extend({component:s,_jsPlumb:s._jsPlumb.instance},P[1]);P.length===3&&n.extend(m,P[2]),a=new n.Overlays[s._jsPlumb.instance.getRenderMode()][i](m)}else P.constructor===String?a=new n.Overlays[s._jsPlumb.instance.getRenderMode()][P]({component:s,_jsPlumb:s._jsPlumb.instance}):a=P;return a.id=a.id||C.uuid(),s.cacheTypeItem("overlay",a,a.id),s._jsPlumb.overlays[a.id]=a,a};n.OverlayCapableJsPlumbUIComponent=function(s){A.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},s.label&&(this.getDefaultType().overlays[F]=["Label",{label:s.label,location:s.labelLocation||this.defaultLabelLocation||.5,labelStyle:s.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:F}]),this.setListenerComponent=function(P){if(this._jsPlumb)for(var a in this._jsPlumb.overlays)this._jsPlumb.overlays[a].setListenerComponent(P)}},n.OverlayCapableJsPlumbUIComponent.applyType=function(s,P){if(P.overlays){var a={},i;for(i in P.overlays){var m=s._jsPlumb.overlays[P.overlays[i][1].id];if(m)m.updateFrom(P.overlays[i][1]),a[P.overlays[i][1].id]=!0,m.reattach(s._jsPlumb.instance,s);else{var b=s.getCachedTypeItem("overlay",P.overlays[i][1].id);b!=null?(b.reattach(s._jsPlumb.instance,s),b.setVisible(!0),b.updateFrom(P.overlays[i][1]),s._jsPlumb.overlays[b.id]=b):b=s.addOverlay(P.overlays[i],!0),a[b.id]=!0}}for(i in s._jsPlumb.overlays)a[s._jsPlumb.overlays[i].id]==null&&s.removeOverlay(s._jsPlumb.overlays[i].id,!0)}},C.extend(n.OverlayCapableJsPlumbUIComponent,A.jsPlumbUIComponent,{setHover:function(s,P){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var a in this._jsPlumb.overlays)this._jsPlumb.overlays[a][s?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(s,P){var a=H(this,s);if(this.getData&&a.type==="Label"&&C.isArray(s)){var i=this.getData(),m=s[1];if(i){var b=m.labelLocationAttribute||"labelLocation",D=i?i[b]:null;D&&(a.loc=D)}}return P||this.repaint(),a},getOverlay:function(s){return this._jsPlumb.overlays[s]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(s){var P=this.getOverlay(s);P&&P.hide()},hideOverlays:function(){for(var s in this._jsPlumb.overlays)this._jsPlumb.overlays[s].hide()},showOverlay:function(s){var P=this.getOverlay(s);P&&P.show()},showOverlays:function(){for(var s in this._jsPlumb.overlays)this._jsPlumb.overlays[s].show()},removeAllOverlays:function(s){for(var P in this._jsPlumb.overlays)this._jsPlumb.overlays[P].cleanup&&this._jsPlumb.overlays[P].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},s||this.repaint()},removeOverlay:function(s,P){var a=this._jsPlumb.overlays[s];a&&(a.setVisible(!1),!P&&a.cleanup&&a.cleanup(),delete this._jsPlumb.overlays[s],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[s],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[s])},removeOverlays:function(){for(var s=0,P=arguments.length;s<P;s++)this.removeOverlay(arguments[s])},moveParent:function(s){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),s.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),s.appendChild(this.canvas);for(var P in this._jsPlumb.overlays)if(this._jsPlumb.overlays[P].isAppendedAtTopLevel){var a=this._jsPlumb.overlays[P].getElement();a.parentNode.removeChild(a),s.appendChild(a)}}},getLabel:function(){var s=this.getOverlay(F);return s!=null?s.getLabel():null},getLabelOverlay:function(){return this.getOverlay(F)},setLabel:function(s){var P=this.getOverlay(F);if(P)s.constructor===String||s.constructor===Function?P.setLabel(s):(s.label&&P.setLabel(s.label),s.location&&P.setLocation(s.location));else{var a=s.constructor===String||s.constructor===Function?{label:s}:s;P=z(this,a),this._jsPlumb.overlays[F]=P}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(s){for(var P in this._jsPlumb.overlays)this._jsPlumb.overlays[P].cleanup(s),this._jsPlumb.overlays[P].destroy(s);s&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(s){this[s?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(s,P){this._jsPlumb.overlayPositions[s.id]=P},getAbsoluteOverlayPosition:function(s){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[s.id]:null},_clazzManip:function(s,P,a){if(!a)for(var i in this._jsPlumb.overlays)this._jsPlumb.overlays[i][s+"Class"](P)},addClass:function(s,P){this._clazzManip("add",s,P)},removeClass:function(s,P){this._clazzManip("remove",s,P)}})}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F=function(a,i,m){var b=!1;return{drag:function(){if(b)return b=!1,!0;if(i.element){var D=m.getUIPosition(arguments,m.getZoom());D!=null&&m.setPosition(i.element,D),m.repaint(i.element,D),a.paint({anchorPoint:a.anchor.getCurrentLocation({element:a})})}},stopDrag:function(){b=!0}}},z=function(a,i,m,b){var D=i.createElement("div",{position:"absolute"});i.appendElement(D);var v=i.getId(D);i.setPosition(D,m),D.style.width=b[0]+"px",D.style.height=b[1]+"px",i.manage(v,D,!0),a.id=v,a.element=D},H=function(a,i,m,b,D,v,c,t){var _=new n.FloatingAnchor({reference:i,referenceCanvas:b,jsPlumbInstance:v});return c({paintStyle:a,endpoint:m,anchor:_,source:D,scope:t})},s=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],P=function(a,i){var m=0;if(i!=null){for(var b=0;b<a.connections.length;b++)if(a.connections[b].sourceId===i||a.connections[b].targetId===i){m=b;break}}return a.connections[m]};n.Endpoint=function(a){var i=a._jsPlumb,m=a.newConnection,b=a.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:a.connectionType,maxConnections:a.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:a.maxConnections,paintStyle:a.endpointStyle||a.paintStyle||a.style||this._jsPlumb.instance.Defaults.EndpointStyle||n.Defaults.EndpointStyle,hoverPaintStyle:a.endpointHoverStyle||a.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,connectorStyle:a.connectorStyle,connectorHoverStyle:a.connectorHoverStyle,connectorClass:a.connectorClass,connectorHoverClass:a.connectorHoverClass,connectorOverlays:a.connectorOverlays,connector:a.connector,connectorTooltip:a.connectorTooltip}),this._jsPlumb.enabled=a.enabled!==!1,this._jsPlumb.visible=!0,this.element=n.getElement(a.source),this._jsPlumb.uuid=a.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(a.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=a.elementId,this.dragProxy=a.dragProxy,this._jsPlumb.connectionCost=a.connectionCost,this._jsPlumb.connectionsDirected=a.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var D=a.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(y){D=y};var v=function(){var y=i.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var I=i.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(y),this.addClass(I),n.updateClasses(this.element,I,y)}.bind(this);this.prepareAnchor=function(y){var I=this._jsPlumb.instance.makeAnchor(y,this.elementId,i);return I.bind("anchorChanged",function(r){this.fire("anchorChanged",{endpoint:this,anchor:r}),v()}.bind(this)),I},this.setPreparedAnchor=function(y,I){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=y,v(),I||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(y,I){var r=this.prepareAnchor(y);return this.setPreparedAnchor(r,I),this};var c=function(y){if(this.connections.length>0)for(var I=0;I<this.connections.length;I++)this.connections[I].setHover(y,!1);else this.setHover(y)}.bind(this);this.bind("mouseover",function(){c(!0)}),this.bind("mouseout",function(){c(!1)}),a._transient||this._jsPlumb.instance.router.addEndpoint(this,this.elementId),this.prepareEndpoint=function(y,I){var r=function(w,M){var h=i.getRenderMode();if(n.Endpoints[h][w])return new n.Endpoints[h][w](M);if(!i.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+w+"'"}},p={_jsPlumb:this._jsPlumb.instance,cssClass:a.cssClass,container:a.container,tooltip:a.tooltip,connectorTooltip:a.connectorTooltip,endpoint:this},d;return C.isString(y)?d=r(y,p):C.isArray(y)?(p=C.merge(y[1],p),d=r(y[0],p)):d=y.clone(),d.clone=function(){if(C.isString(y))return r(y,p);if(C.isArray(y))return p=C.merge(y[1],p),r(y[0],p)}.bind(this),d.typeId=I,d},this.setEndpoint=function(y,I){var r=this.prepareEndpoint(y);this.setPreparedEndpoint(r,!0)},this.setPreparedEndpoint=function(y,I){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=y,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},n.extend(this,a,s),this.isSource=a.isSource||!1,this.isTemporarySource=a.isTemporarySource||!1,this.isTarget=a.isTarget||!1,this.connections=a.connections||[],this.connectorPointerEvents=a["connector-pointer-events"],this.scope=a.scope||i.getDefaultScope(),this.timestamp=null,this.reattachConnections=a.reattach||i.Defaults.ReattachConnections,this.connectionsDetachable=i.Defaults.ConnectionsDetachable,(a.connectionsDetachable===!1||a.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=a.dragAllowedWhenFull!==!1,a.onMaxConnections&&this.bind("maxConnections",a.onMaxConnections),this.addConnection=function(y){this.connections.push(y),this[(this.connections.length>0?"add":"remove")+"Class"](i.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](i.endpointFullClass)},this.detachFromConnection=function(y,I,r){I=I??this.connections.indexOf(y),I>=0&&(this.connections.splice(I,1),this[(this.connections.length>0?"add":"remove")+"Class"](i.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](i.endpointFullClass)),!r&&D&&this.connections.length===0&&i.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:r!==!0})},this.deleteEveryConnection=function(y){for(var I=this.connections.length,r=0;r<I;r++)i.deleteConnection(this.connections[0],y)},this.detachFrom=function(y,I,r){for(var p=[],d=0;d<this.connections.length;d++)(this.connections[d].endpoints[1]===y||this.connections[d].endpoints[0]===y)&&p.push(this.connections[d]);for(var w=0,M=p.length;w<M;w++)i.deleteConnection(p[0]);return this},this.getElement=function(){return this.element},this.setElement=function(y){var I=this._jsPlumb.instance.getId(y),r=this.elementId;return C.removeWithFunction(a.endpointsByElement[this.elementId],function(p){return p.id===this.id}.bind(this)),this.element=n.getElement(y),this.elementId=i.getId(this.element),i.router.rehomeEndpoint(this,r,this.element),i.dragManager.endpointAdded(this.element),C.addToList(a.endpointsByElement,I,this),this},this.makeInPlaceCopy=function(){var y=this.anchor.getCurrentLocation({element:this}),I=this.anchor.getOrientation(this),r=this.anchor.getCssClass(),p={bind:function(){},compute:function(){return[y[0],y[1]]},getCurrentLocation:function(){return[y[0],y[1]]},getOrientation:function(){return I},getCssClass:function(){return r}};return b({dropOptions:a.dropOptions,anchor:p,source:this.element,paintStyle:this.getPaintStyle(),endpoint:a.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(y){y=y||{};var I=y.timestamp,r=y.recalc!==!1;if(!I||this.timestamp!==I){var p=i.updateOffset({elId:this.elementId,timestamp:I}),d=y.offset?y.offset.o:p.o;if(d!=null){var w=y.anchorPoint,M=y.connectorPaintStyle;if(w==null){var h=y.dimensions||p.s,k={xy:[d.left,d.top],wh:h,element:this,timestamp:I};if(r&&this.anchor.isDynamic&&this.connections.length>0){var x=P(this,y.elementWithPrecedence),T=x.endpoints[0]===this?1:0,f=T===0?x.sourceId:x.targetId,O=i.getCachedData(f),X=O.o,W=O.s;k.index=T===0?1:0,k.connection=x,k.txy=[X.left,X.top],k.twh=W,k.tElement=x.endpoints[T],k.tRotation=i.getRotation(f)}else this.connections.length>0&&(k.connection=this.connections[0]);k.rotation=i.getRotation(this.elementId),w=this.anchor.compute(k)}this.endpoint.compute(w,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,M||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=I;for(var $ in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty($)){var o=this._jsPlumb.overlays[$];o.isVisible()&&(this._jsPlumb.overlayPlacements[$]=o.draw(this.endpoint,this._jsPlumb.paintStyleInUse),o.paint(this._jsPlumb.overlayPlacements[$]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var t=!1;this.initDraggable=function(){if(!t&&n.isDragSupported(this.element)){var y={id:null,element:null},I=null,r=!1,p=null,d=F(this,y,i),w=a.dragOptions||{},M={},h=n.dragEvents.start,k=n.dragEvents.stop,x=n.dragEvents.drag,T=n.dragEvents.beforeStart,f,O=function($){f=$.e.payload||{}},X=function($){I=this.connectorSelector();var o=!0;this.isEnabled()||(o=!1),I==null&&!this.isSource&&!this.isTemporarySource&&(o=!1),this.isSource&&this.isFull()&&!(I!=null&&this.dragAllowedWhenFull)&&(o=!1),I!=null&&!I.isDetachable(this)&&(this.isFull()?o=!1:I=null);var u=i.checkCondition(I==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:I});if(u===!1?o=!1:typeof u=="object"?n.extend(u,f||{}):u=f||{},o===!1)return i.stopDrag&&i.stopDrag(this.canvas),d.stopDrag(),!1;for(var e=0;e<this.connections.length;e++)this.connections[e].setHover(!1);this.addClass("endpointDrag"),i.setConnectionBeingDragged(!0),I&&!this.isFull()&&this.isSource&&(I=null),i.updateOffset({elId:this.elementId});var g=this._jsPlumb.instance.getOffset(this.canvas),E=this.canvas,G=this._jsPlumb.instance.getSize(this.canvas);z(y,i,g,G),i.setAttributes(this.canvas,{dragId:y.id,elId:this.elementId});var R=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var K=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);K.endpoints[1]&&(R=K.endpoints[1])}var q=this._jsPlumb.instance.makeAnchor("Center");q.isFloating=!0,this._jsPlumb.floatingEndpoint=H(this.getPaintStyle(),q,R,this.canvas,y.element,i,b,this.scope);var Q=this._jsPlumb.floatingEndpoint.anchor;if(I==null)this.setHover(!1,!1),I=m({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:y.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:a.connectorStyle,hoverPaintStyle:a.connectorHoverStyle,connector:a.connector,overlays:a.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:a.scope,data:u}),I.pending=!0,I.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.anchor=Q,i.fire("connectionDrag",I),i.router.newConnection(I);else{r=!0,I.setHover(!1);var ct=I.endpoints[0].id===this.id?0:1;this.detachFromConnection(I,null,!0);var at=i.getDragScope(E);i.setAttribute(this.canvas,"originalScope",at),i.fire("connectionDrag",I),ct===0?(p=[I.source,I.sourceId,E,at],i.router.sourceOrTargetChanged(I.endpoints[ct].elementId,y.id,I,y.element,0)):(p=[I.target,I.targetId,E,at],i.router.sourceOrTargetChanged(I.endpoints[ct].elementId,y.id,I,y.element,1)),I.suspendedEndpoint=I.endpoints[ct],I.suspendedElement=I.endpoints[ct].getElement(),I.suspendedElementId=I.endpoints[ct].elementId,I.suspendedElementType=ct===0?"source":"target",I.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=I.suspendedEndpoint,I.endpoints[ct]=this._jsPlumb.floatingEndpoint,I.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.addClass(i.draggingClass)}i.registerFloatingConnection(y,I,this._jsPlumb.floatingEndpoint),i.currentlyDragging=!0}.bind(this),W=function(){if(i.setConnectionBeingDragged(!1),I&&I.endpoints!=null){var $=i.getDropEvent(arguments),o=i.getFloatingAnchorIndex(I);if(I.endpoints[o===0?1:0].anchor.locked=!1,I.removeClass(i.draggingClass),this._jsPlumb&&(I.deleteConnectionNow||I.endpoints[o]===this._jsPlumb.floatingEndpoint)&&r&&I.suspendedEndpoint){o===0?(I.floatingElement=I.source,I.floatingId=I.sourceId,I.floatingEndpoint=I.endpoints[0],I.floatingIndex=0,I.source=p[0],I.sourceId=p[1]):(I.floatingElement=I.target,I.floatingId=I.targetId,I.floatingEndpoint=I.endpoints[1],I.floatingIndex=1,I.target=p[0],I.targetId=p[1]);var u=this._jsPlumb.floatingEndpoint;i.setDragScope(p[2],p[3]),I.endpoints[o]=I.suspendedEndpoint,I.isReattach()||I._forceReattach||I._forceDetach||!i.deleteConnection(I,{originalEvent:$})?(I.setHover(!1),I._forceDetach=null,I._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(I),I.suspendedEndpoint.addConnection(I),o===1?i.router.sourceOrTargetChanged(I.floatingId,I.targetId,I,I.target,o):i.router.sourceOrTargetChanged(I.floatingId,I.sourceId,I,I.source,o),i.repaint(p[1])):i.deleteObject({endpoint:u})}this.deleteAfterDragStop?i.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),i.fire("connectionDragStop",I,$),I.pending&&i.fire("connectionAborted",I,$),i.currentlyDragging=!1,I.suspendedElement=null,I.suspendedEndpoint=null,I=null}y&&y.element&&i.remove(y.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);w=n.extend(M,w),w.scope=this.scope||w.scope,w[T]=C.wrap(w[T],O,!1),w[h]=C.wrap(w[h],X,!1),w[x]=C.wrap(w[x],d.drag),w[k]=C.wrap(w[k],W),w.multipleDrop=!1,w.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this),i.initDraggable(this.canvas,w,"internal"),this.canvas._jsPlumbRelatedElement=this.element,t=!0}};var _=a.endpoint||this._jsPlumb.instance.Defaults.Endpoint||n.Defaults.Endpoint;this.setEndpoint(_,!0);var j=a.anchor?a.anchor:a.anchors?a.anchors:i.Defaults.Anchor||"Top";this.setAnchor(j,!0);var L=["default",a.type||""].join(" ");this.addType(L,a.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var U=function(y,I,r,p){if(n.isDropSupported(this.element)){var d=a.dropOptions||i.Defaults.DropOptions||n.Defaults.DropOptions;d=n.extend({},d),d.scope=d.scope||this.scope;var w=n.dragEvents.drop,M=n.dragEvents.over,h=n.dragEvents.out,k=this,x=i.EndpointDropHandler({getEndpoint:function(){return k},jsPlumb:i,enabled:function(){return r!=null?r.isEnabled():!0},isFull:function(){return r.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(T){k.addClass(T)},removeClass:function(T){k.removeClass(T)},isDropAllowed:function(){return k.isDropAllowed.apply(k,arguments)},reference:p,isRedrop:function(T,f){return T.suspendedEndpoint&&f.reference&&T.suspendedEndpoint.id===f.reference.id}});d[w]=C.wrap(d[w],x,!0),d[M]=C.wrap(d[M],function(){var T=n.getDragObject(arguments),f=i.getAttribute(n.getElement(T),"dragId"),O=i.getFloatingConnectionFor(f);if(O!=null){var X=i.getFloatingAnchorIndex(O),W=this.isTarget&&X!==0||O.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===O.suspendedEndpoint.id;if(W){var $=i.checkCondition("checkDropAllowed",{sourceEndpoint:O.endpoints[X],targetEndpoint:this,connection:O});this[($?"add":"remove")+"Class"](i.endpointDropAllowedClass),this[($?"remove":"add")+"Class"](i.endpointDropForbiddenClass),O.endpoints[X].anchor.over(this.anchor,this)}}}.bind(this)),d[h]=C.wrap(d[h],function(){var T=n.getDragObject(arguments),f=T==null?null:i.getAttribute(n.getElement(T),"dragId"),O=f?i.getFloatingConnectionFor(f):null;if(O!=null){var X=i.getFloatingAnchorIndex(O),W=this.isTarget&&X!==0||O.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===O.suspendedEndpoint.id;W&&(this.removeClass(i.endpointDropAllowedClass),this.removeClass(i.endpointDropForbiddenClass),O.endpoints[X].anchor.out())}}.bind(this)),i.initDroppable(y,d,"internal",I)}}.bind(this);return this.anchor.isFloating||U(this.canvas,!(a._transient||this.anchor.isFloating),this,a.reference),this},C.extend(n.Endpoint,n.OverlayCapableJsPlumbUIComponent,{setVisible:function(a,i,m){if(this._jsPlumb.visible=a,this.canvas&&(this.canvas.style.display=a?"block":"none"),this[a?"showOverlays":"hideOverlays"](),!i){for(var b=0;b<this.connections.length;b++)if(this.connections[b].setVisible(a),!m){var D=this===this.connections[b].endpoints[0]?1:0;this.connections[b].endpoints[D].connections.length===1&&this.connections[b].endpoints[D].setVisible(a,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(a,i){this.setPaintStyle(a.endpointStyle||a.paintStyle,i),this.setHoverPaintStyle(a.endpointHoverStyle||a.hoverPaintStyle,i),a.maxConnections!=null&&(this._jsPlumb.maxConnections=a.maxConnections),a.scope&&(this.scope=a.scope),n.extend(this,a,s),a.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,a.cssClass),n.OverlayCapableJsPlumbUIComponent.applyType(this,a)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(a){this._jsPlumb.enabled=a},cleanup:function(){var a=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");n.removeClass(this.element,a),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(a){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(a)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(a){var i=!1;if(a){for(var m=0;m<this.connections.length;m++)if(this.connections[m].endpoints[1]===a||this.connections[m].endpoints[0]===a){i=!0;break}}return i},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(a){this._jsPlumb.connectionCost=a},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(a){this._jsPlumb.connectionsDirected=a},setElementId:function(a){this.elementId=a,this.anchor.elementId=a},setReferenceElement:function(a){this.element=n.getElement(a)},setDragAllowedWhenFull:function(a){this.dragAllowedWhenFull=a},equals:function(a){return this.anchor.equals(a.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(a){return this.anchor.compute(a)}}),A.jsPlumbInstance.prototype.EndpointDropHandler=function(a){return function(i){var m=a.jsPlumb;a.removeClass(m.endpointDropAllowedClass),a.removeClass(m.endpointDropForbiddenClass);var b=m.getDropEvent(arguments),D=m.getDragObject(arguments),v=m.getAttribute(D,"dragId");m.getAttribute(D,"elId");var c=m.getAttribute(D,"originalScope"),t=m.getFloatingConnectionFor(v);if(t!=null){var _=t.suspendedEndpoint!=null;if(!(_&&t.suspendedEndpoint._jsPlumb==null)){var j=a.getEndpoint(t);if(j!=null){if(a.isRedrop(t,a)){t._forceReattach=!0,t.setHover(!1),a.maybeCleanup&&a.maybeCleanup(j);return}var L=m.getFloatingAnchorIndex(t);if(L===0&&!a.isSource||L===1&&!a.isTarget){a.maybeCleanup&&a.maybeCleanup(j);return}a.onDrop&&a.onDrop(t),c&&m.setDragScope(D,c);var U=a.isFull(i);if(U&&j.fire("maxConnections",{endpoint:this,connection:t,maxConnections:j._jsPlumb.maxConnections},b),!U&&a.enabled()){var y=!0;L===0?(t.floatingElement=t.source,t.floatingId=t.sourceId,t.floatingEndpoint=t.endpoints[0],t.floatingIndex=0,t.source=a.element,t.sourceId=m.getId(a.element)):(t.floatingElement=t.target,t.floatingId=t.targetId,t.floatingEndpoint=t.endpoints[1],t.floatingIndex=1,t.target=a.element,t.targetId=m.getId(a.element)),_&&t.suspendedEndpoint.id!==j.id&&(!t.isDetachAllowed(t)||!t.endpoints[L].isDetachAllowed(t)||!t.suspendedEndpoint.isDetachAllowed(t)||!m.checkCondition("beforeDetach",t))&&(y=!1);var I=function(p){t.endpoints[L].detachFromConnection(t),t.suspendedEndpoint&&t.suspendedEndpoint.detachFromConnection(t),t.endpoints[L]=j,j.addConnection(t);var d=j.getParameters();for(var w in d)t.setParameter(w,d[w]);if(!_)d.draggable&&m.initDraggable(this.element,a.dragOptions,"internal",m);else{var M=t.suspendedEndpoint.elementId;m.fireMoveEvent({index:L,originalSourceId:L===0?M:t.sourceId,newSourceId:L===0?j.elementId:t.sourceId,originalTargetId:L===1?M:t.targetId,newTargetId:L===1?j.elementId:t.targetId,originalSourceEndpoint:L===0?t.suspendedEndpoint:t.endpoints[0],newSourceEndpoint:L===0?j:t.endpoints[0],originalTargetEndpoint:L===1?t.suspendedEndpoint:t.endpoints[1],newTargetEndpoint:L===1?j:t.endpoints[1],connection:t},b)}if(L===1?m.router.sourceOrTargetChanged(t.floatingId,t.targetId,t,t.target,1):m.router.sourceOrTargetChanged(t.floatingId,t.sourceId,t,t.source,0),t.endpoints[0].finalEndpoint){var h=t.endpoints[0];h.detachFromConnection(t),t.endpoints[0]=t.endpoints[0].finalEndpoint,t.endpoints[0].addConnection(t)}C.isObject(p)&&t.mergeData(p),m.finaliseConnection(t,null,b,!1),t.setHover(!1),m.revalidate(t.endpoints[0].element)}.bind(this),r=function(){t.suspendedEndpoint&&(t.endpoints[L]=t.suspendedEndpoint,t.setHover(!1),t._forceDetach=!0,L===0?(t.source=t.suspendedEndpoint.element,t.sourceId=t.suspendedEndpoint.elementId):(t.target=t.suspendedEndpoint.element,t.targetId=t.suspendedEndpoint.elementId),t.suspendedEndpoint.addConnection(t),L===1?m.router.sourceOrTargetChanged(t.floatingId,t.targetId,t,t.target,1):m.router.sourceOrTargetChanged(t.floatingId,t.sourceId,t,t.source,0),m.repaint(t.sourceId),t._forceDetach=!1)};if(y=y&&a.isDropAllowed(t.sourceId,t.targetId,t.scope,t,j),y)return I(y),!0;r()}a.maybeCleanup&&a.maybeCleanup(j),m.currentlyDragging=!1}}}}}}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F=function(s,P,a,i,m){if(n.Connectors[P]=n.Connectors[P]||{},n.Connectors[P][a]==null){if(n.Connectors[a]==null){if(s.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+a+"'")}n.Connectors[P][a]=function(){n.Connectors[a].apply(this,arguments),n.ConnectorRenderers[P].apply(this,arguments)},C.extend(n.Connectors[P][a],[n.Connectors[a],n.ConnectorRenderers[P]])}return new n.Connectors[P][a](i,m)},z=function(s,P,a){return s?a.makeAnchor(s,P,a):null},H=function(s,P,a,i){P!=null&&(P._jsPlumbConnections=P._jsPlumbConnections||{},i?delete P._jsPlumbConnections[s.id]:P._jsPlumbConnections[s.id]=!0,C.isEmpty(P._jsPlumbConnections)?a.removeClass(P,a.connectedClass):a.addClass(P,a.connectedClass))};n.Connection=function(s){var P=s.newEndpoint;this.id=s.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=s.previousConnection,this.source=n.getElement(s.source),this.target=n.getElement(s.target),n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),s.sourceEndpoint?(this.source=s.sourceEndpoint.getElement(),this.sourceId=s.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),s.targetEndpoint?(this.target=s.targetEndpoint.getElement(),this.targetId=s.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=s.scope,this.endpoints=[],this.endpointStyles=[];var a=this._jsPlumb.instance;a.manage(this.sourceId,this.source),a.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:s.cssClass,container:s.container,"pointer-events":s["pointer-events"],editorParams:s.editorParams,overlays:s.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(w,M,h,k,x){return h=h||this._jsPlumb.instance.getId(M),this.prepareEndpoint(a,P,this,k,w?0:1,s,M,h,x)},s.type&&(s.endpoints=s.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(s.type).endpoints);var i=this.makeEndpoint(!0,this.source,this.sourceId,s.sourceEndpoint),m=this.makeEndpoint(!1,this.target,this.targetId,s.targetEndpoint);i&&C.addToList(s.endpointsByElement,this.sourceId,i),m&&C.addToList(s.endpointsByElement,this.targetId,m),this.scope||(this.scope=this.endpoints[0].scope),s.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(s.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(s.deleteEndpointsOnEmpty));var b=a.Defaults.ConnectionsDetachable;s.detachable===!1&&(b=!1),this.endpoints[0].connectionsDetachable===!1&&(b=!1),this.endpoints[1].connectionsDetachable===!1&&(b=!1);var D=s.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||a.Defaults.ReattachConnections;this.appendToDefaultType({detachable:b,reattach:D,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||s.paintStyle||a.Defaults.PaintStyle||n.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||s.hoverPaintStyle||a.Defaults.HoverPaintStyle||n.Defaults.HoverPaintStyle});var v=a.getSuspendedAt();if(!a.isSuspendDrawing()){var c=a.getCachedData(this.sourceId),t=c.o,_=c.s,j=a.getCachedData(this.targetId),L=j.o,U=j.s,y=v||jsPlumbUtil.uuid(),I=this.endpoints[0].anchor.compute({xy:[t.left,t.top],wh:_,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[L.left,L.top],twh:U,tElement:this.endpoints[1],timestamp:y,rotation:a.getRotation(this.endpoints[0].elementId)});this.endpoints[0].paint({anchorLoc:I,timestamp:y}),I=this.endpoints[1].anchor.compute({xy:[L.left,L.top],wh:U,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[t.left,t.top],twh:_,tElement:this.endpoints[0],timestamp:y,rotation:a.getRotation(this.endpoints[1].elementId)}),this.endpoints[1].paint({anchorLoc:I,timestamp:y})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(w){return this._jsPlumb.detachable===!1?!1:w!=null?w.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(w){this._jsPlumb.detachable=w===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(w){this._jsPlumb.reattach=w===!0},this._jsPlumb.cost=s.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=s.directed,s.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var r=n.extend({},this.endpoints[1].getParameters());n.extend(r,this.endpoints[0].getParameters()),n.extend(r,this.getParameters()),this.setParameters(r),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||s.connector||a.Defaults.Connector||n.Defaults.Connector,!0);var p=s.data==null||!C.isObject(s.data)?{}:s.data;this.getData=function(){return p},this.setData=function(w){p=w||{}},this.mergeData=function(w){p=n.extend(p,w)};var d=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,s.type].join(" ");/[^\s]/.test(d)&&this.addType(d,s.data,!0),this.updateConnectedClass()},C.extend(n.Connection,n.OverlayCapableJsPlumbUIComponent,{applyType:function(s,P,a){var i=null;s.connector!=null&&(i=this.getCachedTypeItem("connector",a.connector),i==null&&(i=this.prepareConnector(s.connector,a.connector),this.cacheTypeItem("connector",i,a.connector)),this.setPreparedConnector(i)),s.detachable!=null&&this.setDetachable(s.detachable),s.reattach!=null&&this.setReattach(s.reattach),s.scope&&(this.scope=s.scope),s.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,s.cssClass);var m=null;s.anchor?(m=this.getCachedTypeItem("anchors",a.anchor),m==null&&(m=[this._jsPlumb.instance.makeAnchor(s.anchor),this._jsPlumb.instance.makeAnchor(s.anchor)],this.cacheTypeItem("anchors",m,a.anchor))):s.anchors&&(m=this.getCachedTypeItem("anchors",a.anchors),m==null&&(m=[this._jsPlumb.instance.makeAnchor(s.anchors[0]),this._jsPlumb.instance.makeAnchor(s.anchors[1])],this.cacheTypeItem("anchors",m,a.anchors))),m!=null&&(this.endpoints[0].anchor=m[0],this.endpoints[1].anchor=m[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),n.OverlayCapableJsPlumbUIComponent.applyType(this,s)},addClass:function(s,P){P&&(this.endpoints[0].addClass(s),this.endpoints[1].addClass(s),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(s)),this.connector&&this.connector.addClass(s)},removeClass:function(s,P){P&&(this.endpoints[0].removeClass(s),this.endpoints[1].removeClass(s),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(s)),this.connector&&this.connector.removeClass(s)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(s){this._jsPlumb.visible=s,this.connector&&this.connector.setVisible(s),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(s){this._jsPlumb&&(H(this,this.source,this._jsPlumb.instance,s),H(this,this.target,this._jsPlumb.instance,s))},setHover:function(s){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(s),A.jsPlumb[s?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),A.jsPlumb[s?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(s){this._jsPlumb.cost=s},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(s,P){var a={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},i=this._jsPlumb.instance.getRenderMode(),m;return C.isString(s)?m=F(this._jsPlumb.instance,i,s,a,this):C.isArray(s)&&(s.length===1?m=F(this._jsPlumb.instance,i,s[0],a,this):m=F(this._jsPlumb.instance,i,s[0],C.merge(s[1],a),this)),P!=null&&(m.typeId=P),m},setPreparedConnector:function(s,P,a,i){if(this.connector!==s){var m,b="";if(this.connector!=null&&(m=this.connector,b=m.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=s,i&&this.cacheTypeItem("connector",s,i),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(b),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),m!=null)for(var D=this.getOverlays(),v=0;v<D.length;v++)D[v].transfer&&D[v].transfer(this.connector);a||this.setListenerComponent(this.connector),P||this.repaint()}},setConnector:function(s,P,a,i){var m=this.prepareConnector(s,i);this.setPreparedConnector(m,P,a,i)},paint:function(s){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){s=s||{};var P=s.timestamp,a=!1,i=a?this.sourceId:this.targetId,m=a?this.targetId:this.sourceId,b=a?0:1,D=a?1:0;if(P==null||P!==this._jsPlumb.lastPaintedAt){var v=this._jsPlumb.instance.updateOffset({elId:m}).o,c=this._jsPlumb.instance.updateOffset({elId:i}).o,t=this.endpoints[D],_=this.endpoints[b],j=t.anchor.getCurrentLocation({xy:[v.left,v.top],wh:[v.width,v.height],element:t,timestamp:P,rotation:this._jsPlumb.instance.getRotation(this.sourceId)}),L=_.anchor.getCurrentLocation({xy:[c.left,c.top],wh:[c.width,c.height],element:_,timestamp:P,rotation:this._jsPlumb.instance.getRotation(this.targetId)});this.connector.resetBounds(),this.connector.compute({sourcePos:j,targetPos:L,sourceOrientation:t.anchor.getOrientation(t),targetOrientation:_.anchor.getOrientation(_),sourceEndpoint:this.endpoints[D],targetEndpoint:this.endpoints[b],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:v,targetInfo:c});var U={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var y in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(y)){var I=this._jsPlumb.overlays[y];I.isVisible()&&(this._jsPlumb.overlayPlacements[y]=I.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(I)),U.minX=Math.min(U.minX,this._jsPlumb.overlayPlacements[y].minX),U.maxX=Math.max(U.maxX,this._jsPlumb.overlayPlacements[y].maxX),U.minY=Math.min(U.minY,this._jsPlumb.overlayPlacements[y].minY),U.maxY=Math.max(U.maxY,this._jsPlumb.overlayPlacements[y].maxY))}var r=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,p=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),d={xmin:Math.min(this.connector.bounds.minX-(r+p),U.minX),ymin:Math.min(this.connector.bounds.minY-(r+p),U.minY),xmax:Math.max(this.connector.bounds.maxX+(r+p),U.maxX),ymax:Math.max(this.connector.bounds.maxY+(r+p),U.maxY)};this.connector.paintExtents=d,this.connector.paint(this._jsPlumb.paintStyleInUse,null,d);for(var w in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(w)){var M=this._jsPlumb.overlays[w];M.isVisible()&&M.paint(this._jsPlumb.overlayPlacements[w],d)}}this._jsPlumb.lastPaintedAt=P}},repaint:function(s){var P=jsPlumb.extend(s||{},{});P.elId=this.sourceId,this.paint(P)},prepareEndpoint:function(s,P,a,i,m,b,D,v,c){var t;if(i)a.endpoints[m]=i,i.addConnection(a);else{b.endpoints||(b.endpoints=[null,null]);var _=c||b.endpoints[m]||b.endpoint||s.Defaults.Endpoints[m]||n.Defaults.Endpoints[m]||s.Defaults.Endpoint||n.Defaults.Endpoint;b.endpointStyles||(b.endpointStyles=[null,null]),b.endpointHoverStyles||(b.endpointHoverStyles=[null,null]);var j=b.endpointStyles[m]||b.endpointStyle||s.Defaults.EndpointStyles[m]||n.Defaults.EndpointStyles[m]||s.Defaults.EndpointStyle||n.Defaults.EndpointStyle;j.fill==null&&b.paintStyle!=null&&(j.fill=b.paintStyle.stroke),j.outlineStroke==null&&b.paintStyle!=null&&(j.outlineStroke=b.paintStyle.outlineStroke),j.outlineWidth==null&&b.paintStyle!=null&&(j.outlineWidth=b.paintStyle.outlineWidth);var L=b.endpointHoverStyles[m]||b.endpointHoverStyle||s.Defaults.EndpointHoverStyles[m]||n.Defaults.EndpointHoverStyles[m]||s.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle;b.hoverPaintStyle!=null&&(L==null&&(L={}),L.fill==null&&(L.fill=b.hoverPaintStyle.stroke));var U=b.anchors?b.anchors[m]:b.anchor?b.anchor:z(s.Defaults.Anchors[m],v,s)||z(n.Defaults.Anchors[m],v,s)||z(s.Defaults.Anchor,v,s)||z(n.Defaults.Anchor,v,s),y=b.uuids?b.uuids[m]:null;t=P({paintStyle:j,hoverPaintStyle:L,endpoint:_,connections:[a],uuid:y,anchor:U,source:D,scope:b.scope,reattach:b.reattach||s.Defaults.ReattachConnections,detachable:b.detachable||s.Defaults.ConnectionsDetachable}),i==null&&t.setDeleteOnEmpty(!0),a.endpoints[m]=t,b.drawEndpoints===!1&&t.setVisible(!1,!0,!0)}return t},replaceEndpoint:function(s,P){var a=this.endpoints[s],i=a.elementId,m=this._jsPlumb.instance.getEndpoints(i),b=m.indexOf(a),D=this.makeEndpoint(s===0,a.element,i,null,P);this.endpoints[s]=D,m.splice(b,1,D),this._jsPlumb.instance.deleteObject({endpoint:a,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:a,current:D}),this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId,this.endpoints[1].elementId,this,this.endpoints[1].element,1)}})}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumbUtil,C=A.jsPlumb;C.AnchorManager=function(s){var P={},a={},i={},m={},b=this,D={},v=s.jsPlumbInstance,c={},t=function(d,w,M,h,k,x,T,f){for(var O=[],X=w[k?0:1]/(h.length+1),W=0;W<h.length;W++){var $=(W+1)*X,o=x*w[k?1:0];T&&($=w[k?0:1]-$);var u=k?$:o,e=M.left+u,g=u/w[0],E=k?o:$,G=M.top+E,R=E/w[1];if(f!==0){var K=jsPlumbUtil.rotatePoint([e,G],[M.centerx,M.centery],f);e=K[0],G=K[1]}O.push([e,G,g,R,h[W][1],h[W][2]])}return O},_=function(d,w){return w[0][0]-d[0][0]},j=function(d,w){var M=d[0][0]<0?-Math.PI-d[0][0]:Math.PI-d[0][0],h=w[0][0]<0?-Math.PI-w[0][0]:Math.PI-w[0][0];return M-h},L={top:j,right:_,bottom:_,left:j},U=function(d,w){return d.sort(w)},y=function(d,w){var M=v.getCachedData(d),h=M.s,k=M.o,x=function(T,f,O,X,W,$,o){if(X.length>0)for(var u=U(X,L[T]),e=T==="right"||T==="top",g=v.getRotation(d),E=t(T,f,O,u,W,$,e,g),G=function(ct,at){a[ct.id]=[at[0],at[1],at[2],at[3]],i[ct.id]=o},R=0;R<E.length;R++){var K=E[R][4],q=K.endpoints[0].elementId===d,Q=K.endpoints[1].elementId===d;q&&G(K.endpoints[0],E[R]),Q&&G(K.endpoints[1],E[R])}};x("bottom",h,k,w.bottom,!0,1,[0,1]),x("top",h,k,w.top,!0,0,[0,-1]),x("left",h,k,w.left,!1,0,[-1,0]),x("right",h,k,w.right,!1,1,[1,0])};this.reset=function(){P={},m={},D={}},this.addFloatingConnection=function(d,w){c[d]=w},this.newConnection=function(d){var w=d.sourceId,M=d.targetId,h=d.endpoints,k=!0,x=function(T,f,O,X,W){w===M&&O.isContinuous&&(d._jsPlumb.instance.removeElement(h[1].canvas),k=!1),n.addToList(m,X,[W,f,O.constructor===C.DynamicAnchor])};x(0,h[0],h[0].anchor,M,d),k&&x(1,h[1],h[1].anchor,w,d)};var I=function(d){(function(w,M){if(w){var h=function(k){return k[4]===M};n.removeWithFunction(w.top,h),n.removeWithFunction(w.left,h),n.removeWithFunction(w.bottom,h),n.removeWithFunction(w.right,h)}})(D[d.elementId],d.id)};this.connectionDetached=function(d,w){var M=d.connection||d,h=d.sourceId,k=d.targetId,x=M.endpoints,T=function(f,O,X,W,$){n.removeWithFunction(m[W],function(o){return o[0].id===$.id})};T(1,x[1],x[1].anchor,h,M),T(0,x[0],x[0].anchor,k,M),M.floatingId&&(T(M.floatingIndex,M.floatingEndpoint,M.floatingEndpoint.anchor,M.floatingId,M),I(M.floatingEndpoint)),I(M.endpoints[0]),I(M.endpoints[1]),w||(b.redraw(M.sourceId),M.targetId!==M.sourceId&&b.redraw(M.targetId))},this.addEndpoint=function(d,w){n.addToList(P,w,d)},this.changeId=function(d,w){m[w]=m[d],P[w]=P[d],delete m[d],delete P[d]},this.getConnectionsFor=function(d){return m[d]||[]},this.getEndpointsFor=function(d){return P[d]||[]},this.deleteEndpoint=function(d){n.removeWithFunction(P[d.elementId],function(w){return w.id===d.id}),I(d)},this.elementRemoved=function(d){delete c[d],delete P[d],P[d]=[]};var r=function(d,w,M,h,k,x,T,f,O,X,W,$){var o=-1,u=h.endpoints[T],e=u.id,g=[1,0][T],E=[[w,M],h,k,x,e],G=d[O],R=u._continuousAnchorEdge?d[u._continuousAnchorEdge]:null,K,q;if(R){var Q=n.findWithFunction(R,function(at){return at[4]===e});if(Q!==-1)for(R.splice(Q,1),K=0;K<R.length;K++)q=R[K][1],n.addWithFunction(W,q,function(at){return at.id===q.id}),n.addWithFunction($,R[K][1].endpoints[T],function(at){return at.id===q.endpoints[T].id}),n.addWithFunction($,R[K][1].endpoints[g],function(at){return at.id===q.endpoints[g].id})}for(K=0;K<G.length;K++)q=G[K][1],s.idx===1&&G[K][3]===x&&o===-1&&(o=K),n.addWithFunction(W,q,function(at){return at.id===q.id}),n.addWithFunction($,G[K][1].endpoints[T],function(at){return at.id===q.endpoints[T].id}),n.addWithFunction($,G[K][1].endpoints[g],function(at){return at.id===q.endpoints[g].id});{var ct=f?o!==-1?o:0:G.length;G.splice(ct,0,E)}u._continuousAnchorEdge=O};this.sourceOrTargetChanged=function(d,w,M,h,k){if(k===0){if(d!==w){M.sourceId=w,M.source=h,n.removeWithFunction(m[d],function(X){return X[0].id===M.id});var x=n.findWithFunction(m[M.targetId],function(X){return X[0].id===M.id});x>-1&&(m[M.targetId][x][0]=M,m[M.targetId][x][1]=M.endpoints[0],m[M.targetId][x][2]=M.endpoints[0].anchor.constructor===C.DynamicAnchor),n.addToList(m,w,[M,M.endpoints[1],M.endpoints[1].anchor.constructor===C.DynamicAnchor]),M.endpoints[1].anchor.isContinuous&&(M.source===M.target?M._jsPlumb.instance.removeElement(M.endpoints[1].canvas):M.endpoints[1].canvas.parentNode==null&&M._jsPlumb.instance.appendElement(M.endpoints[1].canvas)),M.updateConnectedClass()}}else if(k===1){var T=M.endpoints[0].elementId;M.target=h,M.targetId=w;var f=n.findWithFunction(m[T],function(X){return X[0].id===M.id}),O=n.findWithFunction(m[d],function(X){return X[0].id===M.id});f!==-1&&(m[T][f][0]=M,m[T][f][1]=M.endpoints[1],m[T][f][2]=M.endpoints[1].anchor.constructor===C.DynamicAnchor),O>-1&&(m[d].splice(O,1),n.addToList(m,w,[M,M.endpoints[0],M.endpoints[0].anchor.constructor===C.DynamicAnchor])),M.updateConnectedClass()}},this.rehomeEndpoint=function(d,w,M){var h=P[w]||[],k=v.getId(M);if(k!==w){var x=h.indexOf(d);if(x>-1){var T=h.splice(x,1)[0];b.add(T,k)}}for(var f=0;f<d.connections.length;f++)d.connections[f].sourceId===w?b.sourceOrTargetChanged(w,d.elementId,d.connections[f],d.element,0):d.connections[f].targetId===w&&b.sourceOrTargetChanged(w,d.elementId,d.connections[f],d.element,1)},this.redraw=function(d,w,M,h,k,x){var T=[],f=[],O=[];if(!v.isSuspendDrawing()){var X=P[d]||[],W=m[d]||[];M=M||jsPlumbUtil.uuid(),h=h||{left:0,top:0},w&&(w={left:w.left+h.left,top:w.top+h.top});for(var $=v.updateOffset({elId:d,offset:w,recalc:!1,timestamp:M}),o={},u=0;u<W.length;u++){var e=W[u][0],g=e.sourceId,E=e.targetId,G=e.endpoints[0].anchor.isContinuous,R=e.endpoints[1].anchor.isContinuous;if(G||R){var K=g+"_"+E,q=o[K],Q=e.sourceId===d?1:0,ct=v.getRotation(E),at=v.getRotation(g);G&&!D[g]&&(D[g]={top:[],right:[],bottom:[],left:[]}),R&&!D[E]&&(D[E]={top:[],right:[],bottom:[],left:[]}),d!==E&&v.updateOffset({elId:E,timestamp:M}),d!==g&&v.updateOffset({elId:g,timestamp:M});var rt=v.getCachedData(E),lt=v.getCachedData(g);E===g&&(G||R)?(r(D[g],-Math.PI/2,0,e,!1,E,0,!1,"top",g,T,f),r(D[E],-Math.PI/2,0,e,!1,g,1,!1,"top",E,T,f)):(q||(q=this.calculateOrientation(g,E,lt.o,rt.o,e.endpoints[0].anchor,e.endpoints[1].anchor,e,at,ct),o[K]=q),G&&r(D[g],q.theta,0,e,!1,E,0,!1,q.a[0],g,T,f),R&&r(D[E],q.theta2,-1,e,!0,g,1,!0,q.a[1],E,T,f)),G&&n.addWithFunction(O,g,function(yt){return yt===g}),R&&n.addWithFunction(O,E,function(yt){return yt===E}),n.addWithFunction(T,e,function(yt){return yt.id===e.id}),(G&&Q===0||R&&Q===1)&&n.addWithFunction(f,e.endpoints[Q],function(yt){return yt.id===e.endpoints[Q].id})}}for(u=0;u<X.length;u++)X[u].connections.length===0&&X[u].anchor.isContinuous&&(D[d]||(D[d]={top:[],right:[],bottom:[],left:[]}),r(D[d],-Math.PI/2,0,{endpoints:[X[u],X[u]],paint:function(){}},!1,d,0,!1,X[u].anchor.getDefaultFace(),d,T,f),n.addWithFunction(O,d,function(yt){return yt===d}));for(u=0;u<O.length;u++)y(O[u],D[O[u]]);for(u=0;u<X.length;u++)X[u].paint({timestamp:M,offset:$,dimensions:$.s,recalc:x!==!0});for(u=0;u<f.length;u++){var bt=v.getCachedData(f[u].elementId);f[u].paint({timestamp:null,offset:bt,dimensions:bt.s})}for(u=0;u<W.length;u++){var vt=W[u][1];if(vt.anchor.constructor===C.DynamicAnchor){vt.paint({elementWithPrecedence:d,timestamp:M}),n.addWithFunction(T,W[u][0],function(yt){return yt.id===W[u][0].id});for(var dt=0;dt<vt.connections.length;dt++)vt.connections[dt]!==W[u][0]&&n.addWithFunction(T,vt.connections[dt],function(yt){return yt.id===vt.connections[dt].id})}else n.addWithFunction(T,W[u][0],function(yt){return yt.id===W[u][0].id})}var Et=c[d];for(Et&&Et.paint({timestamp:M,recalc:!1,elId:d}),u=0;u<T.length;u++)T[u].paint({elId:d,timestamp:null,recalc:!1,clearEdits:k})}return{c:T,e:f}};var p=function(d){n.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var w=d.faces||["top","right","bottom","left"],M=d.clockwise!==!1,h={},k={top:"bottom",right:"left",left:"right",bottom:"top"},x={top:"right",right:"bottom",left:"top",bottom:"left"},T={top:"left",right:"top",left:"bottom",bottom:"right"},f=M?x:T,O=M?T:x,X=d.cssClass||"",W=null,$=null,o=["left","right"],u=["top","bottom"],e=null,g=0;g<w.length;g++)h[w[g]]=!0;this.getDefaultFace=function(){return w.length===0?"top":w[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(E){return h[E]?E:h[k[E]]?k[E]:h[f[E]]?f[E]:h[O[E]]?O[E]:E},this.isEdgeSupported=function(E){return e==null?$==null?h[E]===!0:$===E:e.indexOf(E)!==-1},this.setCurrentFace=function(E,G){W=E,G&&$!=null&&($=W)},this.getCurrentFace=function(){return W},this.getSupportedFaces=function(){var E=[];for(var G in h)h[G]&&E.push(G);return E},this.lock=function(){$=W},this.unlock=function(){$=null},this.isLocked=function(){return $!=null},this.lockCurrentAxis=function(){W!=null&&(e=W==="left"||W==="right"?o:u)},this.unlockCurrentAxis=function(){e=null},this.compute=function(E){return a[E.element.id]||[0,0]},this.getCurrentLocation=function(E){return a[E.element.id]||[0,0]},this.getOrientation=function(E){return i[E.id]||[0,0]},this.getCssClass=function(){return X}};v.continuousAnchorFactory={get:function(d){return new p(d)},clear:function(d){delete a[d]}}},C.AnchorManager.prototype.calculateOrientation=function(s,P,a,i,m,b,D,v,c){var t={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},_=["left","top","right","bottom"];if(s===P)return{orientation:t.IDENTITY,a:["top","top"]};var j=Math.atan2(i.centery-a.centery,i.centerx-a.centerx),L=Math.atan2(a.centery-i.centery,a.centerx-i.centerx),U=[],y={};(function(M,h){for(var k=0;k<M.length;k++)if(y[M[k]]={left:[h[k][0].left,h[k][0].centery],right:[h[k][0].right,h[k][0].centery],top:[h[k][0].centerx,h[k][0].top],bottom:[h[k][0].centerx,h[k][0].bottom]},h[k][1]!==0)for(var x in y[M[k]])y[M[k]][x]=jsPlumbUtil.rotatePoint(y[M[k]][x],[h[k][0].centerx,h[k][0].centery],h[k][1])})(["source","target"],[[a,v],[i,c]]);for(var I=0;I<_.length;I++)for(var r=0;r<_.length;r++)U.push({source:_[I],target:_[r],dist:Biltong.lineLength(y.source[_[I]],y.target[_[r]])});U.sort(function(M,h){return M.dist<h.dist?-1:M.dist>h.dist?1:0});for(var p=U[0].source,d=U[0].target,w=0;w<U.length&&(m.isContinuous&&m.locked?p=m.getCurrentFace():!m.isContinuous||m.isEdgeSupported(U[w].source)?p=U[w].source:p=null,b.isContinuous&&b.locked?d=b.getCurrentFace():!b.isContinuous||b.isEdgeSupported(U[w].target)?d=U[w].target:d=null,!(p!=null&&d!=null));w++);return m.isContinuous&&m.setCurrentFace(p),b.isContinuous&&b.setCurrentFace(d),{a:[p,d],theta:j,theta2:L}},C.Anchor=function(s){this.x=s.x||0,this.y=s.y||0,this.elementId=s.elementId,this.cssClass=s.cssClass||"",this.orientation=s.orientation||[0,0],this.lastReturnValue=null,this.offsets=s.offsets||[0,0],this.timestamp=null,this._unrotatedOrientation=[this.orientation[0],this.orientation[1]],this.relocatable=s.relocatable!==!1,this.snapOnRelocate=s.snapOnRelocate!==!1,this.locked=!1,n.EventGenerator.apply(this),this.compute=function(P){var a=P.xy,i=P.wh,m=P.timestamp;if(m&&m===this.timestamp)return this.lastReturnValue;var b=[a[0]+this.x*i[0]+this.offsets[0],a[1]+this.y*i[1]+this.offsets[1],this.x,this.y],D=P.rotation;if(D!=null&&D!==0){var v=jsPlumbUtil.rotatePoint(b,[a[0]+i[0]/2,a[1]+i[1]/2],D);this.orientation[0]=Math.round(this._unrotatedOrientation[0]*v[2]-this._unrotatedOrientation[1]*v[3]),this.orientation[1]=Math.round(this._unrotatedOrientation[1]*v[2]+this._unrotatedOrientation[0]*v[3]),this.lastReturnValue=[v[0],v[1],this.x,this.y]}else this.orientation[0]=this._unrotatedOrientation[0],this.orientation[1]=this._unrotatedOrientation[1],this.lastReturnValue=b;return this.timestamp=m,this.lastReturnValue},this.getCurrentLocation=function(P){return P=P||{},this.lastReturnValue==null||P.timestamp!=null&&this.timestamp!==P.timestamp?this.compute(P):this.lastReturnValue},this.setPosition=function(P,a,i,m,b){(!this.locked||b)&&(this.x=P,this.y=a,this.orientation=[i,m],this.lastReturnValue=null)}},n.extend(C.Anchor,n.EventGenerator,{equals:function(s){if(!s)return!1;var P=s.getOrientation(),a=this.getOrientation();return this.x===s.x&&this.y===s.y&&this.offsets[0]===s.offsets[0]&&this.offsets[1]===s.offsets[1]&&a[0]===P[0]&&a[1]===P[1]},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),C.FloatingAnchor=function(s){C.Anchor.apply(this,arguments);var P=s.reference,a=s.referenceCanvas,i=C.getSize(a),m=0,b=0,D=null,v=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(c){var t=c.xy,_=[t[0]+i[0]/2,t[1]+i[1]/2];return v=_,_},this.getOrientation=function(c){if(D)return D;var t=P.getOrientation(c);return[Math.abs(t[0])*m*-1,Math.abs(t[1])*b*-1]},this.over=function(c,t){D=c.getOrientation(t)},this.out=function(){D=null},this.getCurrentLocation=function(c){return v??this.compute(c)}},n.extend(C.FloatingAnchor,C.Anchor);var F=function(s,P,a){return s.constructor===C.Anchor?s:P.makeAnchor(s,a,P)};C.DynamicAnchor=function(s){C.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=s.elementId,this.jsPlumbInstance=s.jsPlumbInstance;for(var P=0;P<s.anchors.length;P++)this.anchors[P]=F(s.anchors[P],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var a=this.anchors.length>0?this.anchors[0]:null,i=a,m=function(D,v,c,t,_,j,L){var U=t[0]+D.x*_[0],y=t[1]+D.y*_[1],I=t[0]+_[0]/2,r=t[1]+_[1]/2;if(j!=null&&j!==0){var p=jsPlumbUtil.rotatePoint([U,y],[I,r],j);U=p[0],y=p[1]}return Math.sqrt(Math.pow(v-U,2)+Math.pow(c-y,2))+Math.sqrt(Math.pow(I-U,2)+Math.pow(r-y,2))},b=s.selector||function(D,v,c,t,_,j,L){for(var U=c[0]+t[0]/2,y=c[1]+t[1]/2,I=-1,r=1/0,p=0;p<L.length;p++){var d=m(L[p],U,y,D,v,_);d<r&&(I=p+0,r=d)}return L[I]};this.compute=function(D){var v=D.xy,c=D.wh,t=D.txy,_=D.twh,j=D.rotation,L=D.tRotation;return this.timestamp=D.timestamp,this.locked||t==null||_==null?(this.lastReturnValue=a.compute(D),this.lastReturnValue):(D.timestamp=null,a=b(v,c,t,_,j,L,this.anchors),this.x=a.x,this.y=a.y,a!==i&&this.fire("anchorChanged",a),i=a,this.lastReturnValue=a.compute(D),this.lastReturnValue)},this.getCurrentLocation=function(D){return a!=null?a.getCurrentLocation(D):null},this.getOrientation=function(D){return a!=null?a.getOrientation(D):[0,0]},this.over=function(D,v){a?.over(D,v)},this.out=function(){a?.out()},this.setAnchor=function(D){a=D},this.getCssClass=function(){return a&&a.getCssClass()||""},this.setAnchorCoordinates=function(D){var v=jsPlumbUtil.findWithFunction(this.anchors,function(c){return c.x===D[0]&&c.y===D[1]});return v!==-1?(this.setAnchor(this.anchors[v]),!0):!1}},n.extend(C.DynamicAnchor,C.Anchor);var z=function(s,P,a,i,m,b){C.Anchors[m]=function(D){var v=D.jsPlumbInstance.makeAnchor([s,P,a,i,0,0],D.elementId,D.jsPlumbInstance);return v.type=m,b&&b(v,D),v}};z(.5,0,0,-1,"TopCenter"),z(.5,1,0,1,"BottomCenter"),z(0,.5,-1,0,"LeftMiddle"),z(1,.5,1,0,"RightMiddle"),z(.5,0,0,-1,"Top"),z(.5,1,0,1,"Bottom"),z(0,.5,-1,0,"Left"),z(1,.5,1,0,"Right"),z(.5,.5,0,0,"Center"),z(1,0,0,-1,"TopRight"),z(1,1,0,1,"BottomRight"),z(0,0,0,-1,"TopLeft"),z(0,1,0,1,"BottomLeft"),C.Defaults.DynamicAnchors=function(s){return s.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],s.elementId,s.jsPlumbInstance)},C.Anchors.AutoDefault=function(s){var P=s.jsPlumbInstance.makeDynamicAnchor(C.Defaults.DynamicAnchors(s));return P.type="AutoDefault",P};var H=function(s,P){C.Anchors[s]=function(a){var i=a.jsPlumbInstance.makeAnchor(["Continuous",{faces:P}],a.elementId,a.jsPlumbInstance);return i.type=s,i}};C.Anchors.Continuous=function(s){return s.jsPlumbInstance.continuousAnchorFactory.get(s)},H("ContinuousLeft",["left"]),H("ContinuousTop",["top"]),H("ContinuousBottom",["bottom"]),H("ContinuousRight",["right"]),z(0,0,0,0,"Assign",function(s,P){var a=P.position||"Fixed";s.positionFinder=a.constructor===String?P.jsPlumbInstance.AnchorPositionFinders[a]:a,s.constructorParams=P}),A.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(s,P,a){return[(s.left-P.left)/a[0],(s.top-P.top)/a[1]]},Grid:function(s,P,a,i){var m=s.left-P.left,b=s.top-P.top,D=a[0]/i.grid[0],v=a[1]/i.grid[1],c=Math.floor(m/D),t=Math.floor(b/v);return[(c*D+D/2)/a[0],(t*v+v/2)/a[1]]}},C.Anchors.Perimeter=function(s){s=s||{};var P=s.anchorCount||60,a=s.shape;if(!a)throw new Error("no shape supplied to Perimeter Anchor type");var i=function(){for(var j=.5,L=Math.PI*2/P,U=0,y=[],I=0;I<P;I++){var r=j+j*Math.sin(U),p=j+j*Math.cos(U);y.push([r,p,0,0]),U+=L}return y},m=function(j){for(var L=P/j.length,U=[],y=function(r,p,d,w,M,h,k){L=P*M;for(var x=(d-r)/L,T=(w-p)/L,f=0;f<L;f++)U.push([r+x*f,p+T*f,h??0,k??0])},I=0;I<j.length;I++)y.apply(null,j[I]);return U},b=function(j){for(var L=[],U=0;U<j.length;U++)L.push([j[U][0],j[U][1],j[U][2],j[U][3],1/j.length,j[U][4],j[U][5]]);return m(L)},D=function(){return b([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},v={Circle:i,Ellipse:i,Diamond:function(){return b([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:D,Square:D,Triangle:function(){return b([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(j){for(var L=j.points,U=[],y=0,I=0;I<L.length-1;I++){var r=Math.sqrt(Math.pow(L[I][2]-L[I][0])+Math.pow(L[I][3]-L[I][1]));y+=r,U.push([L[I][0],L[I][1],L[I+1][0],L[I+1][1],r])}for(var p=0;p<U.length;p++)U[p][4]=U[p][4]/y;return m(U)}},c=function(j,L){for(var U=[],y=L/180*Math.PI,I=0;I<j.length;I++){var r=j[I][0]-.5,p=j[I][1]-.5;U.push([.5+(r*Math.cos(y)-p*Math.sin(y)),.5+(r*Math.sin(y)+p*Math.cos(y)),j[I][2],j[I][3]])}return U};if(!v[a])throw new Error("Shape ["+a+"] is unknown by Perimeter Anchor type");var t=v[a](s);s.rotation&&(t=c(t,s.rotation));var _=s.jsPlumbInstance.makeDynamicAnchor(t);return _.type="Perimeter",_}}.call(typeof window<"u"?window:Rt),function(){var A=this;A.jsPlumbUtil;var n=A.jsPlumb;n.DefaultRouter=function(C){this.jsPlumbInstance=C,this.anchorManager=new n.AnchorManager({jsPlumbInstance:C}),this.sourceOrTargetChanged=function(F,z,H,s,P){this.anchorManager.sourceOrTargetChanged(F,z,H,s,P)},this.reset=function(){this.anchorManager.reset()},this.changeId=function(F,z){this.anchorManager.changeId(F,z)},this.elementRemoved=function(F){this.anchorManager.elementRemoved(F)},this.newConnection=function(F){this.anchorManager.newConnection(F)},this.connectionDetached=function(F,z){this.anchorManager.connectionDetached(F,z)},this.redraw=function(F,z,H,s,P,a){return this.anchorManager.redraw(F,z,H,s,P,a)},this.deleteEndpoint=function(F){this.anchorManager.deleteEndpoint(F)},this.rehomeEndpoint=function(F,z,H){this.anchorManager.rehomeEndpoint(F,z,H)},this.addEndpoint=function(F,z){this.anchorManager.addEndpoint(F,z)}}}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F=A.Biltong;n.Segments={AbstractSegment:function(i){this.params=i,this.findClosestPointOnPath=function(m,b){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(i.x1,i.x2),minY:Math.min(i.y1,i.y2),maxX:Math.max(i.x1,i.x2),maxY:Math.max(i.y1,i.y2)}},this.lineIntersection=function(m,b,D,v){return[]},this.boxIntersection=function(m,b,D,v){var c=[];return c.push.apply(c,this.lineIntersection(m,b,m+D,b)),c.push.apply(c,this.lineIntersection(m+D,b,m+D,b+v)),c.push.apply(c,this.lineIntersection(m+D,b+v,m,b+v)),c.push.apply(c,this.lineIntersection(m,b+v,m,b)),c},this.boundingBoxIntersection=function(m){return this.boxIntersection(m.x,m.y,m.w,m.y)}},Straight:function(i){n.Segments.AbstractSegment.apply(this,arguments);var m,b,D,v,c,t,_,j=function(){m=Math.sqrt(Math.pow(c-v,2)+Math.pow(_-t,2)),b=F.gradient({x:v,y:t},{x:c,y:_}),D=-1/b};this.type="Straight",this.getLength=function(){return m},this.getGradient=function(){return b},this.getCoordinates=function(){return{x1:v,y1:t,x2:c,y2:_}},this.setCoordinates=function(r){v=r.x1,t=r.y1,c=r.x2,_=r.y2,j()},this.setCoordinates({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}),this.getBounds=function(){return{minX:Math.min(v,c),minY:Math.min(t,_),maxX:Math.max(v,c),maxY:Math.max(t,_)}},this.pointOnPath=function(r,p){if(r===0&&!p)return{x:v,y:t};if(r===1&&!p)return{x:c,y:_};var d=p?r>0?r:m+r:r*m;return F.pointOnLine({x:v,y:t},{x:c,y:_},d)},this.gradientAtPoint=function(r){return b},this.pointAlongPathFrom=function(r,p,d){var w=this.pointOnPath(r,d),M=p<=0?{x:v,y:t}:{x:c,y:_};return p<=0&&Math.abs(p)>1&&(p*=-1),F.pointOnLine(w,M,p)};var L=function(r,p,d){return d>=Math.min(r,p)&&d<=Math.max(r,p)},U=function(r,p,d){return Math.abs(d-r)<Math.abs(d-p)?r:p};this.findClosestPointOnPath=function(r,p){var d={d:1/0,x:null,y:null,l:null,x1:v,x2:c,y1:t,y2:_};if(b===0)d.y=t,d.x=L(v,c,r)?r:U(v,c,r);else if(b===1/0||b===-1/0)d.x=v,d.y=L(t,_,p)?p:U(t,_,p);else{var w=t-b*v,M=p-D*r,h=(M-w)/(b-D),k=b*h+w;d.x=L(v,c,h)?h:U(v,c,h),d.y=L(t,_,k)?k:U(t,_,k)}var x=F.lineLength([d.x,d.y],[v,t]);return d.d=F.lineLength([r,p],[d.x,d.y]),d.l=x/m,d};var y=function(r,p,d){return d>p?p<=r&&r<=d:p>=r&&r>=d},I=y;this.lineIntersection=function(r,p,d,w){var M=Math.abs(F.gradient({x:r,y:p},{x:d,y:w})),h=Math.abs(b),k=h===1/0?v:t-h*v,x=[],T=M===1/0?r:p-M*r;if(M!==h)if(M===1/0&&h===0)I(r,v,c)&&I(t,p,w)&&(x=[r,t]);else if(M===0&&h===1/0)I(p,t,_)&&I(v,r,d)&&(x=[v,p]);else{var f,O;M===1/0?(f=r,I(f,v,c)&&(O=h*r+k,I(O,p,w)&&(x=[f,O]))):M===0?(O=p,I(O,t,_)&&(f=(p-k)/h,I(f,r,d)&&(x=[f,O]))):(f=(T-k)/(h-M),O=h*f+k,I(f,v,c)&&I(O,t,_)&&(x=[f,O]))}return x},this.boxIntersection=function(r,p,d,w){var M=[];return M.push.apply(M,this.lineIntersection(r,p,r+d,p)),M.push.apply(M,this.lineIntersection(r+d,p,r+d,p+w)),M.push.apply(M,this.lineIntersection(r+d,p+w,r,p+w)),M.push.apply(M,this.lineIntersection(r,p+w,r,p)),M},this.boundingBoxIntersection=function(r){return this.boxIntersection(r.x,r.y,r.w,r.h)}},Arc:function(i){n.Segments.AbstractSegment.apply(this,arguments);var m=function(U,y){return F.theta([i.cx,i.cy],[U,y])},b=function(U,y){if(U.anticlockwise){var I=U.startAngle<U.endAngle?U.startAngle+D:U.startAngle,r=Math.abs(I-U.endAngle);return I-r*y}else{var p=U.endAngle<U.startAngle?U.endAngle+D:U.endAngle,d=Math.abs(p-U.startAngle);return U.startAngle+d*y}},D=2*Math.PI;this.radius=i.r,this.anticlockwise=i.ac,this.type="Arc",i.startAngle&&i.endAngle?(this.startAngle=i.startAngle,this.endAngle=i.endAngle,this.x1=i.cx+this.radius*Math.cos(i.startAngle),this.y1=i.cy+this.radius*Math.sin(i.startAngle),this.x2=i.cx+this.radius*Math.cos(i.endAngle),this.y2=i.cy+this.radius*Math.sin(i.endAngle)):(this.startAngle=m(i.x1,i.y1),this.endAngle=m(i.x2,i.y2),this.x1=i.x1,this.y1=i.y1,this.x2=i.x2,this.y2=i.y2),this.endAngle<0&&(this.endAngle+=D),this.startAngle<0&&(this.startAngle+=D);var v=this.endAngle<this.startAngle?this.endAngle+D:this.endAngle;this.sweep=Math.abs(v-this.startAngle),this.anticlockwise&&(this.sweep=D-this.sweep);var c=2*Math.PI*this.radius,t=this.sweep/D,_=c*t;this.getLength=function(){return _},this.getBounds=function(){return{minX:i.cx-i.r,maxX:i.cx+i.r,minY:i.cy-i.r,maxY:i.cy+i.r}};var j=1e-10,L=function(U){var y=Math.floor(U),I=Math.ceil(U);return U-y<j?y:I-U<j?I:U};this.pointOnPath=function(U,y){if(U===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(U===1)return{x:this.x2,y:this.y2,theta:this.endAngle};y&&(U=U/_);var I=b(this,U),r=i.cx+i.r*Math.cos(I),p=i.cy+i.r*Math.sin(I);return{x:L(r),y:L(p),theta:I}},this.gradientAtPoint=function(U,y){var I=this.pointOnPath(U,y),r=F.normal([i.cx,i.cy],[I.x,I.y]);return!this.anticlockwise&&(r===1/0||r===-1/0)&&(r*=-1),r},this.pointAlongPathFrom=function(U,y,I){var r=this.pointOnPath(U,I),p=y/c*2*Math.PI,d=this.anticlockwise?-1:1,w=r.theta+d*p,M=i.cx+this.radius*Math.cos(w),h=i.cy+this.radius*Math.sin(w);return{x:M,y:h}}},Bezier:function(i){this.curve=[{x:i.x1,y:i.y1},{x:i.cp1x,y:i.cp1y},{x:i.cp2x,y:i.cp2y},{x:i.x2,y:i.y2}];var m=function(_){return _[0].x===_[1].x&&_[0].y===_[1].y},b=function(_,j){return Math.sqrt(Math.pow(_.x-j.x,2)+Math.pow(_.y-j.y,2))},D=function(_){var j={x:0,y:0};if(_===0)return this.curve[0];var L=this.curve.length-1;if(_===1)return this.curve[L];var U=this.curve,y=1-_;if(L===0)return this.curve[0];if(L===1)return{x:y*U[0].x+_*U[1].x,y:y*U[0].y+_*U[1].y};if(L<4){var I=y*y,r=_*_,p=0,d,w,M;return L===2?(U=[U[0],U[1],U[2],j],d=I,w=2*(y*_),M=r):L===3&&(d=I*y,w=3*(I*_),M=3*(y*r),p=_*r),{x:d*U[0].x+w*U[1].x+M*U[2].x+p*U[3].x,y:d*U[0].y+w*U[1].y+M*U[2].y+p*U[3].y}}else return j}.bind(this),v=function(_){var j=[];_--;for(var L=0;L<=_;L++)j.push(D(L/_));return j},c=function(){m(this.curve)&&(this.length=0);var _=16,j=v(_);this.length=0;for(var L=0;L<_-1;L++){var U=j[L],y=j[L+1];this.length+=b(U,y)}}.bind(this);n.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(i.x1,i.x2,i.cp1x,i.cp2x),minY:Math.min(i.y1,i.y2,i.cp1y,i.cp2y),maxX:Math.max(i.x1,i.x2,i.cp1x,i.cp2x),maxY:Math.max(i.y1,i.y2,i.cp1y,i.cp2y)},this.type="Bezier",c();var t=function(_,j,L){return L&&(j=A.jsBezier.locationAlongCurveFrom(_,j>0?0:1,j)),j};this.pointOnPath=function(_,j){return _=t(this.curve,_,j),A.jsBezier.pointOnCurve(this.curve,_)},this.gradientAtPoint=function(_,j){return _=t(this.curve,_,j),A.jsBezier.gradientAtPoint(this.curve,_)},this.pointAlongPathFrom=function(_,j,L){return _=t(this.curve,_,L),A.jsBezier.pointAlongCurveFrom(this.curve,_,j)},this.getLength=function(){return this.length},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(_,j){var L=A.jsBezier.nearestPointOnCurve({x:_,y:j},this.curve);return{d:Math.sqrt(Math.pow(L.point.x-_,2)+Math.pow(L.point.y-j,2)),x:L.point.x,y:L.point.y,l:1-L.location,s:this}},this.lineIntersection=function(_,j,L,U){return A.jsBezier.lineIntersection(_,j,L,U,this.curve)}}},n.SegmentRenderer={getPath:function(i,m){return{Straight:function(b){var D=i.getCoordinates();return(b?"M "+D.x1+" "+D.y1+" ":"")+"L "+D.x2+" "+D.y2},Bezier:function(b){var D=i.params;return(b?"M "+D.x2+" "+D.y2+" ":"")+"C "+D.cp2x+" "+D.cp2y+" "+D.cp1x+" "+D.cp1y+" "+D.x1+" "+D.y1},Arc:function(b){var D=i.params,v=i.sweep>Math.PI?1:0,c=i.anticlockwise?0:1;return(b?"M"+i.x1+" "+i.y1+" ":"")+"A "+i.radius+" "+D.r+" 0 "+v+","+c+" "+i.x2+" "+i.y2}}[i.type](m)}};var z=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};n.Connectors.AbstractConnector=function(i){z.apply(this,arguments);var m=[],b=0,D=[],v=[],c=i.stub||0,t=C.isArray(c)?c[0]:c,_=C.isArray(c)?c[1]:c,j=i.gap||0,L=C.isArray(j)?j[0]:j,U=C.isArray(j)?j[1]:j,y=null,I=null;this.getPathData=function(){for(var h="",k=0;k<m.length;k++)h+=n.SegmentRenderer.getPath(m[k],k===0),h+=" ";return h},this.findSegmentForPoint=function(h,k){for(var x={d:1/0,s:null,x:null,y:null,l:null},T=0;T<m.length;T++){var f=m[T].findClosestPointOnPath(h,k);f.d<x.d&&(x.d=f.d,x.l=f.l,x.x=f.x,x.y=f.y,x.s=m[T],x.x1=f.x1,x.x2=f.x2,x.y1=f.y1,x.y2=f.y2,x.index=T,x.connectorLocation=D[T][0]+f.l*(D[T][1]-D[T][0]))}return x},this.lineIntersection=function(h,k,x,T){for(var f=[],O=0;O<m.length;O++)f.push.apply(f,m[O].lineIntersection(h,k,x,T));return f},this.boxIntersection=function(h,k,x,T){for(var f=[],O=0;O<m.length;O++)f.push.apply(f,m[O].boxIntersection(h,k,x,T));return f},this.boundingBoxIntersection=function(h){for(var k=[],x=0;x<m.length;x++)k.push.apply(k,m[x].boundingBoxIntersection(h));return k};var r=function(){for(var h=0,k=0;k<m.length;k++){var x=m[k].getLength();v[k]=x/b,D[k]=[h,h+=x/b]}},p=function(h,k){var x,T,f;if(k&&(h=h>0?h/b:(b+h)/b),h===1)x=m.length-1,f=1;else if(h===0)f=0,x=0;else if(h>=.5){for(x=0,f=0,T=D.length-1;T>-1;T--)if(D[T][1]>=h&&D[T][0]<=h){x=T,f=(h-D[T][0])/v[T];break}}else for(x=D.length-1,f=1,T=0;T<D.length;T++)if(D[T][1]>=h){x=T,f=(h-D[T][0])/v[T];break}return{segment:m[x],proportion:f,index:x}},d=function(h,k,x){if(!(x.x1===x.x2&&x.y1===x.y2)){var T=new n.Segments[k](x);m.push(T),b+=T.getLength(),h.updateBounds(T)}},w=function(){b=m.length=D.length=v.length=0};this.setSegments=function(h){y=[],b=0;for(var k=0;k<h.length;k++)y.push(h[k]),b+=h[k].getLength()},this.getLength=function(){return b};var M=function(h){this.strokeWidth=h.strokeWidth;var k=F.quadrant(h.sourcePos,h.targetPos),x=h.targetPos[0]<h.sourcePos[0],T=h.targetPos[1]<h.sourcePos[1],f=h.strokeWidth||1,O=h.sourceEndpoint.anchor.getOrientation(h.sourceEndpoint),X=h.targetEndpoint.anchor.getOrientation(h.targetEndpoint),W=x?h.targetPos[0]:h.sourcePos[0],$=T?h.targetPos[1]:h.sourcePos[1],o=Math.abs(h.targetPos[0]-h.sourcePos[0]),u=Math.abs(h.targetPos[1]-h.sourcePos[1]);if(O[0]===0&&O[1]===0||X[0]===0&&X[1]===0){var e=o>u?0:1,g=[1,0][e];O=[],X=[],O[e]=h.sourcePos[e]>h.targetPos[e]?-1:1,X[e]=h.sourcePos[e]>h.targetPos[e]?1:-1,O[g]=0,X[g]=0}var E=x?o+L*O[0]:L*O[0],G=T?u+L*O[1]:L*O[1],R=x?U*X[0]:o+U*X[0],K=T?U*X[1]:u+U*X[1],q=O[0]*X[0]+O[1]*X[1],Q={sx:E,sy:G,tx:R,ty:K,lw:f,xSpan:Math.abs(R-E),ySpan:Math.abs(K-G),mx:(E+R)/2,my:(G+K)/2,so:O,to:X,x:W,y:$,w:o,h:u,segment:k,startStubX:E+O[0]*t,startStubY:G+O[1]*t,endStubX:R+X[0]*_,endStubY:K+X[1]*_,isXGreaterThanStubTimes2:Math.abs(E-R)>t+_,isYGreaterThanStubTimes2:Math.abs(G-K)>t+_,opposite:q===-1,perpendicular:q===0,orthogonal:q===1,sourceAxis:O[0]===0?"y":"x",points:[W,$,o,u,E,G,R,K],stubs:[t,_]};return Q.anchorOrientation=Q.opposite?"opposite":Q.orthogonal?"orthogonal":"perpendicular",Q};return this.getSegments=function(){return m},this.updateBounds=function(h){var k=h.getBounds();this.bounds.minX=Math.min(this.bounds.minX,k.minX),this.bounds.maxX=Math.max(this.bounds.maxX,k.maxX),this.bounds.minY=Math.min(this.bounds.minY,k.minY),this.bounds.maxY=Math.max(this.bounds.maxY,k.maxY)},this.pointOnPath=function(h,k){var x=p(h,k);return x.segment&&x.segment.pointOnPath(x.proportion,!1)||[0,0]},this.gradientAtPoint=function(h,k){var x=p(h,k);return x.segment&&x.segment.gradientAtPoint(x.proportion,!1)||0},this.pointAlongPathFrom=function(h,k,x){var T=p(h,x);return T.segment&&T.segment.pointAlongPathFrom(T.proportion,k,!1)||[0,0]},this.compute=function(h){I=M.call(this,h),w(),this._compute(I,h),this.x=I.points[0],this.y=I.points[1],this.w=I.points[2],this.h=I.points[3],this.segment=I.segment,r()},{addSegment:d,prepareCompute:M,sourceStub:t,targetStub:_,maxStub:Math.max(t,_),sourceGap:L,targetGap:U,maxGap:Math.max(L,U)}},C.extend(n.Connectors.AbstractConnector,z),n.Endpoints.AbstractEndpoint=function(i){z.apply(this,arguments);var m=this.compute=function(b,D,v,c){var t=this._compute.apply(this,arguments);return this.x=t[0],this.y=t[1],this.w=t[2],this.h=t[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,t};return{compute:m,cssClass:i.cssClass}},C.extend(n.Endpoints.AbstractEndpoint,z),n.Endpoints.Dot=function(i){this.type="Dot",n.Endpoints.AbstractEndpoint.apply(this,arguments),i=i||{},this.radius=i.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(m,b,D,v){this.radius=D.radius||this.radius;var c=m[0]-this.radius,t=m[1]-this.radius,_=this.radius*2,j=this.radius*2;if(D.stroke){var L=D.strokeWidth||1;c-=L,t-=L,_+=L*2,j+=L*2}return[c,t,_,j,this.radius]}},C.extend(n.Endpoints.Dot,n.Endpoints.AbstractEndpoint),n.Endpoints.Rectangle=function(i){this.type="Rectangle",n.Endpoints.AbstractEndpoint.apply(this,arguments),i=i||{},this.width=i.width||20,this.height=i.height||20,this._compute=function(m,b,D,v){var c=D.width||this.width,t=D.height||this.height,_=m[0]-c/2,j=m[1]-t/2;return[_,j,c,t]}},C.extend(n.Endpoints.Rectangle,n.Endpoints.AbstractEndpoint);var H=function(i){n.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};C.extend(H,n.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(i){this._jsPlumb.displayElements.push(i)}}),n.Endpoints.Image=function(i){this.type="Image",H.apply(this,arguments),n.Endpoints.AbstractEndpoint.apply(this,arguments);var m=i.onload,b=i.src||i.url,D=i.cssClass?" "+i.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=i.width,this._jsPlumb.heightToUse=i.height,this._jsPlumb.endpoint=i.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,m&&m(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(v,c){var t=v.constructor===String?v:v.src;m=c,this._jsPlumb.img.src=t,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(b,m),this._compute=function(v,c,t,_){return this.anchorPoint=v,this._jsPlumb.ready?[v[0]-this._jsPlumb.widthToUse/2,v[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=n.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+D),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(v,c,t){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var _=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,j=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;C.sizeElement(this.canvas,_,j,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(v,c){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(v,c):A.setTimeout(function(){this.paint(v,c)}.bind(this),200))}},C.extend(n.Endpoints.Image,[H,n.Endpoints.AbstractEndpoint],{cleanup:function(i){i&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),n.Endpoints.Blank=function(i){n.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",H.apply(this,arguments),this._compute=function(b,D,v,c){return[b[0],b[1],10,0]};var m=i.cssClass?" "+i.cssClass:"";this.canvas=n.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+m),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(b,D){C.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},C.extend(n.Endpoints.Blank,[n.Endpoints.AbstractEndpoint,H],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),n.Endpoints.Triangle=function(i){this.type="Triangle",n.Endpoints.AbstractEndpoint.apply(this,arguments);var m=this;i=i||{},i.width=i.width||55,i.height=i.height||55,this.width=i.width,this.height=i.height,this._compute=function(b,D,v,c){var t=v.width||m.width,_=v.height||m.height,j=b[0]-t/2,L=b[1]-_/2;return[j,L,t,_]}};var s=n.Overlays.AbstractOverlay=function(i){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=i.component,this.loc=i.location==null?.5:i.location,this.endpointLoc=i.endpointLocation==null?[.5,.5]:i.endpointLocation,this.visible=i.visible!==!1};s.prototype={cleanup:function(i){i&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(i,m){},setVisible:function(i){this.visible=i,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(i){this.loc+=i,this.component.repaint()},setLocation:function(i){this.loc=i,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},n.Overlays.Arrow=function(i){this.type="Arrow",s.apply(this,arguments),this.isAppendedAtTopLevel=!1,i=i||{};var m=this;this.length=i.length||20,this.width=i.width||20,this.id=i.id,this.direction=(i.direction||1)<0?-1:1;var b=i.paintStyle||{"stroke-width":1},D=i.foldback||.623;this.computeMaxSize=function(){return m.width*1.5},this.elementCreated=function(v,c){if(this.path=v,i.events)for(var t in i.events)n.on(v,t,i.events[t])},this.draw=function(v,c){var t,_,j,L,U;if(v.pointAlongPathFrom){if(C.isString(this.loc)||this.loc>1||this.loc<0){var y=parseInt(this.loc,10),I=this.loc<0?1:0;t=v.pointAlongPathFrom(I,y,!1),_=v.pointAlongPathFrom(I,y-this.direction*this.length/2,!1),j=F.pointOnLine(t,_,this.length)}else if(this.loc===1){if(t=v.pointOnPath(this.loc),_=v.pointAlongPathFrom(this.loc,-this.length),j=F.pointOnLine(t,_,this.length),this.direction===-1){var r=j;j=t,t=r}}else if(this.loc===0){if(j=v.pointOnPath(this.loc),_=v.pointAlongPathFrom(this.loc,this.length),t=F.pointOnLine(j,_,this.length),this.direction===-1){var p=j;j=t,t=p}}else t=v.pointAlongPathFrom(this.loc,this.direction*this.length/2),_=v.pointOnPath(this.loc),j=F.pointOnLine(t,_,this.length);L=F.perpendicularLineTo(t,j,this.width),U=F.pointOnLine(t,j,D*this.length);var d={hxy:t,tail:L,cxy:U},w=b.stroke||c.stroke,M=b.fill||c.stroke,h=b.strokeWidth||c.strokeWidth;return{component:v,d,"stroke-width":h,stroke:w,fill:M,minX:Math.min(t.x,L[0].x,L[1].x),maxX:Math.max(t.x,L[0].x,L[1].x),minY:Math.min(t.y,L[0].y,L[1].y),maxY:Math.max(t.y,L[0].y,L[1].y)}}else return{component:v,minX:0,maxX:0,minY:0,maxY:0}}},C.extend(n.Overlays.Arrow,s,{updateFrom:function(i){this.length=i.length||this.length,this.width=i.width||this.width,this.direction=i.direction!=null?i.direction:this.direction,this.foldback=i.foldback||this.foldback},cleanup:function(){this.path&&this.path.parentNode&&this.path.parentNode.removeChild(this.path)}}),n.Overlays.PlainArrow=function(i){i=i||{};var m=n.extend(i,{foldback:1});n.Overlays.Arrow.call(this,m),this.type="PlainArrow"},C.extend(n.Overlays.PlainArrow,n.Overlays.Arrow),n.Overlays.Diamond=function(i){i=i||{};var m=i.length||40,b=n.extend(i,{length:m/2,foldback:2});n.Overlays.Arrow.call(this,b),this.type="Diamond"},C.extend(n.Overlays.Diamond,n.Overlays.Arrow);var P=function(i,m){return(i._jsPlumb.cachedDimensions==null||m)&&(i._jsPlumb.cachedDimensions=i.getDimensions()),i._jsPlumb.cachedDimensions},a=function(i){n.jsPlumbUIComponent.apply(this,arguments),s.apply(this,arguments);var m=this.fire;this.fire=function(){m.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=i.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=i.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=i.create,this._jsPlumb.initiallyInvisible=i.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){var b=this._jsPlumb.div=n.getElement(this._jsPlumb.create(this._jsPlumb.component));b.style.position="absolute",jsPlumb.addClass(b,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:i.cssClass?i.cssClass:"")),this._jsPlumb.instance.appendElement(b),this._jsPlumb.instance.getId(b),this.canvas=b;var D="translate(-50%, -50%)";b.style.webkitTransform=D,b.style.mozTransform=D,b.style.msTransform=D,b.style.oTransform=D,b.style.transform=D,b._jsPlumb=this,i.visible===!1&&(b.style.display="none")}return this._jsPlumb.div},this.draw=function(b,D,v){var c=P(this);if(c!=null&&c.length===2){var t={x:0,y:0};if(v)t={x:v[0],y:v[1]};else if(b.pointOnPath){var _=this.loc,j=!1;(C.isString(this.loc)||this.loc<0||this.loc>1)&&(_=parseInt(this.loc,10),j=!0),t=b.pointOnPath(_,j)}else{var L=this.loc.constructor===Array?this.loc:this.endpointLoc;t={x:L[0]*b.w,y:L[1]*b.h}}var U=t.x-c[0]/2,y=t.y-c[1]/2;return{component:b,d:{minx:U,miny:y,td:c,cxy:t},minX:U,maxX:U+c[0],minY:y,maxY:y+c[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};C.extend(a,[n.jsPlumbUIComponent,s],{getDimensions:function(){return[1,1]},setVisible:function(i){this._jsPlumb.div&&(this._jsPlumb.div.style.display=i?"block":"none",i&&this._jsPlumb.initiallyInvisible&&(P(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(i){i?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(i,m){this._jsPlumb.div!=null&&i.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var i=P(this);return Math.max(i[0],i[1])},paint:function(i,m){this._jsPlumb.initialised||(this.getElement(),i.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=i.component.x+i.d.minx+"px",this._jsPlumb.div.style.top=i.component.y+i.d.miny+"px"}}),n.Overlays.Custom=function(i){this.type="Custom",a.apply(this,arguments)},C.extend(n.Overlays.Custom,a),n.Overlays.GuideLines=function(){var i=this;i.length=50,i.strokeWidth=5,this.type="GuideLines",s.apply(this,arguments),n.jsPlumbUIComponent.apply(this,arguments),this.draw=function(m,b){var D=m.pointAlongPathFrom(i.loc,i.length/2),v=m.pointOnPath(i.loc),c=F.pointOnLine(D,v,i.length),t=F.perpendicularLineTo(D,c,40),_=F.perpendicularLineTo(c,D,20);return{connector:m,head:D,tail:c,headLine:_,tailLine:t,minX:Math.min(D.x,c.x,_[0].x,_[1].x),minY:Math.min(D.y,c.y,_[0].y,_[1].y),maxX:Math.max(D.x,c.x,_[0].x,_[1].x),maxY:Math.max(D.y,c.y,_[0].y,_[1].y)}}},n.Overlays.Label=function(i){this.labelStyle=i.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var m=n.extend({create:function(){return n.createElement("div")}},i);if(n.Overlays.Custom.call(this,m),this.type="Label",this.label=i.label||"",this.labelText=null,this.labelStyle){var b=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",b.style.font=this.labelStyle.font,b.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(b.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){var D=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";b.style.border=this.labelStyle.borderWidth+"px solid "+D}this.labelStyle.padding&&(b.style.padding=this.labelStyle.padding)}},C.extend(n.Overlays.Label,n.Overlays.Custom,{cleanup:function(i){i&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(i){this.label=i,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),a.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var i=this.label(this);this.getElement().innerHTML=i.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(i){i.label!=null&&this.setLabel(i.label)}})}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumbUtil,C=A.jsPlumbInstance,F="jtk-group-collapsed",z="jtk-group-expanded",H="[jtk-group-content]",s="elementDraggable",P="stop",a="revert",i="_groupManager",m="_jsPlumbGroup",b="_jsPlumbGroupDrag",D="group:addMember",v="group:removeMember",c="group:add",t="group:remove",_="group:expand",j="group:collapse",L="groupDragStop",U="connectionMoved",y="internal.connectionDetached",I="removeAll",r="orphanAll",p="show",d="hide",w=function(h){var k={},x={},T={},f=this;function O(e,g){for(var E=h.getContainer(),G=!1;!G;){if(e==null||e===E)return!1;if(e===g)return!0;e=e.parentNode}}h.bind("connection",function(e){var g=h.getGroupFor(e.source),E=h.getGroupFor(e.target);g!=null&&E!=null&&g===E?(x[e.connection.id]=g,T[e.connection.id]=g):(g!=null&&(n.suggest(g.connections.source,e.connection),x[e.connection.id]=g),E!=null&&(n.suggest(E.connections.target,e.connection),T[e.connection.id]=E))});function X(e){delete e.proxies;var g=x[e.id],E;g!=null&&(E=function(G){return G.id===e.id},n.removeWithFunction(g.connections.source,E),n.removeWithFunction(g.connections.target,E),delete x[e.id]),g=T[e.id],g!=null&&(E=function(G){return G.id===e.id},n.removeWithFunction(g.connections.source,E),n.removeWithFunction(g.connections.target,E),delete T[e.id])}h.bind(y,function(e){X(e.connection)}),h.bind(U,function(e){var g=e.index===0?x:T,E=g[e.connection.id];if(E){var G=E.connections[e.index===0?"source":"target"],R=G.indexOf(e.connection);R!==-1&&G.splice(R,1)}}),this.addGroup=function(e){h.addClass(e.getEl(),z),k[e.id]=e,e.manager=this,u(e),h.fire(c,{group:e})},this.addToGroup=function(e,g,E){if(e=this.getGroup(e),e){var G=e.getEl();if(g._isJsPlumbGroup)return;var R=g._jsPlumbGroup;if(R!==e){h.removeFromDragSelection(g);var K=h.getOffset(g,!0),q=e.collapsed?h.getOffset(G,!0):h.getOffset(e.getDragArea(),!0);R!=null&&(R.remove(g,!1,E,!1,e),f.updateConnectionsForGroup(R)),e.add(g,E);var Q=function(lt,bt){var vt=bt===0?1:0;lt.each(function(dt){dt.setVisible(!1),dt.endpoints[vt].element._jsPlumbGroup===e?(dt.endpoints[vt].setVisible(!1),o(dt,vt,e)):(dt.endpoints[bt].setVisible(!1),$(dt,bt,e))})};e.collapsed&&(Q(h.select({source:g}),0),Q(h.select({target:g}),1));var ct=h.getId(g);h.dragManager.setParent(g,ct,G,h.getId(G),K);var at={left:K.left-q.left,top:K.top-q.top};if(h.setPosition(g,at),h.dragManager.revalidateParent(g,ct,K),f.updateConnectionsForGroup(e),h.revalidate(ct),!E){var rt={group:e,el:g,pos:at};R&&(rt.sourceGroup=R),h.fire(D,rt)}}}},this.removeFromGroup=function(e,g,E){if(e=this.getGroup(e),e){if(e.collapsed){var G=function(R,K){for(var q=0;q<R.length;q++){var Q=R[q];if(Q.proxies){for(var ct=0;ct<Q.proxies.length;ct++)if(Q.proxies[ct]!=null){var at=Q.proxies[ct].originalEp.element;(at===g||O(at,g))&&o(Q,K,e)}}}};G(e.connections.source.slice(),0),G(e.connections.target.slice(),1)}e.remove(g,null,E)}},this.getGroup=function(e){var g=e;if(n.isString(e)&&(g=k[e],g==null))throw new TypeError("No such group ["+e+"]");return g},this.getGroups=function(){var e=[];for(var g in k)e.push(k[g]);return e},this.removeGroup=function(e,g,E,G){e=this.getGroup(e),this.expandGroup(e,!0);var R=e[g?I:r](E,G);return h.remove(e.getEl()),delete k[e.id],delete h._groups[e.id],h.fire(t,{group:e}),R},this.removeAllGroups=function(e,g,E){for(var G in k)this.removeGroup(k[G],e,g,E)};function W(e,g){for(var E=e.getEl().querySelectorAll(".jtk-managed"),G=0;G<E.length;G++)h[g?p:d](E[G],!0)}var $=function(e,g,E){var G=e.endpoints[g===0?1:0].element;if(!(G[m]&&!G[m].shouldProxy()&&G[m].collapsed)){var R=E.getEl(),K=h.getId(R);h.proxyConnection(e,g,R,K,function(q,Q){return E.getEndpoint(q,Q)},function(q,Q){return E.getAnchor(q,Q)})}};this.collapseGroup=function(e){if(e=this.getGroup(e),!(e==null||e.collapsed)){var g=e.getEl();if(W(e,!1),e.shouldProxy()){var E=function(G,R){for(var K=0;K<G.length;K++){var q=G[K];$(q,R,e)}};E(e.connections.source,0),E(e.connections.target,1)}e.collapsed=!0,h.removeClass(g,z),h.addClass(g,F),h.revalidate(g),h.fire(j,{group:e})}};var o=function(e,g,E){h.unproxyConnection(e,g,h.getId(E.getEl()))};this.expandGroup=function(e,g){if(e=this.getGroup(e),!(e==null||!e.collapsed)){var E=e.getEl();if(W(e,!0),e.shouldProxy()){var G=function(R,K){for(var q=0;q<R.length;q++){var Q=R[q];o(Q,K,e)}};G(e.connections.source,0),G(e.connections.target,1)}e.collapsed=!1,h.addClass(E,z),h.removeClass(E,F),h.revalidate(E),this.repaintGroup(e),g||h.fire(_,{group:e})}},this.repaintGroup=function(e){e=this.getGroup(e);for(var g=e.getMembers(),E=0;E<g.length;E++)h.revalidate(g[E])};function u(e){for(var g=e.getMembers().slice(),E=[],G=0;G<g.length;G++)Array.prototype.push.apply(E,g[G].querySelectorAll(".jtk-managed"));Array.prototype.push.apply(g,E);var R=h.getConnections({source:g,scope:"*"},!0),K=h.getConnections({target:g,scope:"*"},!0),q={};e.connections.source.length=0,e.connections.target.length=0;var Q=function(ct){for(var at=0;at<ct.length;at++)if(!q[ct[at].id]){q[ct[at].id]=!0;var rt=h.getGroupFor(ct[at].source),lt=h.getGroupFor(ct[at].target);rt===e?(lt!==e&&e.connections.source.push(ct[at]),x[ct[at].id]=e):lt===e&&(e.connections.target.push(ct[at]),T[ct[at].id]=e)}};Q(R),Q(K)}this.updateConnectionsForGroup=u,this.refreshAllGroups=function(){for(var e in k)u(k[e]),h.dragManager.updateOffsets(h.getId(k[e].getEl()))}},M=function(h,k){var x=this,T=k.el;this.getEl=function(){return T},this.id=k.id||n.uuid(),T._isJsPlumbGroup=!0;var f=this.getDragArea=function(){var lt=h.getSelector(T,H);return lt&&lt.length>0?lt[0]:T},O=k.ghost===!0,X=O||k.constrain===!0,W=k.revert!==!1,$=k.orphan===!0,o=k.prune===!0,u=k.dropOverride===!0,e=k.proxied!==!1,g=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(lt,bt){return k.anchor||"Continuous"},this.getEndpoint=function(lt,bt){return k.endpoint||["Dot",{radius:10}]},this.collapsed=!1,k.draggable!==!1){var E={drag:function(){for(var lt=0;lt<g.length;lt++)h.draw(g[lt])},stop:function(lt){h.fire(L,jsPlumb.extend(lt,{group:x}))},scope:b};k.dragOptions&&A.jsPlumb.extend(E,k.dragOptions),h.draggable(k.el,E)}k.droppable!==!1&&h.droppable(k.el,{drop:function(lt){var bt=lt.drag.el;if(!bt._isJsPlumbGroup){var vt=bt._jsPlumbGroup;if(vt!==x){if(vt!=null&&vt.overrideDrop(bt,x))return;h.getGroupManager().addToGroup(x,bt,!1)}}}});var G=function(lt,bt){for(var vt=lt.nodeType==null?lt:[lt],dt=0;dt<vt.length;dt++)bt(vt[dt])};this.overrideDrop=function(lt,bt){return u&&(W||o||$)},this.add=function(lt,bt){var vt=f();G(lt,function(dt){if(dt._jsPlumbGroup!=null){if(dt._jsPlumbGroup===x)return;dt._jsPlumbGroup.remove(dt,!0,bt,!1)}dt._jsPlumbGroup=x,g.push(dt),h.isAlreadyDraggable(dt)&&rt(dt),dt.parentNode!==vt&&vt.appendChild(dt)}),h.getGroupManager().updateConnectionsForGroup(x)},this.remove=function(lt,bt,vt,dt,Et){G(lt,function(yt){if(yt._jsPlumbGroup===x){if(delete yt._jsPlumbGroup,n.removeWithFunction(g,function(tt){return tt===yt}),bt)try{x.getDragArea().removeChild(yt)}catch(tt){jsPlumbUtil.log("Could not remove element from Group "+tt)}if(at(yt),!vt){var et={group:x,el:yt};Et&&(et.targetGroup=Et),h.fire(v,et)}}}),dt||h.getGroupManager().updateConnectionsForGroup(x)},this.removeAll=function(lt,bt){for(var vt=0,dt=g.length;vt<dt;vt++){var Et=g[0];x.remove(Et,lt,bt,!0),h.remove(Et,!0)}g.length=0,h.getGroupManager().updateConnectionsForGroup(x)},this.orphanAll=function(){for(var lt={},bt=0;bt<g.length;bt++){var vt=q(g[bt]);lt[vt[0]]=vt[1]}return g.length=0,lt},this.getMembers=function(){return g},T[m]=this,h.bind(s,function(lt){lt.el._jsPlumbGroup===this&&rt(lt.el)}.bind(this));function R(lt){return lt.offsetParent}function K(lt,bt){var vt=R(lt),dt=h.getSize(vt),Et=h.getSize(lt),yt=bt[0],et=yt+Et[0],tt=bt[1],it=tt+Et[1];return et>0&&yt<dt[0]&&it>0&&tt<dt[1]}function q(lt){var bt=h.getId(lt),vt=h.getOffset(lt);return lt.parentNode.removeChild(lt),h.getContainer().appendChild(lt),h.setPosition(lt,vt),at(lt),h.dragManager.clearParent(lt,bt),[bt,vt]}function Q(lt){var bt=[];function vt(Et,yt,et){var tt=null;if(!K(Et,[yt,et])){var it=Et._jsPlumbGroup;o?h.remove(Et):tt=q(Et),it.remove(Et)}return tt}for(var dt=0;dt<lt.selection.length;dt++)bt.push(vt(lt.selection[dt][0],lt.selection[dt][1].left,lt.selection[dt][1].top));return bt.length===1?bt[0]:bt}function ct(lt){var bt=h.getId(lt);h.revalidate(lt),h.dragManager.revalidateParent(lt,bt)}function at(lt){lt._katavorioDrag&&((o||$)&&lt._katavorioDrag.off(P,Q),!o&&!$&&W&&(lt._katavorioDrag.off(a,ct),lt._katavorioDrag.setRevert(null)))}function rt(lt){lt._katavorioDrag&&((o||$)&&lt._katavorioDrag.on(P,Q),X&&lt._katavorioDrag.setConstrain(!0),O&&lt._katavorioDrag.setUseGhostProxy(!0),!o&&!$&&W&&(lt._katavorioDrag.on(a,ct),lt._katavorioDrag.setRevert(function(bt,vt){return!K(bt,vt)})))}this.shouldProxy=function(){return e},h.getGroupManager().addGroup(this)};C.prototype.addGroup=function(h){var k=this;if(k._groups=k._groups||{},k._groups[h.id]!=null)throw new TypeError("cannot create Group ["+h.id+"]; a Group with that ID exists");if(h.el[m]!=null)throw new TypeError("cannot create Group ["+h.id+"]; the given element is already a Group");var x=new M(k,h);return k._groups[x.id]=x,h.collapsed&&this.collapseGroup(x),x},C.prototype.addToGroup=function(h,k,x){var T=function(O){var X=this.getId(O);this.manage(X,O),this.getGroupManager().addToGroup(h,O,x)}.bind(this);if(Array.isArray(k))for(var f=0;f<k.length;f++)T(k[f]);else T(k)},C.prototype.removeFromGroup=function(h,k,x){this.getGroupManager().removeFromGroup(h,k,x),this.getContainer().appendChild(k)},C.prototype.removeGroup=function(h,k,x,T){return this.getGroupManager().removeGroup(h,k,x,T)},C.prototype.removeAllGroups=function(h,k,x){this.getGroupManager().removeAllGroups(h,k,x)},C.prototype.getGroup=function(h){return this.getGroupManager().getGroup(h)},C.prototype.getGroups=function(){return this.getGroupManager().getGroups()},C.prototype.expandGroup=function(h){this.getGroupManager().expandGroup(h)},C.prototype.collapseGroup=function(h){this.getGroupManager().collapseGroup(h)},C.prototype.repaintGroup=function(h){this.getGroupManager().repaintGroup(h)},C.prototype.toggleGroup=function(h){h=this.getGroupManager().getGroup(h),h!=null&&this.getGroupManager()[h.collapsed?"expandGroup":"collapseGroup"](h)},C.prototype.getGroupManager=function(){var h=this[i];return h==null&&(h=this[i]=new w(this)),h},C.prototype.removeGroupManager=function(){delete this[i]},C.prototype.getGroupFor=function(h){if(h=this.getElement(h),h){for(var k=this.getContainer(),x=!1,T=null;!x;)h==null||h===k?x=!0:h[m]?(T=h[m],x=!0):h=h.parentNode;return T}}}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F="Straight",z="Arc",H=function(s){this.type="Flowchart",s=s||{},s.stub=s.stub==null?30:s.stub;var P,a=n.Connectors.AbstractConnector.apply(this,arguments),i=s.midpoint==null||isNaN(s.midpoint)?.5:s.midpoint,m=s.alwaysRespectStubs===!0,b=null,D=null,v=s.cornerRadius!=null?s.cornerRadius:0;s.loopbackRadius;var c=function(y){return y<0?-1:y===0?0:1},t=function(y){return[c(y[2]-y[0]),c(y[3]-y[1])]},_=function(y,I,r,p){if(!(b===I&&D===r)){var d=b??p.sx,w=D??p.sy,M=d===I?"v":"h";b=I,D=r,y.push([d,w,I,r,M])}},j=function(y){return Math.sqrt(Math.pow(y[0]-y[2],2)+Math.pow(y[1]-y[3],2))},L=function(y){var I=[];return I.push.apply(I,y),I},U=function(y,I,r){for(var p=null,d,w,M,h=0;h<I.length-1;h++){if(p=p||L(I[h]),d=L(I[h+1]),w=t(p),M=t(d),v>0&&p[4]!==d[4]){var k=Math.min(j(p),j(d)),x=Math.min(v,k/2);p[2]-=w[0]*x,p[3]-=w[1]*x,d[0]+=M[0]*x,d[1]+=M[1]*x;var T=w[1]===M[0]&&M[0]===1||w[1]===M[0]&&M[0]===0&&w[0]!==M[1]||w[1]===M[0]&&M[0]===-1,f=d[1]>p[3]?1:-1,O=d[0]>p[2]?1:-1,X=f===O,W=X&&T||!X&&!T?d[0]:p[2],$=X&&T||!X&&!T?p[3]:d[1];a.addSegment(y,F,{x1:p[0],y1:p[1],x2:p[2],y2:p[3]}),a.addSegment(y,z,{r:x,x1:p[2],y1:p[3],x2:d[0],y2:d[1],cx:W,cy:$,ac:T})}else{var o=p[2]===p[0]?0:p[2]>p[0]?r.lw/2:-(r.lw/2),u=p[3]===p[1]?0:p[3]>p[1]?r.lw/2:-(r.lw/2);a.addSegment(y,F,{x1:p[0]-o,y1:p[1]-u,x2:p[2]+o,y2:p[3]+u})}p=d}d!=null&&a.addSegment(y,F,{x1:d[0],y1:d[1],x2:d[2],y2:d[3]})};this.midpoint=i,this._compute=function(y,I){P=[],b=null,D=null;var r=function(){return[y.startStubX,y.startStubY,y.endStubX,y.endStubY]},p={perpendicular:r,orthogonal:r,opposite:function(u){var e=y,g=u==="x"?0:1,E={x:function(){return e.so[g]===1&&(e.startStubX>e.endStubX&&e.tx>e.startStubX||e.sx>e.endStubX&&e.tx>e.sx)||e.so[g]===-1&&(e.startStubX<e.endStubX&&e.tx<e.startStubX||e.sx<e.endStubX&&e.tx<e.sx)},y:function(){return e.so[g]===1&&(e.startStubY>e.endStubY&&e.ty>e.startStubY||e.sy>e.endStubY&&e.ty>e.sy)||e.so[g]===-1&&(e.startStubY<e.endStubY&&e.ty<e.startStubY||e.sy<e.endStubY&&e.ty<e.sy)}};return!m&&E[u]()?{x:[(y.sx+y.tx)/2,y.startStubY,(y.sx+y.tx)/2,y.endStubY],y:[y.startStubX,(y.sy+y.ty)/2,y.endStubX,(y.sy+y.ty)/2]}[u]:[y.startStubX,y.startStubY,y.endStubX,y.endStubY]}},d=p[y.anchorOrientation](y.sourceAxis),w=y.sourceAxis==="x"?0:1,M=y.sourceAxis==="x"?1:0,h=d[w],k=d[M],x=d[w+2],T=d[M+2];_(P,d[0],d[1],y);var f=y.startStubX+(y.endStubX-y.startStubX)*i,O=y.startStubY+(y.endStubY-y.startStubY)*i,X={x:[0,1],y:[1,0]},W={perpendicular:function(u){var e=y,g={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},E={x:[[e.startStubX,e.endStubX],null,[e.endStubX,e.startStubX]],y:[[e.startStubY,e.endStubY],null,[e.endStubY,e.startStubY]]},G={x:[[f,e.startStubY],[f,e.endStubY]],y:[[e.startStubX,O],[e.endStubX,O]]},R={x:[[e.endStubX,e.startStubY]],y:[[e.startStubX,e.endStubY]]},K={x:[[e.startStubX,e.endStubY],[e.endStubX,e.endStubY]],y:[[e.endStubX,e.startStubY],[e.endStubX,e.endStubY]]},q={x:[[e.startStubX,O],[e.endStubX,O],[e.endStubX,e.endStubY]],y:[[f,e.startStubY],[f,e.endStubY],[e.endStubX,e.endStubY]]},Q={x:[e.startStubY,e.endStubY],y:[e.startStubX,e.endStubX]},ct=X[u][0],at=X[u][1],rt=e.so[ct]+1,lt=e.to[at]+1,bt=e.to[at]===-1&&Q[u][1]<Q[u][0]||e.to[at]===1&&Q[u][1]>Q[u][0],vt=E[u][rt][0],dt=E[u][rt][1],Et=g[u][rt][lt];if(e.segment===Et[3]||e.segment===Et[2]&&bt)return G[u];if(e.segment===Et[2]&&dt<vt)return R[u];if(e.segment===Et[2]&&dt>=vt||e.segment===Et[1]&&!bt)return q[u];if(e.segment===Et[0]||e.segment===Et[1]&&bt)return K[u]},orthogonal:function(u,e,g,E,G){var R=y,K={x:R.so[0]===-1?Math.min(e,E):Math.max(e,E),y:R.so[1]===-1?Math.min(e,E):Math.max(e,E)}[u];return{x:[[K,g],[K,G],[E,G]],y:[[g,K],[G,K],[G,E]]}[u]},opposite:function(u,e,g,E){var G=y,R={x:"y",y:"x"}[u],K={x:"height",y:"width"}[u],q=G["is"+u.toUpperCase()+"GreaterThanStubTimes2"];if(I.sourceEndpoint.elementId===I.targetEndpoint.elementId){var Q=g+(1-I.sourceEndpoint.anchor[R])*I.sourceInfo[K]+a.maxStub;return{x:[[e,Q],[E,Q]],y:[[Q,e],[Q,E]]}[u]}else{if(!q||G.so[w]===1&&e>E||G.so[w]===-1&&e<E)return{x:[[e,O],[E,O]],y:[[f,e],[f,E]]}[u];if(G.so[w]===1&&e<E||G.so[w]===-1&&e>E)return{x:[[f,G.sy],[f,G.ty]],y:[[G.sx,O],[G.tx,O]]}[u]}}},$=W[y.anchorOrientation](y.sourceAxis,h,k,x,T);if($)for(var o=0;o<$.length;o++)_(P,$[o][0],$[o][1],y);_(P,d[2],d[3],y),_(P,y.tx,y.ty,y),U(this,P,y)}};n.Connectors.Flowchart=H,C.extend(n.Connectors.Flowchart,n.Connectors.AbstractConnector)}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil;n.Connectors.AbstractBezierConnector=function(z){z=z||{};var H=z.showLoopback!==!1;z.curviness;var s=z.margin||5;z.proximityLimit;var P=z.orientation&&z.orientation==="clockwise",a=z.loopbackRadius||25,i;return this._compute=function(m,b){var D=b.sourcePos,v=b.targetPos,c=Math.abs(D[0]-v[0]),t=Math.abs(D[1]-v[1]);if(!H||b.sourceEndpoint.elementId!==b.targetEndpoint.elementId)this._computeBezier(m,b,D,v,c,t);else{var _=b.sourcePos[0],j=b.sourcePos[1]-s,L=_,U=j-a,y=L-a,I=U-a;c=2*a,t=2*a,m.points[0]=y,m.points[1]=I,m.points[2]=c,m.points[3]=t,i.addSegment(this,"Arc",{loopback:!0,x1:_-y+4,y1:j-I,startAngle:0,endAngle:2*Math.PI,r:a,ac:!P,x2:_-y-4,y2:j-I,cx:L-y,cy:U-I})}},i=n.Connectors.AbstractConnector.apply(this,arguments),i},C.extend(n.Connectors.AbstractBezierConnector,n.Connectors.AbstractConnector);var F=function(z){z=z||{},this.type="Bezier";var H=n.Connectors.AbstractBezierConnector.apply(this,arguments),s=z.curviness||150,P=10;this.getCurviness=function(){return s},this._findControlPoint=function(a,i,m,b,D,v,c){var t=v[0]!==c[0]||v[1]===c[1],_=[];return t?(c[0]===0?_.push(m[0]<i[0]?a[0]+P:a[0]-P):_.push(a[0]+s*c[0]),c[1]===0?_.push(m[1]<i[1]?a[1]+P:a[1]-P):_.push(a[1]+s*v[1])):(v[0]===0?_.push(i[0]<m[0]?a[0]+P:a[0]-P):_.push(a[0]-s*v[0]),v[1]===0?_.push(i[1]<m[1]?a[1]+P:a[1]-P):_.push(a[1]+s*c[1])),_},this._computeBezier=function(a,i,m,b,D,v){var c,t,_=m[0]<b[0]?D:0,j=m[1]<b[1]?v:0,L=m[0]<b[0]?0:D,U=m[1]<b[1]?0:v;c=this._findControlPoint([_,j],m,b,i.sourceEndpoint,i.targetEndpoint,a.so,a.to),t=this._findControlPoint([L,U],b,m,i.targetEndpoint,i.sourceEndpoint,a.to,a.so),H.addSegment(this,"Bezier",{x1:_,y1:j,x2:L,y2:U,cp1x:c[0],cp1y:c[1],cp2x:t[0],cp2y:t[1]})}};n.Connectors.Bezier=F,C.extend(F,n.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F=function(s,P,a,i){return s<=a&&i<=P?1:s<=a&&P<=i?2:a<=s&&i>=P?3:4},z=function(s,P,a,i,m,b,D,v,c){if(v<=c)return[s,P];if(a===1)return i[3]<=0&&m[3]>=1?[s+(i[2]<.5?-1*b:b),P]:i[2]>=1&&m[2]<=0?[s,P+(i[3]<.5?-1*D:D)]:[s+-1*b,P+-1*D];if(a===2)return i[3]>=1&&m[3]<=0?[s+(i[2]<.5?-1*b:b),P]:i[2]>=1&&m[2]<=0?[s,P+(i[3]<.5?-1*D:D)]:[s+b,P+-1*D];if(a===3)return i[3]>=1&&m[3]<=0?[s+(i[2]<.5?-1*b:b),P]:i[2]<=0&&m[2]>=1?[s,P+(i[3]<.5?-1*D:D)]:[s+-1*b,P+-1*D];if(a===4)return i[3]<=0&&m[3]>=1?[s+(i[2]<.5?-1*b:b),P]:i[2]<=0&&m[2]>=1?[s,P+(i[3]<.5?-1*D:D)]:[s+b,P+-1*D]},H=function(s){s=s||{},this.type="StateMachine";var P=n.Connectors.AbstractBezierConnector.apply(this,arguments),a=s.curviness||10,i=s.margin||5,m=s.proximityLimit||80;s.orientation&&s.orientation;var b;this._computeBezier=function(D,v,c,t,_,j){var L=v.sourcePos[0]<v.targetPos[0]?0:_,U=v.sourcePos[1]<v.targetPos[1]?0:j,y=v.sourcePos[0]<v.targetPos[0]?_:0,I=v.sourcePos[1]<v.targetPos[1]?j:0;v.sourcePos[2]===0&&(L-=i),v.sourcePos[2]===1&&(L+=i),v.sourcePos[3]===0&&(U-=i),v.sourcePos[3]===1&&(U+=i),v.targetPos[2]===0&&(y-=i),v.targetPos[2]===1&&(y+=i),v.targetPos[3]===0&&(I-=i),v.targetPos[3]===1&&(I+=i);var r=(L+y)/2,p=(U+I)/2,d=F(L,U,y,I),w=Math.sqrt(Math.pow(y-L,2)+Math.pow(I-U,2)),M,h,k,x;b=z(r,p,d,v.sourcePos,v.targetPos,a,a,w,m),M=b[0],h=b[0],k=b[1],x=b[1],P.addSegment(this,"Bezier",{x1:y,y1:I,x2:L,y2:U,cp1x:M,cp1y:k,cp2x:h,cp2y:x})}};n.Connectors.StateMachine=H,C.extend(H,n.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F="Straight",z=function(H){this.type=F;var s=n.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(P,a){s.addSegment(this,F,{x1:P.sx,y1:P.sy,x2:P.startStubX,y2:P.startStubY}),s.addSegment(this,F,{x1:P.startStubX,y1:P.startStubY,x2:P.endStubX,y2:P.endStubY}),s.addSegment(this,F,{x1:P.endStubX,y1:P.endStubY,x2:P.tx,y2:P.ty})}};n.Connectors.Straight=z,C.extend(z,n.Connectors.AbstractConnector)}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},z="stroke-dasharray",H="dashstyle",s="linearGradient",P="radialGradient",a="defs",i="fill",m="stop",b="stroke",D="stroke-width",v="style",c="none",t="jsplumb_gradient_",_="strokeWidth",j={svg:"http://www.w3.org/2000/svg"},L=function(x,T){for(var f in T)x.setAttribute(f,""+T[f])},U=function(x,T){return T=T||{},T.version="1.1",T.xmlns=j.svg,n.createElementNS(j.svg,x,null,null,T)},y=function(x){return"position:absolute;left:"+x[0]+"px;top:"+x[1]+"px"},I=function(x){for(var T=x.querySelectorAll(" defs,linearGradient,radialGradient"),f=0;f<T.length;f++)T[f].parentNode.removeChild(T[f])},r=function(x,T,f,O,X){var W=t+X._jsPlumb.instance.idstamp();I(x);var $;f.gradient.offset?$=U(P,{id:W}):$=U(s,{id:W,gradientUnits:"userSpaceOnUse"});var o=U(a);x.appendChild(o),o.appendChild($);for(var u=0;u<f.gradient.stops.length;u++){var e=X.segment===1||X.segment===2?u:f.gradient.stops.length-1-u,g=f.gradient.stops[e][1],E=U(m,{offset:Math.floor(f.gradient.stops[u][0]*100)+"%","stop-color":g});$.appendChild(E)}var G=f.stroke?b:i;T.setAttribute(G,"url(#"+W+")")},p=function(x,T,f,O,X){if(T.setAttribute(i,f.fill?f.fill:c),T.setAttribute(b,f.stroke?f.stroke:c),f.gradient?r(x,T,f,O,X):(I(x),T.setAttribute(v,"")),f.strokeWidth&&T.setAttribute(D,f.strokeWidth),f[H]&&f[_]&&!f[z]){var W=f[H].indexOf(",")===-1?" ":",",$=f[H].split(W),o="";$.forEach(function(e){o+=Math.floor(e*f.strokeWidth)+W}),T.setAttribute(z,o)}else f[z]&&T.setAttribute(z,f[z]);for(var u in F)f[u]&&T.setAttribute(F[u],f[u])},d=function(x,T,f){x.childNodes.length>f?x.insertBefore(T,x.childNodes[f]):x.appendChild(T)};C.svg={node:U,attr:L,pos:y};var w=function(x){var T=x.pointerEventsSpec||"all",f={};n.jsPlumbUIComponent.apply(this,x.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var O=x.cssClass+" "+(x.originalArgs[0].cssClass||""),X={style:"",width:0,height:0,"pointer-events":T,position:"absolute"};this.svg=U("svg",X),x.useDivWrapper?(this.canvas=n.createElement("div",{position:"absolute"}),C.sizeElement(this.canvas,0,0,1,1),this.canvas.className=O):(L(this.svg,{class:O}),this.canvas=this.svg),x._jsPlumb.appendElement(this.canvas,x.originalArgs[0].parent),x.useDivWrapper&&this.canvas.appendChild(this.svg);var W=[this.canvas];return this.getDisplayElements=function(){return W},this.appendDisplayElement=function($){W.push($)},this.paint=function($,o,u){if($!=null){var e=[this.x,this.y],g=[this.w,this.h],E;u!=null&&(u.xmin<0&&(e[0]+=u.xmin),u.ymin<0&&(e[1]+=u.ymin),g[0]=u.xmax+(u.xmin<0?-u.xmin:0),g[1]=u.ymax+(u.ymin<0?-u.ymin:0)),x.useDivWrapper?(C.sizeElement(this.canvas,e[0],e[1],g[0]>0?g[0]:1,g[1]>0?g[1]:1),e[0]=0,e[1]=0,E=y([0,0])):E=y([e[0],e[1]]),f.paint.apply(this,arguments),L(this.svg,{style:E,width:g[0]||1,height:g[1]||1})}},{renderer:f}};C.extend(w,n.jsPlumbUIComponent,{cleanup:function(x){x||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null,this._jsPlumb=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(x){var T=x.getContainer();this.canvas&&this.canvas.parentNode==null&&T.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&T.appendChild(this.bgCanvas)},setVisible:function(x){this.canvas&&(this.canvas.style.display=x?"block":"none")}}),n.ConnectorRenderers.svg=function(x){var T=this,f=w.apply(this,[{cssClass:x._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:x._jsPlumb}]);f.renderer.paint=function(O,X,W){var $=T.getSegments(),o="",u=[0,0];if(W.xmin<0&&(u[0]=-W.xmin),W.ymin<0&&(u[1]=-W.ymin),$.length>0){o=T.getPathData();var e={d:o,transform:"translate("+u[0]+","+u[1]+")","pointer-events":x["pointer-events"]||"visibleStroke"},g=null,E=[T.x,T.y,T.w,T.h];if(O.outlineStroke){var G=O.outlineWidth||1,R=O.strokeWidth+2*G;g=n.extend({},O),delete g.gradient,g.stroke=O.outlineStroke,g.strokeWidth=R,T.bgPath==null?(T.bgPath=U("path",e),n.addClass(T.bgPath,n.connectorOutlineClass),d(T.svg,T.bgPath,0)):L(T.bgPath,e),p(T.svg,T.bgPath,g,E,T)}T.path==null?(T.path=U("path",e),d(T.svg,T.path,O.outlineStroke?1:0)):L(T.path,e),p(T.svg,T.path,O,E,T)}}},C.extend(n.ConnectorRenderers.svg,w);var M=n.SvgEndpoint=function(x){var T=w.apply(this,[{cssClass:x._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:x._jsPlumb}]);T.renderer.paint=function(f){var O=n.extend({},f);O.outlineStroke&&(O.stroke=O.outlineStroke),this.node==null?(this.node=this.makeNode(O),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),p(this.svg,this.node,O,[this.x,this.y,this.w,this.h],this),y(this.node,[this.x,this.y])}.bind(this)};C.extend(M,w),n.Endpoints.svg.Dot=function(){n.Endpoints.Dot.apply(this,arguments),M.apply(this,arguments),this.makeNode=function(x){return U("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(x){L(x,{cx:this.w/2,cy:this.h/2,r:this.radius})}},C.extend(n.Endpoints.svg.Dot,[n.Endpoints.Dot,M]),n.Endpoints.svg.Rectangle=function(){n.Endpoints.Rectangle.apply(this,arguments),M.apply(this,arguments),this.makeNode=function(x){return U("rect",{width:this.w,height:this.h})},this.updateNode=function(x){L(x,{width:this.w,height:this.h})}},C.extend(n.Endpoints.svg.Rectangle,[n.Endpoints.Rectangle,M]),n.Endpoints.svg.Image=n.Endpoints.Image,n.Endpoints.svg.Blank=n.Endpoints.Blank,n.Overlays.svg.Label=n.Overlays.Label,n.Overlays.svg.Custom=n.Overlays.Custom;var h=function(x,T){x.apply(this,T),n.jsPlumbUIComponent.apply(this,T),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(O,X){if(O.component.svg&&X){this.path==null&&(this.path=U("path",{"pointer-events":"all"}),O.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,O.component),this.canvas=O.component.svg);var W=T&&T.length===1&&T[0].cssClass||"",$=[0,0];X.xmin<0&&($[0]=-X.xmin),X.ymin<0&&($[1]=-X.ymin),L(this.path,{d:f(O.d),class:W,stroke:O.stroke?O.stroke:null,fill:O.fill?O.fill:null,transform:"translate("+$[0]+","+$[1]+")"})}};var f=function(O){return isNaN(O.cxy.x)||isNaN(O.cxy.y)?"":"M"+O.hxy.x+","+O.hxy.y+" L"+O.tail[0].x+","+O.tail[0].y+" L"+O.cxy.x+","+O.cxy.y+" L"+O.tail[1].x+","+O.tail[1].y+" L"+O.hxy.x+","+O.hxy.y};this.transfer=function(O){O.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),O.canvas.appendChild(this.path))}},k={cleanup:function(x){this.path!=null&&(x?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(x,T){this.path&&T.canvas&&T.canvas.appendChild(this.path)},setVisible:function(x){this.path!=null&&(this.path.style.display=x?"block":"none")}};C.extend(h,[n.jsPlumbUIComponent,n.Overlays.AbstractOverlay]),n.Overlays.svg.Arrow=function(){h.apply(this,[n.Overlays.Arrow,arguments])},C.extend(n.Overlays.svg.Arrow,[n.Overlays.Arrow,h],k),n.Overlays.svg.PlainArrow=function(){h.apply(this,[n.Overlays.PlainArrow,arguments])},C.extend(n.Overlays.svg.PlainArrow,[n.Overlays.PlainArrow,h],k),n.Overlays.svg.Diamond=function(){h.apply(this,[n.Overlays.Diamond,arguments])},C.extend(n.Overlays.svg.Diamond,[n.Overlays.Diamond,h],k),n.Overlays.svg.GuideLines=function(){var x=null,T=this,f,O;n.Overlays.GuideLines.apply(this,arguments),this.paint=function(W,$){x==null&&(x=U("path"),W.connector.svg.appendChild(x),T.attachListeners(x,W.connector),T.attachListeners(x,T),f=U("path"),W.connector.svg.appendChild(f),T.attachListeners(f,W.connector),T.attachListeners(f,T),O=U("path"),W.connector.svg.appendChild(O),T.attachListeners(O,W.connector),T.attachListeners(O,T));var o=[0,0];$.xmin<0&&(o[0]=-$.xmin),$.ymin<0&&(o[1]=-$.ymin),L(x,{d:X(W.head,W.tail),stroke:"red",fill:null,transform:"translate("+o[0]+","+o[1]+")"}),L(f,{d:X(W.tailLine[0],W.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+o[0]+","+o[1]+")"}),L(O,{d:X(W.headLine[0],W.headLine[1]),stroke:"green",fill:null,transform:"translate("+o[0]+","+o[1]+")"})};var X=function(W,$){return"M "+W.x+","+W.y+" L"+$.x+","+$.y}},C.extend(n.Overlays.svg.GuideLines,n.Overlays.GuideLines)}.call(typeof window<"u"?window:Rt),function(){var A=this,n=A.jsPlumb,C=A.jsPlumbUtil,F=A.Katavorio,z=A.Biltong,H=function(r){var p=r._mottle;return p||(p=r._mottle=new A.Mottle),p},s=function(r,p){p=p||"main";var d="_katavorio_"+p,w=r[d],M=r.getEventManager();return w||(w=new F({bind:M.on,unbind:M.off,getSize:n.getSize,getConstrainingRectangle:function(h){return[h.parentNode.scrollWidth,h.parentNode.scrollHeight]},getPosition:function(h,k){var x=r.getOffset(h,k,h._katavorioDrag?h.offsetParent:null);return[x.left,x.top]},setPosition:function(h,k){h.style.left=k[0]+"px",h.style.top=k[1]+"px"},addClass:n.addClass,removeClass:n.removeClass,intersects:z.intersects,indexOf:function(h,k){return h.indexOf(k)},scope:r.getDefaultScope(),css:{noSelect:r.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),w.setZoom(r.getZoom()),r[d]=w,r.bind("zoom",w.setZoom)),w},P=function(r){var p=r.el._jsPlumbDragOptions,d=!0;return p.canDrag&&(d=p.canDrag()),d&&(this.setHoverSuspended(!0),this.select({source:r.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:r.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),d},a=function(r){var p=this.getUIPosition(arguments,this.getZoom());if(p!=null){var d=r.el._jsPlumbDragOptions;this.draw(r.el,p,null,!0),d._dragging&&this.addClass(r.el,"jtk-dragged"),d._dragging=!0}},i=function(r){for(var p=r.selection,d,w=function(h){var k;h[1]!=null&&(d=this.getUIPosition([{el:h[2].el,pos:[h[1].left,h[1].top]}]),k=this.draw(h[2].el,d)),h[0]._jsPlumbDragOptions!=null&&delete h[0]._jsPlumbDragOptions._dragging,this.removeClass(h[0],"jtk-dragged"),this.select({source:h[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:h[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),r.e._drawResult=r.e._drawResult||{c:[],e:[],a:[]},Array.prototype.push.apply(r.e._drawResult.c,k.c),Array.prototype.push.apply(r.e._drawResult.e,k.e),Array.prototype.push.apply(r.e._drawResult.a,k.a),this.getDragManager().dragEnded(h[2].el)}.bind(this),M=0;M<p.length;M++)w(p[M]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},m=function(r,p){var d=function(w){if(p[w]!=null)if(C.isString(p[w])){var M=p[w].match(/-=/)?-1:1,h=p[w].substring(2);return r[w]+M*h}else return p[w];else return r[w]};return[d("left"),d("top")]},b=function(r,p){if(p==null)return[0,0];var d=_(p),w=t(d,0);return[w[r+"X"],w[r+"Y"]]},D=b.bind(this,"page"),v=b.bind(this,"screen"),c=b.bind(this,"client"),t=function(r,p){return r.item?r.item(p):r[p]},_=function(r){return r.touches&&r.touches.length>0?r.touches:r.changedTouches&&r.changedTouches.length>0?r.changedTouches:r.targetTouches&&r.targetTouches.length>0?r.targetTouches:[r]},j=function(r){var p={},d=[],w={},M={},h={};this.register=function(k){var x=r.getId(k),T;p[x]||(p[x]=k,d.push(k),w[x]={});var f=function(O){if(O){for(var X=0;X<O.childNodes.length;X++)if(O.childNodes[X].nodeType!==3&&O.childNodes[X].nodeType!==8){var W=jsPlumb.getElement(O.childNodes[X]),$=r.getId(O.childNodes[X],null,!0);if($&&M[$]&&M[$]>0){T||(T=r.getOffset(k));var o=r.getOffset(W);w[x][$]={id:$,offset:{left:o.left-T.left,top:o.top-T.top}},h[$]=x}f(O.childNodes[X])}}};f(k)},this.updateOffsets=function(k,x){if(k!=null){x=x||{};var T=jsPlumb.getElement(k),f=r.getId(T),O=w[f],X;if(O){for(var W in O)if(O.hasOwnProperty(W)){var $=jsPlumb.getElement(W),o=x[W]||r.getOffset($);if($.offsetParent==null&&w[f][W]!=null)continue;X||(X=r.getOffset(T)),w[f][W]={id:W,offset:{left:o.left-X.left,top:o.top-X.top}},h[W]=f}}}},this.endpointAdded=function(k,x){x=x||r.getId(k);var T=document.body,f=k.parentNode;for(M[x]=M[x]?M[x]+1:1;f!=null&&f!==T;){var O=r.getId(f,null,!0);if(O&&p[O]){var X=r.getOffset(f);if(w[O][x]==null){var W=r.getOffset(k);w[O][x]={id:x,offset:{left:W.left-X.left,top:W.top-X.top}},h[x]=O}break}f=f.parentNode}},this.endpointDeleted=function(k){if(M[k.elementId]&&(M[k.elementId]--,M[k.elementId]<=0))for(var x in w)w.hasOwnProperty(x)&&w[x]&&(delete w[x][k.elementId],delete h[k.elementId])},this.changeId=function(k,x){w[x]=w[k],w[k]={},h[x]=h[k],h[k]=null},this.getElementsForDraggable=function(k){return w[k]},this.elementRemoved=function(k){var x=h[k];x&&(w[x]&&delete w[x][k],delete h[k])},this.reset=function(){p={},d=[],w={},M={}},this.dragEnded=function(k){if(k.offsetParent!=null){var x=r.getId(k),T=h[x];T&&this.updateOffsets(T)}},this.setParent=function(k,x,T,f,O){var X=h[x];w[f]||(w[f]={});var W=r.getOffset(T),$=O||r.getOffset(k);X&&w[X]&&delete w[X][x],w[f][x]={id:x,offset:{left:$.left-W.left,top:$.top-W.top}},h[x]=f},this.clearParent=function(k,x){var T=h[x];T&&(delete w[T][x],delete h[x])},this.revalidateParent=function(k,x,T){var f=h[x];if(f){var O={};O[x]=T,this.updateOffsets(f,O),r.revalidate(f)}},this.getDragAncestor=function(k){var x=jsPlumb.getElement(k),T=r.getId(x),f=h[T];return f?jsPlumb.getElement(f):null}},L=function(r,p,d){p=C.fastTrim(p),typeof r.className.baseVal<"u"?r.className.baseVal=p:r.className=p;try{var w=r.classList;if(w!=null){for(;w.length>0;)w.remove(w.item(0));for(var M=0;M<d.length;M++)d[M]&&w.add(d[M])}}catch(h){C.log("JSPLUMB: cannot set class list",h)}},U=function(r){return typeof r.className.baseVal>"u"?r.className:r.className.baseVal},y=function(r,p,d){p=p==null?[]:C.isArray(p)?p:p.split(/\s+/),d=d==null?[]:C.isArray(d)?d:d.split(/\s+/);var w=U(r),M=w.split(/\s+/),h=function(k,x){for(var T=0;T<x.length;T++)if(k)M.indexOf(x[T])===-1&&M.push(x[T]);else{var f=M.indexOf(x[T]);f!==-1&&M.splice(f,1)}};h(!0,p),h(!1,d),L(r,M.join(" "),M)};A.jsPlumb.extend(A.jsPlumbInstance.prototype,{headless:!1,pageLocation:D,screenLocation:v,clientLocation:c,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new j(this)),this.dragManager},recalculateOffsets:function(r){this.getDragManager().updateOffsets(r)},createElement:function(r,p,d,w){return this.createElementNS(null,r,p,d,w)},createElementNS:function(r,p,d,w,M){var h=r==null?document.createElement(p):document.createElementNS(r,p),k;d=d||{};for(k in d)h.style[k]=d[k];w&&(h.className=w),M=M||{};for(k in M)h.setAttribute(k,""+M[k]);return h},getAttribute:function(r,p){return r.getAttribute!=null?r.getAttribute(p):null},setAttribute:function(r,p,d){r.setAttribute!=null&&r.setAttribute(p,d)},setAttributes:function(r,p){for(var d in p)p.hasOwnProperty(d)&&r.setAttribute(d,p[d])},appendToRoot:function(r){document.body.appendChild(r)},getRenderModes:function(){return["svg"]},getClass:U,addClass:function(r,p){jsPlumb.each(r,function(d){y(d,p)})},hasClass:function(r,p){return r=jsPlumb.getElement(r),r.classList?r.classList.contains(p):U(r).indexOf(p)!==-1},removeClass:function(r,p){jsPlumb.each(r,function(d){y(d,null,p)})},toggleClass:function(r,p){jsPlumb.hasClass(r,p)?jsPlumb.removeClass(r,p):jsPlumb.addClass(r,p)},updateClasses:function(r,p,d){jsPlumb.each(r,function(w){y(w,p,d)})},setClass:function(r,p){p!=null&&jsPlumb.each(r,function(d){L(d,p,p.split(/\s+/))})},setPosition:function(r,p){r.style.left=p.left+"px",r.style.top=p.top+"px"},getPosition:function(r){var p=function(d){var w=r.style[d];return w?w.substring(0,w.length-2):0};return{left:p("left"),top:p("top")}},getStyle:function(r,p){return typeof window.getComputedStyle<"u"?getComputedStyle(r,null).getPropertyValue(p):r.currentStyle[p]},getSelector:function(r,p){var d=null;return arguments.length===1?d=r.nodeType!=null?r:document.querySelectorAll(r):d=r.querySelectorAll(p),d},getOffset:function(r,p,d){r=jsPlumb.getElement(r),d=d||this.getContainer();for(var w={left:r.offsetLeft,top:r.offsetTop},M=p||d!=null&&r!==d&&r.offsetParent!==d?r.offsetParent:null,h=function(T){T!=null&&T!==document.body&&(T.scrollTop>0||T.scrollLeft>0)&&(w.left-=T.scrollLeft,w.top-=T.scrollTop)}.bind(this);M!=null;)w.left+=M.offsetLeft,w.top+=M.offsetTop,h(M),M=p?M.offsetParent:M.offsetParent===d?null:M.offsetParent;if(d!=null&&!p&&(d.scrollTop>0||d.scrollLeft>0)){var k=r.offsetParent!=null?this.getStyle(r.offsetParent,"position"):"static",x=this.getStyle(r,"position");x!=="absolute"&&x!=="fixed"&&k!=="absolute"&&k!=="fixed"&&(w.left-=d.scrollLeft,w.top-=d.scrollTop)}return w},getPositionOnElement:function(r,p,d){var w=typeof p.getBoundingClientRect<"u"?p.getBoundingClientRect():{left:0,top:0,width:0,height:0},M=document.body,h=document.documentElement,k=window.pageYOffset||h.scrollTop||M.scrollTop,x=window.pageXOffset||h.scrollLeft||M.scrollLeft,T=h.clientTop||M.clientTop||0,f=h.clientLeft||M.clientLeft||0,O=0,X=0,W=w.top+k-T+O*d,$=w.left+x-f+X*d,o=jsPlumb.pageLocation(r),u=w.width||p.offsetWidth*d,e=w.height||p.offsetHeight*d,g=(o[0]-$)/u,E=(o[1]-W)/e;return[g,E]},getAbsolutePosition:function(r){var p=function(d){var w=r.style[d];if(w)return parseFloat(w.substring(0,w.length-2))};return[p("left"),p("top")]},setAbsolutePosition:function(r,p,d,w){d?this.animate(r,{left:"+="+(p[0]-d[0]),top:"+="+(p[1]-d[1])},w):(r.style.left=p[0]+"px",r.style.top=p[1]+"px")},getSize:function(r){return[r.offsetWidth,r.offsetHeight]},getWidth:function(r){return r.offsetWidth},getHeight:function(r){return r.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(r,p){var d;return r=C.isArray(r)||r.length!=null&&!C.isString(r)?r:[r],Array.prototype.slice.call(r).forEach(function(w){d=this.info(w),d.el&&this._initDraggableIfNecessary(d.el,!0,p,d.id,!0)}.bind(this)),this},snapToGrid:function(r,p,d){var w=[],M=function(x){var T=this.info(x);if(T.el!=null&&T.el._katavorioDrag){var f=T.el._katavorioDrag.snap(p,d);this.revalidate(T.el),w.push([T.el,f])}}.bind(this);if(arguments.length===1||arguments.length===3)M(r,p,d);else{var h=this.getManagedElements();for(var k in h)M(k,arguments[0],arguments[1])}return w},initDraggable:function(r,p,d){s(this,d).draggable(r,p),r._jsPlumbDragOptions=p},destroyDraggable:function(r,p){s(this,p).destroyDraggable(r),r._jsPlumbDragOptions=null,r._jsPlumbRelatedElement=null},unbindDraggable:function(r,p,d,w){s(this,w).destroyDraggable(r,p,d)},setDraggable:function(r,p){return jsPlumb.each(r,function(d){this.isDragSupported(d)&&(this._draggableStates[this.getAttribute(d,"id")]=p,this.setElementDraggable(d,p))}.bind(this))},_draggableStates:{},toggleDraggable:function(r){var p;return jsPlumb.each(r,function(d){var w=this.getAttribute(d,"id");return p=this._draggableStates[w]==null?!1:this._draggableStates[w],p=!p,this._draggableStates[w]=p,this.setDraggable(d,p),p}.bind(this)),p},_initDraggableIfNecessary:function(r,p,d,w,M){if(!jsPlumb.headless){var h=p??!1;if(h&&jsPlumb.isDragSupported(r,this)){var k=d||this.Defaults.DragOptions;if(k=jsPlumb.extend({},k),jsPlumb.isAlreadyDraggable(r,this))d.force&&this.initDraggable(r,k);else{var x=jsPlumb.dragEvents.drag,T=jsPlumb.dragEvents.stop,f=jsPlumb.dragEvents.start;this.manage(w,r),k[f]=C.wrap(k[f],P.bind(this)),k[x]=C.wrap(k[x],a.bind(this)),k[T]=C.wrap(k[T],i.bind(this));var O=this.getId(r);this._draggableStates[O]=!0;var X=this._draggableStates[O];k.disabled=X==null?!1:!X,this.initDraggable(r,k),this.getDragManager().register(r),M&&this.fire("elementDraggable",{el:r,options:k})}}}},animationSupported:!0,getElement:function(r){return r==null?null:(r=typeof r=="string"?r:r.tagName==null&&r.length!=null&&r.enctype==null?r[0]:r,typeof r=="string"?document.getElementById(r):r)},removeElement:function(r){s(this).elementRemoved(r),this.getEventManager().remove(r)},doAnimate:function(r,p,d){d=d||{};var w=this.getOffset(r),M=m(w,p),h=M[0]-w.left,k=M[1]-w.top,x=d.duration||250,T=15,f=x/T,O=T/x*h,X=T/x*k,W=0,$=setInterval(function(){n.setPosition(r,{left:w.left+O*(W+1),top:w.top+X*(W+1)}),d.step!=null&&d.step(W,Math.ceil(f)),W++,W>=f&&(window.clearInterval($),d.complete!=null&&d.complete())},T)},destroyDroppable:function(r,p){s(this,p).destroyDroppable(r)},unbindDroppable:function(r,p,d,w){s(this,w).destroyDroppable(r,p,d)},droppable:function(r,p){r=C.isArray(r)||r.length!=null&&!C.isString(r)?r:[r];var d;return p=p||{},p.allowLoopback=!1,Array.prototype.slice.call(r).forEach(function(w){d=this.info(w),d.el&&this.initDroppable(d.el,p)}.bind(this)),this},initDroppable:function(r,p,d){s(this,d).droppable(r,p)},isAlreadyDraggable:function(r){return r._katavorioDrag!=null},isDragSupported:function(r,p){return!0},isDropSupported:function(r,p){return!0},isElementDraggable:function(r){return r=n.getElement(r),r._katavorioDrag&&r._katavorioDrag.isEnabled()},getDragObject:function(r){return r[0].drag.getDragElement()},getDragScope:function(r){return r._katavorioDrag&&r._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(r){return r[0].e},getUIPosition:function(r,p){var d=r[0].el;if(d.offsetParent==null)return null;var w=r[0].finalPos||r[0].pos,M={left:w[0],top:w[1]};if(d._katavorioDrag&&d.offsetParent!==this.getContainer()){var h=this.getOffset(d.offsetParent);M.left+=h.left,M.top+=h.top}return M},setDragFilter:function(r,p,d){r._katavorioDrag&&r._katavorioDrag.setFilter(p,d)},setElementDraggable:function(r,p){r=n.getElement(r),r._katavorioDrag&&r._katavorioDrag.setEnabled(p)},setDragScope:function(r,p){r._katavorioDrag&&r._katavorioDrag.k.setDragScope(r,p)},setDropScope:function(r,p){r._katavorioDrop&&r._katavorioDrop.length>0&&r._katavorioDrop[0].k.setDropScope(r,p)},addToPosse:function(r,p){var d=Array.prototype.slice.call(arguments,1),w=s(this);n.each(r,function(M){M=[n.getElement(M)],M.push.apply(M,d),w.addToPosse.apply(w,M)})},setPosse:function(r,p){var d=Array.prototype.slice.call(arguments,1),w=s(this);n.each(r,function(M){M=[n.getElement(M)],M.push.apply(M,d),w.setPosse.apply(w,M)})},removeFromPosse:function(r,p){var d=Array.prototype.slice.call(arguments,1),w=s(this);n.each(r,function(M){M=[n.getElement(M)],M.push.apply(M,d),w.removeFromPosse.apply(w,M)})},removeFromAllPosses:function(r){var p=s(this);n.each(r,function(d){p.removeFromAllPosses(n.getElement(d))})},setPosseState:function(r,p,d){var w=s(this);n.each(r,function(M){w.setPosseState(n.getElement(M),p,d)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(r){r._katavorioDrag&&r._katavorioDrag.abort()},addToDragSelection:function(r){var p=this.getElement(r);p!=null&&(p._isJsPlumbGroup||p._jsPlumbGroup==null)&&s(this).select(r)},removeFromDragSelection:function(r){s(this).deselect(r)},getDragSelection:function(){return s(this).getSelection()},clearDragSelection:function(){s(this).deselectAll()},trigger:function(r,p,d,w){this.getEventManager().trigger(r,p,d,w)},doReset:function(){for(var r in this)r.indexOf("_katavorio_")===0&&this[r].reset()},getEventManager:function(){return H(this)},on:function(r,p,d){return this.getEventManager().on.apply(this,arguments),this},off:function(r,p,d){return this.getEventManager().off.apply(this,arguments),this}});var I=function(r){var p=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?r():setTimeout(p,9)};p()};I(n.init)}.call(typeof window<"u"?window:Rt)})(Zn);let ve;function ti(B){n(),A();function A(){if(B)for(const C of B){const F="pn_"+C.entity.key;C.children.length>0&&ve.addEndpoint(F,{anchors:["Right"],endpoint:["Dot",{radius:1}],isSource:!0,isTarget:!1,uuid:C.entity.key+"_source"}),C.parent&&ve.addEndpoint(F,{anchors:["Left"],endpoint:["Dot",{radius:1}],isSource:!1,isTarget:!0,uuid:C.entity.key+"_target"}),C.relation&&ve.connect({uuids:[C.relation.source+"_source",C.relation.target+"_target"]})}}function n(){ve&&ve.reset(),jsPlumb.ready(function(){ve=jsPlumb.getInstance({Connector:["Straight"],ConnectionOverlays:[["Arrow",{width:8,length:8,location:1,id:"arrow"}]],ConnectionsDetachable:!1,MaxConnections:-1,Container:"entityTreePanel",EndpointStyle:{fill:"#999999"},EndpointHoverStyle:{fill:"#777777"},PaintStyle:{stroke:"#777777",strokeWidth:2,dashstyle:"1 1"}})})}}const ei={class:"EntityNode"},ni={class:"suffix"},ii={style:{height:"100%"}},oi=Wt({__name:"EntityNode",props:["modelValue"],emits:["nodeCommand"],setup(B,{emit:A}){const n=B,C=A,F=Ee(()=>{var H,s;return((s=(H=n.modelValue)==null?void 0:H.entity)==null?void 0:s.type)=="TABLE"?"mdiTable":"mdiViewGridPlusOutline"});function z(H){C("nodeCommand",H,n.modelValue)}return(H,s)=>{var P,a;const i=ft("lc-icon"),m=ft("el-dropdown-item"),b=ft("el-dropdown-menu"),D=ft("el-dropdown");return xt(),Nt("div",ei,[Vt("div",{class:"prefix",onClick:s[0]||(s[0]=v=>z("fields"))},[Z(i,{icon:F.value},null,8,["icon"])]),Vt("div",{class:"content",onClick:s[1]||(s[1]=v=>z("fields"))},[Z(gn,{value:(a=(P=n.modelValue)==null?void 0:P.entity)==null?void 0:a.name,length:16},null,8,["value"])]),Vt("div",ni,[Z(D,{trigger:"click",style:{height:"100%"},onCommand:z},{dropdown:nt(()=>[Z(b,null,{default:nt(()=>[Z(m,{command:"basic"},{default:nt(()=>[zt(kt(H.$t("bi.plugin.modelEditor.single.entityTree.menu.basic")),1)]),_:1}),Z(m,{command:"fields"},{default:nt(()=>[zt(kt(H.$t("bi.plugin.modelEditor.single.entityTree.menu.fields")),1)]),_:1}),n.modelValue.children.length==0?(xt(),Mt(m,{key:0,command:"delete",divided:""},{default:nt(()=>[zt(kt(H.$t("_._.del")),1)]),_:1})):Qt("",!0)]),_:1})]),default:nt(()=>[Vt("span",ii,[Z(i,{icon:"mdiDotsHorizontal",style:{height:"100%"}})])]),_:1})])])}}}),si=Ve(oi,[["__scopeId","data-v-2fb9173d"]]),ri={key:0},ai={key:1},li=Wt({__name:"NodeEditBasic",props:["modelValue"],emits:["update:modelValue"],setup(B,{expose:A,emit:n}){const C=B,F=n,{modelValue:z}=fe(C,F),H=Tt();return A({validateFunc:function(){return H.value.validate}}),(s,P)=>{const a=ft("el-input"),i=ft("el-form-item"),m=ft("el-form"),b=ft("el-card");return xt(),Mt(b,{header:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.header"),shadow:"hover",style:{height:"100%"}},{default:nt(()=>[Z(m,{ref_key:"nodeEditBasicFormRef",ref:H,model:_t(z),"label-width":"100px"},{default:nt(()=>[Z(i,{label:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.type"),prop:"type"},{default:nt(()=>[Z(a,{modelValue:_t(z).type,"onUpdate:modelValue":P[0]||(P[0]=D=>_t(z).type=D),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),Z(i,{label:s.$t("_._.name"),prop:"name",required:""},{default:nt(()=>[Z(a,{modelValue:_t(z).name,"onUpdate:modelValue":P[1]||(P[1]=D=>_t(z).name=D)},null,8,["modelValue"])]),_:1},8,["label"]),Z(i,{label:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.alias"),prop:"alias",required:"",rules:{pattern:/^[a-zA-Z]\w*$/,message:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.aliasRuleError"),trigger:"blur"}},{default:nt(()=>[Z(a,{modelValue:_t(z).alias,"onUpdate:modelValue":P[2]||(P[2]=D=>_t(z).alias=D)},null,8,["modelValue"])]),_:1},8,["label","rules"]),Z(i,{label:s.$t("_._.description"),prop:"description"},{default:nt(()=>[Z(a,{modelValue:_t(z).description,"onUpdate:modelValue":P[3]||(P[3]=D=>_t(z).description=D)},null,8,["modelValue"])]),_:1},8,["label"]),_t(z).type!="SQL"?(xt(),Nt("div",ri,[Z(i,{label:"Schema",prop:"schema"},{default:nt(()=>[Z(a,{modelValue:_t(z).schema||_t(z).catalog,disabled:!0},null,8,["modelValue"])]),_:1}),Z(i,{label:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.tableOrView"),prop:"table"},{default:nt(()=>[Z(a,{modelValue:_t(z).table,"onUpdate:modelValue":P[4]||(P[4]=D=>_t(z).table=D),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),Z(i,{label:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.filter"),prop:"filter"},{default:nt(()=>[Z(a,{modelValue:_t(z).filter,"onUpdate:modelValue":P[5]||(P[5]=D=>_t(z).filter=D)},null,8,["modelValue"])]),_:1},8,["label"]),Z(i,{label:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.sort"),prop:"sort"},{default:nt(()=>[Z(a,{modelValue:_t(z).sort,"onUpdate:modelValue":P[6]||(P[6]=D=>_t(z).sort=D)},null,8,["modelValue"])]),_:1},8,["label"])])):Qt("",!0),_t(z).type=="SQL"?(xt(),Nt("div",ai,[Z(i,{label:s.$t("bi.plugin.modelEditor.single.entityTree.edit.basic.sql"),prop:"sql",required:""},{default:nt(()=>[Z(a,{modelValue:_t(z).sql,"onUpdate:modelValue":P[7]||(P[7]=D=>_t(z).sql=D),rows:8,type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])])):Qt("",!0)]),_:1},8,["model"])]),_:1},8,["header"])}}}),ui={class:"card-header",style:{display:"flex","align-items":"center","justify-content":"space-between"}},ci=Wt({__name:"NodeEditJoin",props:["modelValue","model","isEditing","dataBasic"],emits:["update:modelValue"],setup(B,{expose:A,emit:n}){const C=B,F=n,{modelValue:z}=fe(C,F),H=ue("globalContext");function s(){z.value.keys.push({sourceKey:"",targetKey:""})}function P(t){z.value.keys.splice(t.$index,1)}const a=Tt([]),i=Tt([]);function m(){var t;!((t=C.model)!=null&&t._id)||!z||(Fe(H.request,C.model._id,Se(C.model,z.value.source),a),Fe(H.request,C.model._id,C.dataBasic,i))}Ce(()=>C.modelValue,()=>{m()},{immediate:!0});function b(){Fe(H.request,C.model._id,Se(C.model,z.value.source),a)}function D(){for(let t=0;t<z.value.keys.length;t++){const _=z.value.keys[t];if(!_.sourceKey)return Gt.t("bi.plugin.modelEditor.single.entityTree.edit.join.validError1",[t+1]);if(!_.targetKey)return Gt.t("bi.plugin.modelEditor.single.entityTree.edit.join.validError2",[t+1])}}const v=[{validator:(t,_,j)=>{const L=D();L?j(new Error(L)):j()}}],c=Tt();return A({validateFunc:function(){if(c.value)return c.value.validate}}),(t,_)=>{const j=ft("el-button"),L=ft("el-button-group"),U=ft("el-empty"),y=ft("el-option"),I=ft("el-select"),r=ft("el-form-item"),p=ft("el-table-column"),d=ft("lc-icon"),w=ft("el-table"),M=ft("el-form"),h=ft("el-card");return xt(),Mt(h,{shadow:"hover",style:{height:"100%"}},{header:nt(()=>[Vt("div",ui,[Vt("span",null,kt(t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.title")),1),Vt("span",null,[Z(L,null,{default:nt(()=>{var k,x;return[(k=_t(z))!=null&&k.target?(xt(),Mt(j,{key:0,onClick:m},{default:nt(()=>[zt(kt(t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.loadFields")),1)]),_:1})):Qt("",!0),(x=_t(z))!=null&&x.target?(xt(),Mt(j,{key:1,onClick:s},{default:nt(()=>[zt(kt(t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.handleAdd")),1)]),_:1})):Qt("",!0)]}),_:1})])])]),default:nt(()=>{var k,x;return[(k=_t(z))!=null&&k.target?Qt("",!0):(xt(),Mt(U,{key:0,description:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.empty")},null,8,["description"])),(x=_t(z))!=null&&x.target?(xt(),Mt(M,{key:1,model:_t(z),"label-width":"120px",ref_key:"nodeEditJoinFormRef",ref:c},{default:nt(()=>[Z(r,{label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.source"),prop:"source",required:""},{default:nt(()=>[Z(I,{modelValue:_t(z).source,"onUpdate:modelValue":_[0]||(_[0]=T=>_t(z).source=T),disabled:B.isEditing,onChange:b},{default:nt(()=>{var T;return[(xt(!0),Nt($t,null,Zt(((T=C.model)==null?void 0:T.entities)||[],f=>(xt(),Mt(y,{key:f.key,label:f.name,value:f.key},null,8,["label","value"]))),128))]}),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),Z(r,{label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.joinType"),prop:"joinType",required:""},{default:nt(()=>[Z(I,{modelValue:_t(z).joinType,"onUpdate:modelValue":_[1]||(_[1]=T=>_t(z).joinType=T)},{default:nt(()=>[Z(y,{label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.innerJoin"),value:"INNER JOIN"},null,8,["label"]),Z(y,{label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.leftJoin"),value:"LEFT JOIN"},null,8,["label"]),Z(y,{label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.rightJoin"),value:"RIGHT JOIN"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),Z(r,{label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.rulesFields"),prop:"keys",required:"",rules:v},{default:nt(()=>[Z(w,{data:_t(z).keys,style:{width:"100%"}},{default:nt(()=>[Z(p,{prop:"sourceKey",label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.sourceKey")},{default:nt(T=>[Z(I,{modelValue:T.row.sourceKey,"onUpdate:modelValue":f=>T.row.sourceKey=f,filterable:""},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(a.value,f=>(xt(),Mt(y,{key:f.key,label:f.key,value:f.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),Z(p,{prop:"targetKey",label:t.$t("bi.plugin.modelEditor.single.entityTree.edit.join.targetKey")},{default:nt(T=>[Z(I,{modelValue:T.row.targetKey,"onUpdate:modelValue":f=>T.row.targetKey=f,filterable:""},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(i.value,f=>(xt(),Mt(y,{key:f.key,label:f.key,value:f.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),Z(p,{prop:"operation",label:"",width:"40"},{default:nt(T=>[Z(d,{icon:"mdiTrashCanOutline",style:{cursor:"pointer"},onClick:f=>P(T)},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["label"])]),_:1},8,["model"])):Qt("",!0)]}),_:1})}}}),di={class:"dialog-footer"},hi=Wt({__name:"NodeEditDialog",setup(B,{expose:A}){const n=ue("globalContext"),C=Tt(!0),F=Tt({}),z=Tt({}),H=Tt(!0),s=Tt(!1);let P;function a(_,j){P=j,C.value=!0,s.value=!0,F.value=pe.deepCopy(_.entity),_.relation?z.value=pe.deepCopy(_.relation):z.value={}}function i(_,j){P=j,C.value=!1,s.value=!0;const L="e"+pe.createUniqueString();_.type=="SQL"?F.value={key:L,type:"SQL"}:F.value={key:L,type:_.type,catalog:_.catalog,schema:_.schema,table:_.name,name:_.description||_.name,alias:_.name},P&&P.entities&&P.entities.length>0&&(z.value={target:L,joinType:"LEFT JOIN",keys:[{}]})}A({showEdit:a,showAdd:i});const m=Tt(),b=Tt();async function D(){m.value.validateFunc()(function(_){if(_){const j=b.value.validateFunc();j?j(function(L){L&&v()}):v()}})}function v(){C.value?(c(),s.value=!1):t()}function c(){const _=Se(P,F.value.key);_&&Le(_,F.value);const j=Gn(P,z.value.source,z.value.target);j&&Le(j,z.value)}function t(){P.entities.push(F.value),z.value.target&&P.relations.push(z.value),Ue(n.request,P._id,F.value).then(function(_){for(const j of _.data||[])P.columns.push({key:"c"+pe.createUniqueString(),entity:F.value.key,dataType:j.dataType,label:H.value?j.label:j.key,type:"field",column:j.key});s.value=!1})}return(_,j)=>{const L=ft("el-col"),U=ft("el-row"),y=ft("el-switch"),I=ft("el-button"),r=ft("el-dialog");return xt(),Mt(r,{modelValue:s.value,"onUpdate:modelValue":j[4]||(j[4]=p=>s.value=p),title:_.$t("bi.plugin.modelEditor.single.entityTree.edit.title"),width:"75%","close-on-click-modal":!1,"close-on-press-escape":!1,draggable:!0},{footer:nt(()=>[Vt("span",di,[Z(y,{modelValue:H.value,"onUpdate:modelValue":j[2]||(j[2]=p=>H.value=p),style:{"margin-right":"64px"},"active-text":_.$t("bi.plugin.modelEditor.single.entityTree.edit.useRemark")},null,8,["modelValue","active-text"]),Z(I,{onClick:j[3]||(j[3]=p=>s.value=!1)},{default:nt(()=>[zt(kt(_.$t("_._.cancel")),1)]),_:1}),Z(I,{type:"primary",onClick:D},{default:nt(()=>[zt(kt(_.$t("_._.ok")),1)]),_:1})])]),default:nt(()=>[Z(U,{gutter:16},{default:nt(()=>[Z(L,{span:14},{default:nt(()=>[Z(li,{modelValue:F.value,"onUpdate:modelValue":j[0]||(j[0]=p=>F.value=p),ref_key:"nodeEditBasicRef",ref:m},null,8,["modelValue"])]),_:1}),Z(L,{span:10},{default:nt(()=>[Z(ci,{modelValue:z.value,"onUpdate:modelValue":j[1]||(j[1]=p=>z.value=p),model:_t(P),isEditing:C.value,dataBasic:F.value,ref_key:"nodeEditJoinRef",ref:b},null,8,["modelValue","model","isEditing","dataBasic"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])}}}),pi={class:"dialog-footer"},fi=Wt({__name:"ColumnChooseDialog",setup(B,{expose:A}){const n=ue("globalContext"),C=Tt(),F=Tt(!1),z=Tt([]),H=Tt(!0);let s,P,a=[];function i(_,j){s=j,P=_,Ue(n.request,j._id,_).then(function(L){F.value=!0,z.value=L.data,Me(()=>{a=Bn(j,_.key);for(const U of a){const y=z.value.find(I=>I.key==U.column);y&&C.value.toggleRowSelection(y,void 0)}})})}A({show:i});function m(){const _=C.value.getSelectionRows();b(_),v(_),F.value=!1}function b(_){D(_,s?.columns);for(const j of s?.columns)D(_,j.children)}function D(_,j){if(!j)return;const L=j.findIndex(U=>U.entity!=P.key?!1:_.findIndex(y=>y.key==U.column)<0);L>=0&&(j.splice(L,1),b(_))}function v(_){for(const j of _)c(j)||s.columns.push({key:"c"+pe.createUniqueString(),entity:P.key,dataType:j.dataType,label:H.value?j.label:j.key,type:"field",column:j.key})}function c(_){if(t(_,s.columns))return!0;for(const j of s.columns)if(t(_,j.children))return!0;return!1}function t(_,j){return j?j.findIndex(L=>L.entity!=P.key?!1:L.column==_.key)>=0:!1}return(_,j)=>{const L=ft("el-table-column"),U=ft("el-table"),y=ft("el-switch"),I=ft("el-button"),r=ft("el-drawer");return xt(),Mt(r,{modelValue:F.value,"onUpdate:modelValue":j[2]||(j[2]=p=>F.value=p),title:_.$t("bi.plugin.modelEditor.single.entityTree.columnChoose.title"),width:"50%","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:nt(()=>[Vt("span",pi,[Z(y,{modelValue:H.value,"onUpdate:modelValue":j[0]||(j[0]=p=>H.value=p),style:{"margin-right":"16px"},"active-text":_.$t("bi.plugin.modelEditor.single.entityTree.columnChoose.useRemark")},null,8,["modelValue","active-text"]),Z(I,{onClick:j[1]||(j[1]=p=>F.value=!1)},{default:nt(()=>[zt(kt(_.$t("_._.cancel")),1)]),_:1}),Z(I,{type:"primary",onClick:m},{default:nt(()=>[zt(kt(_.$t("_._.ok")),1)]),_:1})])]),default:nt(()=>[Z(U,{data:z.value,style:{width:"100%"},ref_key:"columnChooseTableRef",ref:C},{default:nt(()=>[Z(L,{type:"selection",width:"55"}),Z(L,{prop:"key",label:_.$t("bi.plugin.modelEditor.single.entityTree.columnChoose.key")},null,8,["label"]),Z(L,{prop:"label",label:_.$t("bi.plugin.modelEditor.single.entityTree.columnChoose.label")},null,8,["label"])]),_:1},8,["data"])]),_:1},8,["modelValue","title"])}}}),mi=Wt({__name:"index",props:["modelValue"],emits:["update:modelValue"],setup(B,{emit:A}){const n=B,C=A,{modelValue:F}=fe(n,C),z=Ee(()=>$n(_t(F)));Ce(()=>z.value,()=>{Me(()=>ti(z.value))},{immediate:!0,deep:!0});const H=Ee(()=>function(v){const c=v.leafAbove*64+32,t=v.level*320+32;return{top:c+"px",left:t+"px",position:"absolute"}}),s=Tt(),P=Tt();function a(v,c){v=="basic"?s.value.showEdit(c,n.modelValue):v=="fields"?P.value.show(c.entity,n.modelValue):v=="delete"&&ze.confirm(Gt.t("bi.plugin.modelEditor.single.entityTree.deleteConfirm"),Gt.t("_._.warning"),{confirmButtonText:Gt.t("_._.yes"),cancelButtonText:Gt.t("_._.no"),type:"warning"}).then(()=>{i(c)})}function i(v){if(v.relation){const t=on(F.value,v.relation.source,v.relation.target);t>=0&&F.value.relations.splice(t,1)}for(let t=0;t<1e4&&m(v.entity.key);t++);const c=nn(F.value,v.entity.key);c>=0&&F.value.entities.splice(c,1)}function m(v){const c=Nn(F.value,v);return c>=0?(F.value.columns.splice(c,1),!0):!1}function b(v){v.preventDefault()}function D(v){const c=v.dataTransfer.getData("text");if(!c)return;const t=JSON.parse(c);s.value.showAdd(t,n.modelValue)}return(v,c)=>(xt(),Nt($t,null,[Vt("div",{class:"entitity-tree",id:"entityTreePanel",onDragover:b,onDrop:D},[(xt(!0),Nt($t,null,Zt(z.value,t=>{var _,j;return xt(),Mt(si,{key:(_=t.entity)==null?void 0:_.key,modelValue:t,id:"pn_"+((j=t.entity)==null?void 0:j.key),style:Qe(H.value(t)),onNodeCommand:a},null,8,["modelValue","id","style"])}),128))],32),Z(hi,{ref_key:"nodeEditDialogRef",ref:s},null,512),Z(fi,{ref_key:"columnChooseDialogRef",ref:P},null,512)],64))}}),gi={class:"toolbar-table-container",style:{margin:"0 6px 0 6px"}},vi={class:"lc-common-toolbar toolbar",style:{"background-color":"var(--el-color-primary)"}},bi={class:"left",style:{"font-weight":"bold",color:"var(--el-color-white)"}},yi=Wt({__name:"Single",props:["modelValue"],emits:["return"],setup(B,{emit:A}){const n=ue("globalContext"),C=Tt("field"),F=B,z=A,H=Tt({});let s=!1;const P=Tt([]);let a;Ce(()=>H.value,()=>{s=!0},{deep:!0});function i(){var D;const v=(D=H.value)==null?void 0:D.jdbcConnection;v&&v!=a&&n.request({method:"GET",url:"/bi/jdbcConnection/findEntities",params:{connection:v}}).then(function(c){P.value=c.data})}Ce(()=>F.modelValue,D=>{D&&n.request({method:"GET",url:"/bi/dataModel/load",params:{id:F.modelValue}}).then(function(v){H.value=v,Me(()=>{s=!1}),i()})},{immediate:!0});function m(){n.request({method:"POST",url:"/bi/dataModel/save",data:H.value}).then(function(){s=!1,mn({message:Gt.t("_._.saveSuccess"),type:"success"})})}function b(){s?ze.confirm(Gt.t("bi.plugin.modelEditor.single.saveConfirm"),Gt.t("_._.confirm"),{confirmButtonText:Gt.t("_._.ok"),cancelButtonText:Gt.t("_._.cancel"),type:"warning"}).then(()=>{z("return")}):z("return")}return(D,v)=>{const c=ft("lc-icon"),t=ft("el-button"),_=ft("el-button-group"),j=ft("el-aside"),L=ft("el-tab-pane"),U=ft("el-tabs"),y=ft("el-main"),I=ft("el-container");return xt(),Nt($t,null,[Vt("div",gi,[Vt("div",vi,[Vt("div",bi,[Z(Cn,{modelValue:H.value,"onUpdate:modelValue":v[0]||(v[0]=r=>H.value=r)},null,8,["modelValue"])]),Z(_,{class:"right"},{default:nt(()=>[Z(t,{onClick:b},{icon:nt(()=>[Z(c,{icon:"mdiKeyboardReturn"})]),default:nt(()=>[zt(kt(D.$t("_._.back")),1)]),_:1}),Z(t,{onClick:m},{icon:nt(()=>[Z(c,{icon:"mdiContentSaveAllOutline"})]),default:nt(()=>[zt(kt(D.$t("_._.save")),1)]),_:1})]),_:1})])]),Z(I,{style:{height:"100%"}},{default:nt(()=>[Z(j,{width:"240px",style:{"min-height":"420px",height:"100%","border-right":"1px var(--el-border-color) solid","margin-top":"12px"}},{default:nt(()=>[Z(wn,{entities:P.value},null,8,["entities"])]),_:1}),Z(y,{style:{padding:"0px"}},{default:nt(()=>[Z(_t(vn),{horizontal:"",class:"default-theme"},{default:nt(()=>[Z(_t($e),{style:{"background-color":"var(--el-fill-color-lighter)","border-radius":"4px"},size:"30"},{default:nt(()=>[Z(mi,{modelValue:H.value,"onUpdate:modelValue":v[1]||(v[1]=r=>H.value=r)},null,8,["modelValue"])]),_:1}),Z(_t($e),{style:{"background-color":"#fff"},size:"70"},{default:nt(()=>[Z(U,{modelValue:C.value,"onUpdate:modelValue":v[3]||(v[3]=r=>C.value=r)},{default:nt(()=>[Z(L,{label:D.$t("bi.plugin.modelEditor.single.field"),name:"field"},{default:nt(()=>[Z(Wn,{modelValue:H.value,"onUpdate:modelValue":v[2]||(v[2]=r=>H.value=r)},null,8,["modelValue"])]),_:1},8,["label"]),Z(L,{label:D.$t("bi.plugin.modelEditor.single.preview"),name:"preview"},{default:nt(()=>[Z(Tn,{model:H.value},null,8,["model"])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})],64)}}}),Pi=Ve(yi,[["__scopeId","data-v-fd025cd3"]]),_i={class:"dialog-footer"},xi=Wt({__name:"AddModelDialog",props:["modelValue","callback"],emits:["update:modelValue"],setup(B,{emit:A}){const n=B,C=A,{modelValue:F}=fe(n,C),z=ue("globalContext"),H=ue("appContext"),s=Tt([]),P=Tt({}),a=Tt(null);function i(){z.request.get("/bi/jdbcConnection/query?app="+H.getKey()).then(function(b){s.value=b.list})}function m(){a.value.validate(b=>{b&&(P.value.app=H.getKey(),P.value.entities=[],P.value.columns=[],P.value.relations=[],n.callback(P.value),F.value=!1)})}return(b,D)=>{const v=ft("el-input"),c=ft("el-form-item"),t=ft("el-option"),_=ft("el-select"),j=ft("el-form"),L=ft("el-button"),U=ft("el-dialog");return xt(),Mt(U,{modelValue:_t(F),"onUpdate:modelValue":D[4]||(D[4]=y=>Je(F)?F.value=y:null),title:b.$t("_._.add")+" "+b.$t("bi.plugin.modelEditor.name"),width:"30%","destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,onOpened:i},{footer:nt(()=>[Vt("span",_i,[Z(L,{onClick:D[3]||(D[3]=y=>F.value=!1)},{default:nt(()=>[zt(kt(b.$t("_._.cancel")),1)]),_:1}),Z(L,{type:"primary",onClick:m},{default:nt(()=>[zt(kt(b.$t("_._.ok")),1)]),_:1})])]),default:nt(()=>[Z(j,{ref_key:"addModelFormRef",ref:a,model:P.value,"label-width":"140px"},{default:nt(()=>[Z(c,{label:b.$t("_._.name"),prop:"name",required:""},{default:nt(()=>[Z(v,{modelValue:P.value.name,"onUpdate:modelValue":D[0]||(D[0]=y=>P.value.name=y)},null,8,["modelValue"])]),_:1},8,["label"]),Z(c,{label:b.$t("_._.description"),prop:"description"},{default:nt(()=>[Z(v,{modelValue:P.value.description,"onUpdate:modelValue":D[1]||(D[1]=y=>P.value.description=y)},null,8,["modelValue"])]),_:1},8,["label"]),Z(c,{label:b.$t("bi.plugin.modelEditor.data.connection"),prop:"jdbcConnection",required:""},{default:nt(()=>[Z(_,{modelValue:P.value.jdbcConnection,"onUpdate:modelValue":D[2]||(D[2]=y=>P.value.jdbcConnection=y)},{default:nt(()=>[(xt(!0),Nt($t,null,Zt(s.value,y=>(xt(),Mt(t,{key:y._id,label:y.name,value:y._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ci={class:"toolbar-table-container",style:{margin:"0 24px 0 8px"}},Ei={class:"lc-common-toolbar toolbar",style:{"background-color":"var(--el-color-primary)"}},Si={class:"left",style:{"font-weight":"bold",color:"var(--el-color-white)"}},ji=Wt({__name:"List",emits:["edit"],setup(B,{emit:A}){const n=A,C=ue("globalContext"),F=ue("appContext"),z=Tt(!1);function H(){z.value=!0}function s(b){C.request({method:"POST",url:"/bi/dataModel/save",data:b}).then(function(D){m(D)})}function P(b){ze.confirm(Gt.t("bi.plugin.modelEditor.deleteConfirm",[b.name]),Gt.t("_._.warning"),{confirmButtonText:Gt.t("_._.yes"),cancelButtonText:Gt.t("_._.no"),type:"warning"}).then(()=>{C.request({method:"POST",url:"/bi/dataModel/delete",params:{id:b._id}}).then(function(){i()})})}const a=Tt([]);function i(){C.request({method:"GET",url:"/bi/dataModel/query",params:{app:F.getKey()}}).then(function(b){a.value=b.list})}i();function m(b){n("edit",b._id)}return(b,D)=>{const v=ft("lc-icon"),c=ft("el-button"),t=ft("el-button-group"),_=ft("el-table-column"),j=ft("el-table"),L=qe("auth"),U=qe("data-auth");return xt(),Nt($t,null,[Vt("div",Ci,[Vt("div",Ei,[Vt("div",Si,kt(b.$t("bi.plugin.modelEditor.name")),1),Z(t,{class:"right"},{default:nt(()=>[Z(c,{onClick:i},{icon:nt(()=>[Z(v,{icon:"mdiRefresh"})]),default:nt(()=>[zt(" "+kt(b.$t("_._.refresh")),1)]),_:1}),be((xt(),Mt(c,{onClick:H},{icon:nt(()=>[Z(v,{icon:"mdiPlus"})]),default:nt(()=>[zt(kt(b.$t("_._.add")),1)]),_:1})),[[L,void 0,"dataModel_add"]])]),_:1})]),be((xt(),Mt(j,{data:a.value,class:"table-area"},{default:nt(()=>[Z(_,{prop:"name",label:b.$t("_._.name"),width:"320px"},null,8,["label"]),Z(_,{prop:"_connectionName",label:b.$t("bi.plugin.modelEditor.data.connection"),idth:"320px"},null,8,["label"]),Z(_,{prop:"description",label:b.$t("_._.description")},null,8,["label"]),Z(_,{prop:"_insertTime",label:b.$t("_._.createTime"),width:"200px"},{default:nt(y=>[zt(kt(_t(We)(y.row._insertTime)),1)]),_:1},8,["label"]),Z(_,{prop:"_updateTime",label:b.$t("_._.updateTime"),width:"200px"},{default:nt(y=>[zt(kt(_t(We)(y.row._updateTime)),1)]),_:1},8,["label"]),Z(_,{label:b.$t("_._.operation"),width:"260px"},{default:nt(y=>[Z(t,null,{default:nt(()=>[be((xt(),Mt(c,{onClick:I=>m(y.row)},{default:nt(()=>[zt(kt(b.$t("_._.edit")),1)]),_:2},1032,["onClick"])),[[U,y.row,"edit"]]),be((xt(),Mt(c,{onClick:I=>P(y.row)},{default:nt(()=>[zt(kt(b.$t("_._.del")),1)]),_:2},1032,["onClick"])),[[U,y.row,"del"]]),Z(_t(cn),{data:y.row,resource:"dataModel",uri:"/bi/dataModel"},null,8,["data"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[_t(Ne),8]])]),Z(xi,{modelValue:z.value,"onUpdate:modelValue":D[0]||(D[0]=y=>z.value=y),callback:s},null,8,["modelValue"])],64)}}}),Oi=Wt({__name:"index",setup(B){const A=Tt(!0),n=Tt("");function C(z){n.value=z,A.value=!1}function F(){A.value=!0}return(z,H)=>A.value?(xt(),Mt(ji,{key:0,onEdit:C})):(xt(),Mt(Pi,{key:1,modelValue:n.value,onReturn:F},null,8,["modelValue"]))}});export{Oi as default};
